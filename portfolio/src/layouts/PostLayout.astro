---
import Layout from '@layouts/Layout.astro';

const { social_links } = await import('@portfolio/consts.json');
const { metadata_page } = await import('@portfolio/consts.json');
const { colors } = await import('@portfolio/consts.json');
const { color_palette } = await import('@portfolio/consts.json');
const { max_width } = await import('@portfolio/consts.json');
const { max_width_pre } = await import('@portfolio/consts.json');

interface Props {
	title: string;
	languaje: string;
	description: string;
	keywords: string;
    author: string;
	theme_color: string;
	end_url: string;
    image_path: string;
    robots: string;
}

const { 
	title,
	languaje,
	description,
	keywords,
    author,
	theme_color,
	end_url,
    image_path,
    robots = "index, follow",
} = Astro.props;

// page title metadata_page.title + title
const page_title = metadata_page.title + " - " + title;
const url = social_links.portfolio_link_external + "/" + end_url;

const inline_code_block_background_color = color_palette.color_700;
const inline_code_block_border_color = color_palette.color_500;
const code_block_background_color = color_palette.color_950;
const code_block_font_color = colors.color_white;
const code_block_border_color = color_palette.color_700;
const output_block_background_color = color_palette.color_950;
const a_font_color = colors.color_white;
const generated_images_border_color = color_palette.color_950;
const generated_images_box_shadow_color = color_palette.color_500;
const copy_button_hover_background_color = color_palette.color_900;
---

<Layout 
    title={page_title}
    languaje={languaje}
    description={description}
    keywords={keywords}
    author={author}
    theme_color={theme_color}
    url={url}
    icon={metadata_page.icon}
    robots={robots}
>

    <main class="post-container">
        <header class="post-container-header">
            <h1>{title}</h1>
            <img src={image_path} alt={title} width=auto height=300px />
        </header>

        <section class="post-body">
            <slot class="post-content"/>
        </section>
    </main>
    

</Layout>

<style is:global define:vars={{
	max_width,
	max_width_pre,
    inline_code_block_background_color,
    inline_code_block_border_color,
    code_block_background_color,
    code_block_font_color,
    code_block_border_color,
    output_block_background_color,
    a_font_color,
    generated_images_border_color,
    generated_images_box_shadow_color,
    copy_button_hover_background_color,
}}>

    .post-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 100px;
    }

    .post-container-header {
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        width: 100%;
    }

    .post-body-post {
        display: flex;
        flex-direction: row;
        align-content: flex-start;
        justify-content: space-between;
        align-items: flex-start;
        max-width: var(--max_width);
    }

    .post-index {
        border-right: 1px solid var(--code_block_border_color);
        font-size: 0.8rem;
    }

    .post-content{
        margin-left: 50px;
    }

    {/* Code in text */}
    code, .section-block-markdown-cell .highlight {
        background-color: var(--inline_code_block_background_color);
        color: var(--code_block_font_color);
        border: 1px solid var(--inline_code_block_border_color);
        padding: 0px 3px;
        border-radius: 5px;
        opacity: 0.8;
    }
    .section-block-markdown-cell .highlight {
        padding-left: 30px;
        padding-top: 3px;
        padding-bottom: 3px;
        margin: 20px 0px;
    }

    {/* jupyter code cell */}
    .section-block-code-cell- {
        width: 100%;
        max-width: var(--max_width);
    }    
    .input-code {
        background-color: var(--code_block_background_color);
        color: var(--code_block_font_color);
        border: 1px solid var(--code_block_border_color);
        padding: 3px;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: flex-start;
        gap: 10px;
        font: 1rem 'Fira Code', monospace;
        padding: 10px 2px 20px 20px;
        border-radius: 6px;
    }
    pre {
        overflow: auto;
        max-width: var(--max_width_pre);
    }

    {/* Copy button */}
    header {
		display: flex;
		flex-direction: row;
		justify-content: flex-end;
		align-items: center;
		align-content: flex-end;
		gap: 10px
	}
    .input_area header {
        align-self: flex-end;
    }
    .input_area img {
        align-self: flex-end;
        z-index: 1;
        border-radius: 6px;
    }
    .input_area img:hover {
        background-color: var(--copy_button_hover_background_color);
    }
    .copy-button {
        margin: 0px;
        padding: 10px;
        /* margin-right: 10px; */
        max-width: fit-content;
        max-height: fit-content;
		border: none;
        background-color: transparent;
        cursor: pointer;
	}

    {/* jupyter output */}
    .output-wrapper {
        // background-color: var(--output_block_background_color);
        color: var(--code_block_font_color);
        border: 1px solid var(--code_block_border_color);
        padding: 3px 0px 3px 30px;
        border-radius: 5px;
        margin-top: 1px;
    }

    {/* Execution number */}
    .prompt-output-prompt {
        color: transparent;
    }

    {/* anchor */}
    a {
        color: var(--a_font_color);
    }

    {/* output style */}
    .ansi-red-fg {
        color: red;
        font-weight: bold;
    }
    .ansi-green-fg {
        color: green;
    }
    .ansi-yellow-fg {
        color: yellow;
    }
    .ansi-blue-fg {
        color: blue;
    }
    .ansi-magenta-fg {
        color: magenta;
    }
    .ansi-cyan-fg {
        color: cyan;
    }
    .ansi-white-fg {
        color: white;
    }
    .ansi-black-fg {
        color: black;
    }

    .post-body h1 {
        display: none;
    }
    
</style>

<!-- <script>
	const codeBlock = document.querySelectorAll('.input_area'); 
  
	codeBlock.forEach(block => {
		const buttonCopy = block.querySelector('.copy-button');
		const codeLines = block.querySelectorAll('code'); 
  
		buttonCopy.addEventListener('click', () => {
			let textForCopy = '';
	
			codeLines.forEach(line => {
				textForCopy += line.textContent + '\n';
			});
			// Remove last '\n'
			textForCopy = textForCopy.slice(0, -1);
	
			navigator.clipboard.writeText(textForCopy)
			.then(() => {
				// Change the text of the button
				buttonCopy.textContent = 'Copied!'; 
				setTimeout(() => {
					buttonCopy.textContent = 'Copy';
				}, 1500); 
			})
			.catch(err => {
				console.error('Error copying text: ', err);
			});
		});
	});
</script> -->

