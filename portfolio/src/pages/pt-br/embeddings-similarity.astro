---
import PostLayout from '@layouts/PostLayout.astro';
import CodeBlockInputCell from '@components/CodeBlockInputCell.astro';
import CodeBlockOutputCell from '@components/CodeBlockOutputCell.astro';

const { metadata_page } = await import('@portfolio/consts.json');
const { colors } = await import('@portfolio/consts.json');
const { svg_paths } = await import('@portfolio/consts.json');

const page_title = 'Medida de similaridade entre embeddings';
const end_url = 'embeddings-similarity';
const description = 'Descubra como é medida a similaridade entre embeddings, a base do mecanismo de atenção dos transformers e dos algoritmos de RAG';
const keywords = 'embeddings, similaridade, similaridade por cosseno, similaridade L2, similaridade por produto escalar';
const languaje = 'PT';
const image_path = 'https://pub-fb664c455eca46a2ba762a065ac900f7.r2.dev/embeddings-similarity.webp';
const opening_brace = '{';
const closing_brace = '}';
---

<PostLayout 
    title={page_title}
    languaje={languaje}
    description={description}
    keywords={keywords}
    author={metadata_page.author}
    theme_color={colors.background_color}
    end_url={end_url}
    image_path={image_path}
    image_width=1024
    image_height=1024
    image_extension=webp
    article_date=2023-12-18+T00:00:00Z
>

  <section class="post-body">


    <aside class="post-index">
      <a class="anchor-link" href="#Similaridade-por-quadrado-L2"><h2>Similaridade por quadrado L2</h2></a>
      <a class="anchor-link" href="#Semelhan%C3%A7a-de-cosseno"><h2>Semelhança de cosseno</h2></a>
      <a class="anchor-link" href="#Similaridade-do-produto-escalar"><h2>Similaridade do produto escalar</h2></a>
      <a class="anchor-link" href="#Qual-sistema-de-similaridade-usar"><h2>Qual sistema de similaridade usar</h2></a>
    </aside>


    <div class="post-body-content">
      
      <section class="section-block-markdown-cell">
      <h1 id="Medida-de-similaridade-entre-os-embeddings">Medida de similaridade entre os embeddings<a class="anchor-link" href="#Medida-de-similaridade-entre-os-embeddings"><img decoding="async" class="link-img" width="24px" height="24px" alt="link image 10" src={svg_paths.link_svg_path}/></a></h1>
      </section>
      
      <section class="section-block-markdown-cell">
      <p>Agora que vimos o que são <a href="https://www.maximofn.com/embeddings">embeddings</a>, sabemos que podemos medir a similaridade entre duas palavras medindo a similaridade entre seus embeddings. Na postagem <a href="https://www.maximofn.com/embeddings">embeddings</a>, vimos o exemplo do uso da medida de similaridade do cosseno, mas há outras medidas de similaridade que podemos usar, o quadrado L2, a similaridade do produto escalar, a similaridade do cosseno e assim por diante.</p>
      </section>
      
      <section class="section-block-markdown-cell">
      <p>Este caderno foi traduzido automaticamente para torná-lo acessível a mais pessoas, por favor me avise se você vir algum erro de digitação..</p>
      <p>Nesta postagem, examinaremos os três itens mencionados.</p>
      </section>
      
      <section class="section-block-markdown-cell">
      <h2 id="Similaridade-por-quadrado-L2">Similaridade por quadrado L2<a class="anchor-link" href="#Similaridade-por-quadrado-L2"><img decoding="async" class="link-img" width="24px" height="24px" alt="link image 11" src={svg_paths.link_svg_path}/></a></h2>
      </section>
      
      <section class="section-block-markdown-cell">
      <p>Essa similaridade é derivada da distância euclidiana, que é a distância em linha reta entre dois pontos em um espaço multidimensional, calculada com o teorema de Pitágoras.</p>
      <p><img decoding="async" onerror="this.parentNode.removeChild(this)" alt="Distância Euclidiana" src="https://pub-fb664c455eca46a2ba762a065ac900f7.r2.dev/distancia_euclidiana.webp" width="1200" height="961"/></p>
      <p>A distância euclidiana entre dois pontos $p$ e $q$ é calculada como:</p>
      $$
      d(p,q) = \sqrt{opening_brace}(p_1 - q_1)^2 + (p_2 - q_2)^2 + \cdots + (p_n - q_n)^2{closing_brace} = \sqrt{opening_brace}\sum_{opening_brace}i=1{closing_brace}^n (p_i - q_i)^2{closing_brace}
      $$
      </section>
      
      <section class="section-block-markdown-cell">
      <p>A similaridade ao quadrado de L2 é o quadrado da distância euclidiana, ou seja, o quadrado da distância euclidiana:</p>
      $$
      similaridade(p,q) = d(p,q)^2 = \sum_{opening_brace}i=1{closing_brace}^n (p_i - q_i)^2
      $$
      </section>
      
      <section class="section-block-markdown-cell">
      <h2 id="Semelhan%C3%A7a-de-cosseno">Semelhança de cosseno<a class="anchor-link" href="#Semelhan%C3%A7a-de-cosseno"><img decoding="async" class="link-img" width="24px" height="24px" alt="link image 12" src={svg_paths.link_svg_path}/></a></h2>
      </section>
      
      <section class="section-block-markdown-cell">
      <p>Se nos lembrarmos do que aprendemos sobre senos e cossenos na escola, lembraremos que quando dois vetores têm um ângulo de 0º entre eles, seu cosseno é 1, quando o ângulo entre eles é de 90º, seu cosseno é 0 e quando o ângulo é de 180º, seu cosseno é -1.</p>
      <p><img decoding="async" onerror="this.parentNode.removeChild(this)" alt="cosine similarity" src="https://pub-fb664c455eca46a2ba762a065ac900f7.r2.dev/dot-product.gif" width="960" height="540"/></p>
      <p><img decoding="async" onerror="this.parentNode.removeChild(this)" alt="cosine similarity" src="https://pub-fb664c455eca46a2ba762a065ac900f7.r2.dev/dot-product-unity.gif" width="498" height="498"/></p>
      <p>Portanto, podemos usar o cosseno do ângulo entre dois vetores para medir sua similaridade. É possível demonstrar que o cosseno do ângulo entre dois vetores é igual ao produto escalar dos dois vetores dividido pelo produto de seus módulos. Não é o objetivo desta postagem demonstrar isso, mas se você quiser, pode ver a demonstração [aqui] (<a href="https://www.wwwinsights.com/wp-content/uploads/2023/05/image-11-1024x694.png" target="_blank" rel="nofollow noreferrer">https://www.wwwinsights.com/wp-content/uploads/2023/05/image-11-1024x694.png</a>).</p>
      $$
      similaridade(U,V) = \frac{opening_brace}U \V{closing_brace}{opening_brace}V{closing_brace}.
      $$
      </section>
      
      <section class="section-block-markdown-cell">
      <h2 id="Similaridade-do-produto-escalar">Similaridade do produto escalar<a class="anchor-link" href="#Similaridade-do-produto-escalar"><img decoding="async" class="link-img" width="24px" height="24px" alt="link image 13" src={svg_paths.link_svg_path}/></a></h2>
      </section>
      
      <section class="section-block-markdown-cell">
      <p>A similaridade do produto escalar é o produto escalar de dois vetores</p>
      $$
      similaridade(U,V) = U \cdot V
      $$<p>Como escrevemos a fórmula de similaridade de cosseno, quando o comprimento dos vetores é 1, ou seja, eles são normalizados, a similaridade de cosseno é igual à similaridade do produto escalar.</p>
      </section>
      
      <section class="section-block-markdown-cell">
      <p>Então, para que serve a similaridade do produto escalar? Bem, para medir a semelhança entre dois vetores que não são normalizados, ou seja, que não têm comprimento 1.</p>
      <p>Por exemplo, o YouTube, para criar incorporações para seus vídeos, torna as incorporações dos vídeos que classifica como de qualidade superior mais longas do que as dos vídeos que classifica como de qualidade inferior.</p>
      <p>Dessa forma, quando um usuário faz uma pesquisa, a similaridade por produto escalar dará maior similaridade a vídeos de maior qualidade, portanto, dará ao usuário os vídeos de maior qualidade primeiro.</p>
      </section>
      
      <section class="section-block-markdown-cell">
      <h2 id="Qual-sistema-de-similaridade-usar">Qual sistema de similaridade usar<a class="anchor-link" href="#Qual-sistema-de-similaridade-usar"><img decoding="async" class="link-img" width="24px" height="24px" alt="link image 14" src={svg_paths.link_svg_path}/></a></h2>
      </section>
      
      <section class="section-block-markdown-cell">
      <p>Para escolher o sistema de similaridade a ser usado, devemos levar em conta o espaço em que estamos trabalhando.</p>
      <ul>
      <li>Se estivermos trabalhando em um espaço de alta dimensão, com embeddings normalizados, a similaridade de cosseno funciona melhor. Por exemplo, o OpenAI gera embeddings normalizados, portanto, a similaridade de cosseno funciona melhor.</li>
      <li>Se estivermos trabalhando em um sistema de classificação, em que a distância entre duas classes é importante, a similaridade L2-quadrado funciona melhor.</li>
      <li>Se estivermos trabalhando em um sistema de recomendação, em que o comprimento dos vetores é importante, a similaridade do produto escalar funciona melhor.</li>
      </ul>
      </section>
      






    </div>

  </section>

</PostLayout>
