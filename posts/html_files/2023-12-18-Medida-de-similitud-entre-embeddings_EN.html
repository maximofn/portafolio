<section class="section-block-markdown-cell">
<h1 id="Measure-of-similarity-between-embeddings">Measure of similarity between embeddings<a class="anchor-link" href="#Measure-of-similarity-between-embeddings">¶</a></h1>
</section>
<section class="section-block-markdown-cell">
<p>Now that we have seen what <a href="https://maximofn.com/embeddings">embeddings</a> are, we know that we can measure the similarity between two words by measuring the similarity between their embeddings. In the <a href="https://maximofn.com/embeddings">embeddings</a> post we saw the example of using the cosine similarity measure, but there are other similarity measures we can use, L2 square, scalar product similarity, cosine similarity, etc.</p>
</section>
<section class="section-block-markdown-cell">
<p>This notebook has been automatically translated to make it accessible to more people, please let me know if you see any typos.</p>
<p>In this post we are going to look at these three that we have named</p>
</section>
<section class="section-block-markdown-cell">
<h2 id="Similarity-by-square-L2">Similarity by square L2<a class="anchor-link" href="#Similarity-by-square-L2">¶</a></h2>
</section>
<section class="section-block-markdown-cell">
<p>This similarity is derived from the Euclidean distance, which is the straight line distance between two points in a multidimensional space, which is calculated with the Pythagorean theorem.</p>
<p><img alt="Euclidean distance" src="https://pub-fb664c455eca46a2ba762a065ac900f7.r2.dev/distancia_euclidiana.webp"/></p>
<p>The Euclidean distance between two points $p$ and $q$ is calculated as:</p>
$$
d(p,q) = \sqrt{(p_1 - q_1)^2 + (p_2 - q_2)^2 + \cdots + (p_n - q_n)^2} = \sqrt{{sum_{i=1}^n (p_i - q_i)^2}
$$
</section>
<section class="section-block-markdown-cell">
<p>The similarity times the square L2 is the square of the Euclidean distance, that is:</p>
$$
similarity(p,q) = d(p,q)^2 = \sum_{i=1}^n (p_i - q_i)^2
$$
</section>
<section class="section-block-markdown-cell">
<h2 id="Cosine-similarity">Cosine similarity<a class="anchor-link" href="#Cosine-similarity">¶</a></h2>
</section>
<section class="section-block-markdown-cell">
<p>If we remember what we learned about sines and cosines in school, we will remember that when two vectors have an angle of 0º between them, their cosine is 1, when the angle between them is 90º, their cosine is 0 and when the angle is 180º, their cosine is -1.</p>
<p><img alt="cosine similarity" src="https://pub-fb664c455eca46a2ba762a065ac900f7.r2.dev/dot-product.gif"/></p>
<p><img alt="cosine similarity" src="https://pub-fb664c455eca46a2ba762a065ac900f7.r2.dev/dot-product-unity.gif"/></p>
<p>Therefore, we can use the cosine of the angle between two vectors to measure their similarity. It can be shown that the cosine of the angle between two vectors is equal to the scalar product of the two vectors divided by the product of their moduli. It is not the purpose of this post to demonstrate it, but if you want you can see the demonstration <a href="https://www.wwwinsights.com/wp-content/uploads/2023/05/image-11-1024x694.png">here</a>.</p>
$$
similarity(U,V) = \frac{U \V}{V}{V}.
$$
</section>
<section class="section-block-markdown-cell">
<h2 id="Scalar-product-similarity">Scalar product similarity<a class="anchor-link" href="#Scalar-product-similarity">¶</a></h2>
</section>
<section class="section-block-markdown-cell">
<p>The scalar product similarity is the scalar product of two vectors.</p>
$$
similarity(U,V) = U \cdot V
$$<p>As we have written the cosine similarity formula, when the length of the vectors is 1, i.e., they are normalized, the cosine similarity is equal to the scalar product similarity.</p>
</section>
<section class="section-block-markdown-cell">
<p>So, what is the similarity by the scalar product for? Well, to measure the similarity between two vectors that are not normalized, that is, that do not have length 1.</p>
<p>For example, youtube, in order to create embeddings of its videos, makes the embeddings of the videos it classifies with higher quality longer than those of the videos it classifies with lower quality.</p>
<p>This way, when a user does a search, the similarity by product scalar will give higher similarity to higher quality videos, so it will give the user the higher quality videos first.</p>
</section>
<section class="section-block-markdown-cell">
<h2 id="Which-similarity-system-to-use">Which similarity system to use<a class="anchor-link" href="#Which-similarity-system-to-use">¶</a></h2>
</section>
<section class="section-block-markdown-cell">
<p>To choose the similarity system we are going to use, we must take into account the space in which we are working.</p>
<ul>
<li>If we are working in a high dimensional space, with normalized embeddings, cosine similarity works best. For example OpenAI generates normalized embeddings, so cosine similarity works best.</li>
<li>If we are working in a classification system, where the distance between two classes is important, the similarity by L2 square works best.</li>
<li>If we are working in a recommender system, where the length of the vectors is important, the scalar product similarity works best.</li>
</ul>
</section>
