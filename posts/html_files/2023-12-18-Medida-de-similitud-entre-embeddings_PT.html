<section class="section-block-markdown-cell">
<h1 id="Medida de similaridade entre embeddings">Medida de similaridade entre embeddings<a class="anchor-link" href="#Medida de similaridade entre embeddings">¶</a></h1>
</section>
<section class="section-block-markdown-cell">
<blockquote>
<p>Aviso: Este post foi traduzido para o português usando um modelo de tradução automática. Por favor, me avise se encontrar algum erro.</p>
</blockquote>
</section>
<section class="section-block-markdown-cell">
<p>Agora que vimos o que são os <a href="https://maximofn.com/embeddings">embeddings</a>, sabemos que podemos medir a similaridade entre duas palavras medindo a similaridade entre seus embeddings. No post de <a href="https://maximofn.com/embeddings">embeddings</a> vimos o exemplo do uso da medida de similaridade por cosseno, mas existem outras medidas de similaridade que podemos usar, como o quadrado L2, a similaridade do produto escalar, a similaridade por cosseno, etc.</p>
</section>
<section class="section-block-markdown-cell">
<p>Neste post, vamos ver essas três que mencionamos.</p>
</section>
<section class="section-block-markdown-cell">
<h2 id="Similaridade pelo quadrado L2">Similaridade pelo quadrado L2<a class="anchor-link" href="#Similaridade pelo quadrado L2">¶</a></h2>
</section>
<section class="section-block-markdown-cell">
<p>Esta similaridade é derivada da distância euclidiana, que é a distância em linha reta entre dois pontos em um espaço multidimensional, que é calculada com o teorema de Pitágoras.</p>
<img src="https://images.maximofn.com/distancia_euclidiana.webp" alt="distância euclidiana">
<p>A distância euclidiana entre dois pontos <span class="math-inline">p</span> e <span class="math-inline">q</span> é calculada como:</p>
<p><span class="math-display">d(p,q) = &radic;((p<sub>1</sub> - q<sub>1</sub>)<sup>2</sup> + (p<sub>2</sub> - q<sub>2</sub>)<sup>2</sup> + ··· + (p<sub>n</sub> - q<sub>n</sub>)<sup>2</sup>) = &radic;(&sum;<sub>i=1</sub><sup>n</sup> (p<sub>i</sub> - q<sub>i</sub>)<sup>2</sup>)</span></p>
</section>
<section class="section-block-markdown-cell">
<p>A similaridade pelo quadrado L2 é o quadrado da distância euclidiana, ou seja:</p>
<p><span class="math-display">similidade(p,q) = d(p,q)<sup>2</sup> = &sum;<sub>i=1</sub><sup>n</sup> (p<sub>i</sub> - q<sub>i</sub>)<sup>2</sup></span></p>
</section>
<section class="section-block-markdown-cell">
<h2 id="Similaridade cosseno">Similaridade cosseno<a class="anchor-link" href="#Similaridade cosseno">¶</a></h2>
</section>
<section class="section-block-markdown-cell">
<p>Se lembrarmos do que aprendemos sobre senos e cossenos na escola, lembraremos que quando dois vetores têm um ângulo de 0º entre eles, seu cosseno é 1, quando o ângulo entre eles é de 90º, seu cosseno é 0 e quando o ângulo é de 180º, seu cosseno é -1.</p>
<img src="https://images.maximofn.com/dot-product.gif" alt="similaridade cosseno">
<img src="https://images.maximofn.com/dot-product-unity.gif" alt="similaridade cosseno">
<p>Portanto, podemos usar o cosseno do ângulo entre dois vetores para medir sua similaridade. Pode-se demonstrar que o cosseno do ângulo entre dois vetores é igual ao produto escalar dos dois vetores dividido pelo produto de seus módulos. Não é o objetivo deste post demonstrá-lo, mas se quiserem podem ver a demonstração <a href="https://www.wwwinsights.com/wp-content/uploads/2023/05/image-11-1024x694.png">aqui</a>.</p>
<p><span class="math-display">similitude(U,V) = <span class="math-fraction"><span class="math-fraction-numerator">U · V</span><span class="math-fraction-denominator">||U|| ||V||</span></span></span></p>
</section>
<section class="section-block-markdown-cell">
<h2 id="Similaridade do produto escalar">Similaridade do produto escalar<a class="anchor-link" href="#Similaridade do produto escalar">¶</a></h2>
</section>
<section class="section-block-markdown-cell">
<p>A similaridade do produto escalar é o produto escalar de dois vetores</p>
<p><span class="math-display">similaridade(U,V) = U · V</span></p>
<p>Como escrevemos a fórmula da similaridade cosseno, quando o comprimento dos vetores é 1, ou seja, estão normalizados, a similaridade cosseno é igual à similaridade do produto escalar.</p>
</section>
<section class="section-block-markdown-cell">
<p>Então, para que serve a similaridade pelo produto escalar? Para medir a similaridade entre dois vetores que não estão normalizados, ou seja, que não têm comprimento 1.</p>
<p>Por exemplo, o YouTube, para criar os embeddings dos seus vídeos, faz com que os embeddings dos vídeos que classifica como de maior qualidade sejam mais longos do que os dos vídeos que classifica como de menor qualidade.</p>
<p>Desta forma, quando um usuário faz uma pesquisa, a similaridade pelo produto escalar dará maior similaridade aos vídeos de maior qualidade, portanto fornecerá ao usuário os vídeos de maior qualidade em primeiro lugar.</p>
</section>
<section class="section-block-markdown-cell">
<h2 id="Qual sistema de similaridade usar">Qual sistema de similaridade usar<a class="anchor-link" href="#Qual sistema de similaridade usar">¶</a></h2>
</section>
<section class="section-block-markdown-cell">
<p>Para escolher o sistema de similaridade que vamos usar, devemos ter em conta o espaço no qual estamos trabalhando.</p>
<ul>
  <li>Se estivermos trabalhando em um espaço de alta dimensionalidade, com embeddings normalizados, a similaridade cosseno é a que melhor funciona. Por exemplo, a OpenAI gera embeddings normalizados, portanto a similaridade cosseno é a que melhor funciona.</li>
  <li>Se estivermos trabalhando em um sistema de classificação, onde a distância entre duas classes é importante, a similaridade pelo quadrado L2 é a que melhor funciona.</li>
  <li>Se estivermos trabalhando em um sistema de recomendação, onde a comprimento dos vetores é importante, a similaridade do produto escalar é a que melhor funciona.</li>
</ul>
</section>