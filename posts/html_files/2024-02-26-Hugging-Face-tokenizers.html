<p>
	<!-- Custom stylesheet, it must be in the same directory as the html file -->
	<!-- Loading mathjax macro --><!-- Load mathjax --><!-- MathJax configuration -->
<p>
<style>
	/* Media query para pantallas grandes */
	@media screen and (min-width: 1000px) {
		.container {
			flex-wrap: nowrap;
			display: flex;
			justify-content: space-between;
			height: 100vh; /* altura del viewport */
		}
		
		.indice {
			width: 25%; /* Ancho del índice en pantallas grandes */
			border-right: 1px solid #ccc;
			max-height: calc(100vh - 40px); /* Ajustar según tus necesidades. Aquí estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
		
		.contenido {
			width: 70%; /* Ancho del contenido en pantallas grandes */
			max-height: calc(100vh - 40px); /* Ajustar según tus necesidades. Aquí estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
	}
</style>
<!-- Open div notebook -->
<div id="notebook" class="border-box-sizing" tabindex="-1">
	<!-- Open div notebook container -->
	<div id="notebook-container" class="container">
		<!-- Open div indice -->
		<div class="indice">
			<!-- Open div index header -->
			<div class="cell border-box-sizing text_cell rendered">
				<h2 class="prompt input_prompt">
					<span style="
					color: var(--darkreader-text--heading-color, var(--darkreader-text--heading-2-color,
					var(--darkreader-text--headings-color)));
					font-family: var(--fontFamily); font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-color: var(--darkreader-text--darkreader-text--heading-color,
					var(--darkreader-text--darkreader-text--heading-2-color, var(--darkreader-text--darkreader-text--headings-color)));
					--darkreader-inline-bgcolor: transparent;"
					data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">
						Índice
					</span>
					<a class="anchor-link" style="
					font-family: var(--fontFamily);
					font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-bgcolor: transparent;"
					href="#Índice" data-darkreader-inline-bgcolor="">
					</a>
				</h2>
			<!-- Close div index header -->
			</div>
			<!-- Index body -->
			<div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Instalación-index">
									<a class="anchor-link" href="#Instalación">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Instalación</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="El-pipeline-de-tokenización-index">
									<a class="anchor-link" href="#El-pipeline-de-tokenización">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">El pipeline de tokenización</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Normalización-index">
									<a class="anchor-link" href="#Normalización">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Normalización</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Pre-tokenización-index">
									<a class="anchor-link" href="#Pre-tokenización">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Pre-tokenización</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Tokenización-index">
									<a class="anchor-link" href="#Tokenización">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Tokenización</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Entrenamiento-del-modelo-index">
									<a class="anchor-link" href="#Entrenamiento-del-modelo">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Entrenamiento del modelo</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h5 id="Entrenamiento-del-modelo-con-el-método-`train`-index">
									<a class="anchor-link" href="#Entrenamiento-del-modelo-con-el-método-`train`">
										<p style="margin-left: 120px; font-size: 12px; line-height: 1.5;">Entrenamiento del modelo con el método <code><b>train</b></code></p>
									</a>
								</h5>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h5 id="Entrenamiento-del-modelo-con-el-método-`train_from_iterator`-index">
									<a class="anchor-link" href="#Entrenamiento-del-modelo-con-el-método-`train_from_iterator`">
										<p style="margin-left: 120px; font-size: 12px; line-height: 1.5;">Entrenamiento del modelo con el método <code><b>train_from_iterator</b></code></p>
									</a>
								</h5>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h5 id="Entrenamiento-del-modelo-con-el-método-`train_from_iterator`-desde-un-dataset-de-Hugging-Face-index">
									<a class="anchor-link" href="#Entrenamiento-del-modelo-con-el-método-`train_from_iterator`-desde-un-dataset-de-Hugging-Face">
										<p style="margin-left: 120px; font-size: 12px; line-height: 1.5;">Entrenamiento del modelo con el método <code><b>train_from_iterator</b></code> desde un dataset de Hugging Face</p>
									</a>
								</h5>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Guardando-el-modelo-index">
									<a class="anchor-link" href="#Guardando-el-modelo">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Guardando el modelo</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Cargando-el-modelo-preentrenado-index">
									<a class="anchor-link" href="#Cargando-el-modelo-preentrenado">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Cargando el modelo preentrenado</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Post-procesamiento-index">
									<a class="anchor-link" href="#Post-procesamiento">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Post procesamiento</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Encoding-index">
									<a class="anchor-link" href="#Encoding">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Encoding</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Decoding-index">
									<a class="anchor-link" href="#Decoding">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Decoding</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="BERT-tokenizer-index">
									<a class="anchor-link" href="#BERT-tokenizer">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">BERT tokenizer</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
			</div>
		<!-- Close div indice -->
		</div>
 
		<!-- Content -->
		<div class="contenido">
		<div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;"><a href="https://colab.research.google.com/github/maximofn/portafolio/blob/main/posts/2024-02-26-Hugging-Face-tokenizers.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h1 id="Hugging-Face-tokenizers">
								<a class="anchor-link" href="#Hugging-Face-tokenizers">
									<p style="margin-left: 0px">Hugging Face tokenizers</p>
								</a>
							</h1>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">La librería <code><b>tokenizers</b></code> de Hugging Face proporciona una implementación de los tokenizadores más utilizados en la actualidad, centrándose en el rendimiento y la versatilidad. En el post <a href="https://maximofn.com/tokens/" target="_blank">tokens</a> ya vimos la importancia de los tokens a la hora de procesar textos, ya que los ordenadores no entienden de palabras, sino de números. Por tanto, es necesario convertir las palabras a números para que los modelos de lenguaje puedan procesarlos.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Instalación">
								<a class="anchor-link" href="#Instalación">
									<p style="margin-left: 10px">Instalación</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para instalar <code><b>tokenizers</b></code> con pip:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 80px;"><code>pip install tokenizers<br></code></p>
						</div>
					</div>
				</div>
			</div>
	
	
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">para instalar <code><b>tokenizers</b></code> con conda:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 80px;"><code>conda install conda-forge::tokenizers<br></code></p>
						</div>
					</div>
				</div>
			</div>
	
	
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="El-pipeline-de-tokenización">
								<a class="anchor-link" href="#El-pipeline-de-tokenización">
									<p style="margin-left: 10px">El pipeline de tokenización</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para tokenizar una secuencia se usa <code><b>Tokenizer.encode</b></code>, el cual realiza los siguientes pasos:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Normalización</li>
									<li>pre-tokenización</li>
									<li>Tokenización</li>
									<li>Post-tokenización</li>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos a ver cada una</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para realizar el post vamos a usar el dataset <a href="https://blog.einstein.ai/the-wikitext-long-term-dependency-language-modeling-dataset/" target="_blank">wikitext-103</a></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #7f6e38;">!</span><span style="color: #6b97e8;">wget</span> <span style="color: #6b97e8;">https</span><span style="color: #e3e11d;">:</span><span>//</span><span style="color: #6b97e8;">dax</span><span>-</span><span style="color: #6b97e8;">cdn</span><span>.</span><span style="color: #6b97e8;">cdn</span><span>.</span><span style="color: #6b97e8;">appdomain</span><span>.</span><span style="color: #6b97e8;">cloud</span><span>/</span><span style="color: #6b97e8;">dax</span><span>-</span><span style="color: #6b97e8;">wikitext</span><span>-</span><span style="color: #7e7a38;">103</span><span>/</span><span style="color: #a09e19;">1.0.1</span><span>/</span><span style="color: #6b97e8;">wikitext</span><span>-</span><span style="color: #a09e19;">103.</span><span style="color: #6b97e8;">tar</span><span>.</span><span style="color: #6b97e8;">gz</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>200 OK</p><p>Length: 189603606 (181M) [application/x-gzip]</p><p>Saving to: ‘wikitext-103.tar.gz’</p><p>wikitext-103.tar.gz 100%[===================&gt;] 180,82M  6,42MB/s    in 30s     </p><p>2024-02-26 08:14:42 (5,95 MB/s) - ‘wikitext-103.tar.gz’ saved [189603606/189603606]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #7f6e38;">!</span><span style="color: #6b97e8;">tar</span> <span>-</span><span style="color: #6b97e8;">xvzf</span> <span style="color: #6b97e8;">wikitext</span><span>-</span><span style="color: #a09e19;">103.</span><span style="color: #6b97e8;">tar</span><span>.</span><span style="color: #6b97e8;">gz</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>wikitext-103/</p><p>wikitext-103/wiki.test.tokens</p><p>wikitext-103/wiki.valid.tokens</p><p>wikitext-103/README.txt</p><p>wikitext-103/LICENSE.txt</p><p>wikitext-103/wiki.train.tokens</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #7f6e38;">!</span><span style="color: #6b97e8;">rm</span> <span style="color: #6b97e8;">wikitext</span><span>-</span><span style="color: #a09e19;">103.</span><span style="color: #6b97e8;">tar</span><span>.</span><span style="color: #6b97e8;">gz</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Normalización">
								<a class="anchor-link" href="#Normalización">
									<p style="margin-left: 20px">Normalización</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">La normalización son operaciones que se aplican al texto antes de la tokenización, como la eliminación de espacios en blanco, la conversión a minúsculas, la eliminación de caracteres especiales, etc. En Hugging Face están implementadas las siguientes normalizaciones:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Normalización</th>
									<th>Descripción</th>
									<th>Ejemplo</th>
								</tr>
								<tr>
									<td>NFD (Normalization for D)</td>
									<td>Los caracteres se descomponen por equivalencia canónica</td>
									<td><code><b>â</b></code> (U+00E2) se descompone en <code><b>a</b></code> (U+0061) + <code><b>^</b></code> (U+0302)</td>
								</tr>
								<tr>
									<td>NFKD (Normalization Form KD)</td>
									<td>Los caracteres se descomponen por compatibilidad</td>
									<td><code><b>ﬁ</b></code> (U+FB01) se descompone en <code><b>f</b></code> (U+0066) + <code><b>i</b></code> (U+0069)</td>
								</tr>
								<tr>
									<td>NFC (Normalization Form C)</td>
									<td>Los caracteres se descomponen y luego se recomponen por equivalencia canónica</td>
									<td><code><b>â</b></code> (U+00E2) se descompone en <code><b>a</b></code> (U+0061) + <code><b>^</b></code> (U+0302) y luego se recompone en <code><b>â</b></code> (U+00E2)</td>
								</tr>
								<tr>
									<td>NFKC (Normalization Form KC)</td>
									<td>Los caracteres se descomponen por compatibilidad y luego se recomponen por equivalencia canónica</td>
									<td><code><b>ﬁ</b></code> (U+FB01) se descompone en <code><b>f</b></code> (U+0066) + <code><b>i</b></code> (U+0069) y luego se recompone en <code><b>f</b></code> (U+0066) + <code><b>i</b></code> (U+0069)</td>
								</tr>
								<tr>
									<td>Lowercase</td>
									<td>Convierte el texto a minúsculas</td>
									<td><code><b>Hello World</b></code> se convierte en <code><b>hello world</b></code></td>
								</tr>
								<tr>
									<td>Strip</td>
									<td>Elimina todos los espacios en blanco de los lados especificados (izquierdo, derecho o ambos) del texto</td>
									<td><code><b>  Hello World  </b></code> se convierte en <code><b>Hello World</b></code></td>
								</tr>
								<tr>
									<td>StripAccents</td>
									<td>Elimina todos los símbolos de acento en unicode (se utilizará con NFD por coherencia)</td>
									<td><code><b>á</b></code> (U+00E1) se convierte en <code><b>a</b></code> (U+0061)</td>
								</tr>
								<tr>
									<td>Replace</td>
									<td>Sustituye una cadena personalizada o <a href="https://maximofn.com/regular-expressions/" target="_blank">regex</a> y la cambia por el contenido dado</td>
									<td><code><b>Hello World</b></code> se convierte en <code><b>Hello Universe</b></code></td>
								</tr>
								<tr>
									<td>BertNormalizer</td>
									<td>Proporciona una implementación del Normalizador utilizado en el BERT original. Las opciones que se pueden configurar son <code><b>clean_text</b></code>, <code><b>handle_chinese_chars</b></code>, <code><b>strip_accents</b></code> y <code><b>lowercase</b></code></td>
									<td><code><b>Hello World</b></code> se convierte en <code><b>hello world</b></code></td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos a crear un normalizador para ver cómo funciona</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">normalizers</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_normalizer</span> <span>=</span> <span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">BertNormalizer</span><span style="color: #e3e11d;">()</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;Héllò hôw are ü?&quot;</span></p>
<p><span style="color: #6b97e8;">normalized_text</span> <span>=</span> <span style="color: #6b97e8;">bert_normalizer</span><span>.</span><span style="color: #6b97e8;">normalize_str</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">normalized_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>'hello how are u?'</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para usar varios normalizadores podemos usar el método <code><b>Sequence</b></code></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">custom_normalizer</span> <span>=</span> <span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">Sequence</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">NFKC</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">BertNormalizer</span><span style="color: #e3e11d;">()])</span></p>
<p></p>
<p><span style="color: #6b97e8;">normalized_text</span> <span>=</span> <span style="color: #6b97e8;">custom_normalizer</span><span>.</span><span style="color: #6b97e8;">normalize_str</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">normalized_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>'hello how are u?'</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para modificar el normalizador de un tokenizador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">tokenizers</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">tokenizers</span><span>.</span><span style="color: #6b97e8;">BertWordPieceTokenizer</span><span style="color: #e3e11d;">()</span> <span style="color: #7f6e38;"># or any other tokenizer</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">normalizer</span> <span>=</span> <span style="color: #6b97e8;">custom_normalizer</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Pre-tokenización">
								<a class="anchor-link" href="#Pre-tokenización">
									<p style="margin-left: 20px">Pre-tokenización</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">La pretokenización es el acto de dividir un texto en objetos más pequeños. El pretokenizador dividirá el texto en "palabras" y los tokens finales serán partes de esas palabras.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">El PreTokenizer se encarga de dividir la entrada según un conjunto de reglas. Este preprocesamiento le permite asegurarse de que el tokenizador no construye tokens a través de múltiples "divisiones". Por ejemplo, si no quieres tener espacios en blanco dentro de un token, entonces puedes tener un pre tokenizer que divide en las palabras a partir de espacios en blanco.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">En Hugging Face están implementados los siguientes pre tokenizadores</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>PreTokenizer</th>
									<th>Descripción</th>
									<th>Ejemplo</th>
								</tr>
								<tr>
									<td>ByteLevel</td>
									<td>Divide en espacios en blanco mientras reasigna todos los bytes a un conjunto de caracteres visibles. Esta técnica fue introducida por OpenAI con GPT-2 y tiene algunas propiedades más o menos buenas: Como mapea sobre bytes, un tokenizador que utilice esto sólo requiere 256 caracteres como alfabeto inicial (el número de valores que puede tener un byte), frente a los más de 130.000 caracteres Unicode. Una consecuencia del punto anterior es que es absolutamente innecesario tener un token desconocido usando esto ya que podemos representar cualquier cosa con 256 tokens. Para caracteres no ascii, se vuelve completamente ilegible, ¡pero funciona!</td>
									<td><code><b>Hello my friend, how are you?</b></code> se divide en <code><b>Hello</b></code>, <code><b>Ġmy</b></code>, <code><b>Ġfriend</b></code>, <code><b>,</b></code>, <code><b>Ġhow</b></code>, <code><b>Ġare</b></code>, <code><b>Ġyou</b></code>, <code><b>?</b></code></td>
								</tr>
								<tr>
									<td>Whitespace</td>
									<td>Divide en límites de palabra usando la siguiente expresión regular: <code><b>\w+<a href="https://maximofn.com/regular-expressions/" target="_blank">^\w\s]+</b></code>. En mi post sobre [expresiones regulares</a> puedes entender qué hace</td>
									<td><code><b>Hello there!</b></code> se divide en <code><b>Hello</b></code>, <code><b>there</b></code>, <code><b>!</b></code></td>
								</tr>
								<tr>
									<td>WhitespaceSplit</td>
									<td>Se divide en cualquier carácter de espacio en blanco</td>
									<td><code><b>Hello there!</b></code> se divide en <code><b>Hello</b></code>, <code><b>there!</b></code></td>
								</tr>
								<tr>
									<td>Punctuation</td>
									<td>Aislará todos los caracteres de puntuación</td>
									<td><code><b>Hello?</b></code> se divide en <code><b>Hello</b></code>, <code><b>?</b></code></td>
								</tr>
								<tr>
									<td>Metaspace</td>
									<td>Separa los espacios en blanco y los sustituye por un carácter especial "▁" (U+2581)</td>
									<td><code><b>Hello there</b></code> se divide en <code><b>Hello</b></code>, <code><b>▁there</b></code></td>
								</tr>
								<tr>
									<td>CharDelimiterSplit</td>
									<td>Divisiones en un carácter determinado</td>
									<td>Ejemplo con el caracter <code><b>x</b></code>: <code><b>Helloxthere</b></code> se divide en <code><b>Hello</b></code>, <code><b>there</b></code></td>
								</tr>
								<tr>
									<td>Digits</td>
									<td>Divide los números de cualquier otro carácter</td>
									<td><code><b>Hello123there</b></code> se divide en <code><b>Hello</b></code>, <code><b>123</b></code>, <code><b>there</b></code></td>
								</tr>
								<tr>
									<td>Split</td>
									<td>Pretokenizador versátil que divide según el patrón y el comportamiento proporcionados. El patrón se puede invertir si es necesario. El patrón debe ser una cadena personalizada o una <a href="https://maximofn.com/regular-expressions/" target="_blank">regex</a>. El comportamiento debe ser <code><b>removed</b></code>, <code><b>isolated</b></code>, <code><b>merged_with_previous</b></code>, <code><b>merged_with_next</b></code>, <code><b>contiguous</b></code>. Para invertir se indica con un booleano</td>
									<td>Ejemplo con pattern=<code><b>" "</b></code>, behavior=<code><b>isolated</b></code>, invert=<code><b>False</b></code>: <code><b>Hello, how are you?</b></code> se divide en <code><b>Hello,</b></code>, <code><b> </b></code>, <code><b>how</b></code>, <code><b> </b></code>, <code><b>are</b></code>, <code><b> </b></code>, <code><b>you?</b></code></td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos a crear un pre tokenizador para ver cómo funciona</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pre_tokenizers</span></p>
<p></p>
<p><span style="color: #6b97e8;">pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">Digits</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">individual_digits</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;I paid $30 for the car&quot;</span></p>
<p><span style="color: #6b97e8;">pre_tokenized_text</span> <span>=</span> <span style="color: #6b97e8;">pre_tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenize_str</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">pre_tokenized_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>[('I paid $', (0, 8)),</p><p> ('3', (8, 9)),</p><p> ('0', (9, 10)),</p><p> (' for the car', (10, 22))]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para usar varios pre tokenizadores podemos usar el método <code><b>Sequence</b></code></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">custom_pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">Sequence</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">Whitespace</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">Digits</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">individual_digits</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)])</span></p>
<p></p>
<p><span style="color: #6b97e8;">pre_tokenized_text</span> <span>=</span> <span style="color: #6b97e8;">custom_pre_tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenize_str</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">pre_tokenized_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>[('I', (0, 1)),</p><p> ('paid', (2, 6)),</p><p> ('$', (7, 8)),</p><p> ('3', (8, 9)),</p><p> ('0', (9, 10)),</p><p> ('for', (11, 14)),</p><p> ('the', (15, 18)),</p><p> ('car', (19, 22))]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para modificar el pre tokenizador de un tokenizador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">custom_pre_tokenizer</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Tokenización">
								<a class="anchor-link" href="#Tokenización">
									<p style="margin-left: 20px">Tokenización</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Una vez normalizados y pretokenizados los textos de entrada, el tokenizador aplica el modelo a los pretokens. Esta es la parte del proceso que debe entrenarse con el corpus (o que ya se ha entrenado si se utiliza un tokenizador preentrenado).</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">La función del modelo es dividir las "palabras" en tokens utilizando las reglas que ha aprendido. También es responsable de asignar esos tokens a sus ID correspondientes en el vocabulario del modelo.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">El modelo tiene un tamaño de vocabulario, es decir, tiene una cantidad finita de tokens, por lo que tiene que descomponer las palabras y asignarlas a uno de esos tokens.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Este modelo se pasa al inicializar el Tokenizer. Actualmente, la librería 🤗 Tokenizers soporta:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Modelo</th>
									<th>Descripción</th>
								</tr>
								<tr>
									<td>WordLevel</td>
									<td>Este es el algoritmo "clásico" de tokenización. Te permite simplemente asignar palabras a IDs sin nada sofisticado. Tiene la ventaja de ser muy fácil de usar y entender, pero requiere vocabularios extremadamente grandes para una buena cobertura. El uso de este modelo requiere el uso de un PreTokenizer. Este modelo no realiza ninguna elección directamente, simplemente asigna tokens de entrada a IDs.</td>
								</tr>
								<tr>
									<td>BPE (Byte Pair Encoding)</td>
									<td>Uno de los algoritmos de tokenización de subpalabras más populares. El Byte-Pair-Encoding funciona empezando con caracteres y fusionando los que se ven juntos con más frecuencia, creando así nuevos tokens. A continuación, trabaja de forma iterativa para construir nuevos tokens a partir de los pares más frecuentes que ve en un corpus. BPE es capaz de construir palabras que nunca ha visto utilizando múltiples subpalabras y, por tanto, requiere vocabularios más pequeños, con menos posibilidades de tener palabras <code><b>unk</b></code> (desconocidas).</td>
								</tr>
								<tr>
									<td>WordPiece</td>
									<td>Se trata de un algoritmo de tokenización de subpalabras bastante similar a BPE, utilizado principalmente por Google en modelos como BERT. Utiliza un algoritmo codicioso que intenta construir primero palabras largas, dividiéndolas en varios tokens cuando no existen palabras completas en el vocabulario. A diferencia de BPE, que parte de los caracteres y construye tokens lo más grandes posible. Utiliza el famoso prefijo ## para identificar los tokens que forman parte de una palabra (es decir, que no empiezan una palabra).</td>
								</tr>
								<tr>
									<td>Unigram</td>
									<td>Unigram es también un algoritmo de tokenización de subpalabras, y funciona tratando de identificar el mejor conjunto de tokens de subpalabras para maximizar la probabilidad de una frase dada. Se diferencia de BPE en que no es un algoritmo determinista basado en un conjunto de reglas aplicadas secuencialmente. En su lugar, Unigram podrá calcular múltiples formas de tokenizar, eligiendo la más probable.</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Cuando se crea un tokenizador se le tiene que pasar el modelo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Tokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">models</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">Tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">models</span><span>.</span><span style="color: #6b97e8;">Unigram</span><span style="color: #e3e11d;">())</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos a pasarle el normalizador y el pre tokenizador que hemos creado</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">normalizer</span> <span>=</span> <span style="color: #6b97e8;">custom_normalizer</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">custom_pre_tokenizer</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Ahora hay que entrenar el modelo o cargar uno preentrenado. En este caso vamos a entrenar uno con el corpus que nos hemos descargado</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Entrenamiento-del-modelo">
								<a class="anchor-link" href="#Entrenamiento-del-modelo">
									<p style="margin-left: 30px">Entrenamiento del modelo</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para entrenar el modelo tenemos varios tipos de <code><b>Trainer</b></code>s</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Trainer</th>
									<th>Descripción</th>
								</tr>
								<tr>
									<td>WordLevelTrainer</td>
									<td>Entrena un tokenizador WordLevel</td>
								</tr>
								<tr>
									<td>BpeTrainer</td>
									<td>Entrena un tokenizador BPE</td>
								</tr>
								<tr>
									<td>WordPieceTrainer</td>
									<td>Entrena un tokenizador WordPiece</td>
								</tr>
								<tr>
									<td>UnigramTrainer</td>
									<td>Entrena un tokenizador Unigram</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Casi todos los trainers tienen los mismos parámetros, que son:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>vocab_size: El tamaño del vocabulario final, incluidos todos los tokens y el alfabeto.</li>
									<li>show_progress: Mostrar o no barras de progreso durante el entrenamiento</li>
									<li>special_tokens: Una lista de fichas especiales que el modelo debe conocer</li>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">A parte de estos parámetros, cada trainer tiene sus propios parámetros, para verlos mirar la documentación de los <a href="https://huggingface.co/docs/tokenizers/api/trainers" target="_blank">Trainers</a></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para entrenar tenemos que crear un <code><b>Trainer</b></code>, como el modelo que hemos creado es un <code><b>Unigram</b></code> vamos a crear un <code><b>UnigramTrainer</b></code></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.trainers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">trainers</span></p>
<p></p>
<p><span style="color: #6b97e8;">trainer</span> <span>=</span> <span style="color: #6b97e8;">trainers</span><span>.</span><span style="color: #6b97e8;">UnigramTrainer</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">vocab_size</span><span>=</span><span style="color: #7e7a38;">20000</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">initial_alphabet</span><span>=</span><span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">ByteLevel</span><span>.</span><span style="color: #6b97e8;">alphabet</span><span style="color: #e3e11d;">(),</span></p>
<p>    <span style="color: #6b97e8;">special_tokens</span><span>=</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;&lt;PAD&gt;&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;&lt;BOS&gt;&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;&lt;EOS&gt;&quot;</span><span style="color: #e3e11d;">],</span></p>
<p><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Una vez hemos creado el <code><b>Trainer</b></code> hay dos maneras de entrear, mediante el método <code><b>train</b></code>, al que se le pasa una lista de archivos, o mediante el método <code><b>train_from_iterator</b></code> al que se le pasa un iterador</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h5 id="Entrenamiento-del-modelo-con-el-método-`train`">
								<a class="anchor-link" href="#Entrenamiento-del-modelo-con-el-método-`train`">
									<p style="margin-left: 40px">Entrenamiento del modelo con el método <code><b>train</b></code></p>
								</a>
							</h5>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Primero creamos una lista de archivos con el corpus</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">files</span> <span>=</span> <span style="color: #e3e11d;">[</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;wikitext-103/wiki.</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">split</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">.tokens&quot;</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">split</span> <span style="color: #7f6e38;">in</span> <span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;test&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;valid&quot;</span><span style="color: #e3e11d;">]]</span></p>
<p><span style="color: #6b97e8;">files</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['wikitext-103/wiki.test.tokens',</p><p> 'wikitext-103/wiki.train.tokens',</p><p> 'wikitext-103/wiki.valid.tokens']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Y ahora entrenamos el modelo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">train</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">files</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">trainer</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h5 id="Entrenamiento-del-modelo-con-el-método-`train_from_iterator`">
								<a class="anchor-link" href="#Entrenamiento-del-modelo-con-el-método-`train_from_iterator`">
									<p style="margin-left: 40px">Entrenamiento del modelo con el método <code><b>train_from_iterator</b></code></p>
								</a>
							</h5>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Primero creamos una función que nos devuelva un iterador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">iterator</span><span style="color: #e3e11d;">():</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">file</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">files</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #a04cc1;">with</span> <span style="color: #dfd84a;">open</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">file</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;r&quot;</span><span style="color: #e3e11d;">)</span> <span style="color: #a04cc1;">as</span> <span style="color: #6b97e8;">f</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">line</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">f</span><span style="color: #e3e11d;">:</span></p>
<p>                <span style="color: #a04cc1;">yield</span> <span style="color: #6b97e8;">line</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Ahora volvemos a entrenar el modelo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">train_from_iterator</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">iterator</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">trainer</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h5 id="Entrenamiento-del-modelo-con-el-método-`train_from_iterator`-desde-un-dataset-de-Hugging-Face">
								<a class="anchor-link" href="#Entrenamiento-del-modelo-con-el-método-`train_from_iterator`-desde-un-dataset-de-Hugging-Face">
									<p style="margin-left: 40px">Entrenamiento del modelo con el método <code><b>train_from_iterator</b></code> desde un dataset de Hugging Face</p>
								</a>
							</h5>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Si nos hubiésemos descargado el dataset de Hugging Face, podríamos haber entrenado el modelo directamente desde el dataset</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">datasets</span></p>
<p></p>
<p><span style="color: #6b97e8;">dataset</span> <span>=</span> <span style="color: #6b97e8;">datasets</span><span>.</span><span style="color: #6b97e8;">load_dataset</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;wikitext&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;wikitext-103-raw-v1&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">split</span><span>=</span><span style="color: #7e7a34;">&quot;train+test+validation&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Ahora podemos crear un iterador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">batch_iterator</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_size</span><span>=</span><span style="color: #7e7a38;">1000</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">),</span> <span style="color: #6b97e8;">batch_size</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #a04cc1;">yield</span> <span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">i</span> <span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">i</span> <span>+</span> <span style="color: #6b97e8;">batch_size</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;text&quot;</span><span style="color: #e3e11d;">]</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Volvemos a entrenar el modelo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">train_from_iterator</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_iterator</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">trainer</span><span>=</span><span style="color: #6b97e8;">trainer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">length</span><span>=</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">))</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Guardando-el-modelo">
								<a class="anchor-link" href="#Guardando-el-modelo">
									<p style="margin-left: 30px">Guardando el modelo</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Una vez se ha entrenado el modelo, se puede guardar para usarlo en el futuro. Para guardar el modelo hay que hacerlo en un archivo <code><b>json</b></code></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">save</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;wikitext-103-tokenizer.json&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Cargando-el-modelo-preentrenado">
								<a class="anchor-link" href="#Cargando-el-modelo-preentrenado">
									<p style="margin-left: 30px">Cargando el modelo preentrenado</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Podemos cargar un modelo preentrenado a partir de un <code><b>json</b></code> en vez de tener que entrenarlo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">from_file</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;wikitext-103-tokenizer.json&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>&lt;tokenizers.Tokenizer at 0x7f1dd7784a30&gt;</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">También podemos cargar un modelo preentrenado disponible en el Hub de Hugging Face</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #8d783e;">&#39;bert-base-uncased&#39;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>&lt;tokenizers.Tokenizer at 0x7f1d64a75e30&gt;</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Post-procesamiento">
								<a class="anchor-link" href="#Post-procesamiento">
									<p style="margin-left: 20px">Post procesamiento</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Es posible que queramos que nuestro tokenizador añada automáticamente tokens especiales, como <code><b>[CLS]</b></code> o <code><b>[SEP]</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">En Hugging Face están implementados los siguientes post procesadores</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>PostProcesador</th>
									<th>Descripción</th>
									<th>Ejemplo</th>
								</tr>
								<tr>
									<td>BertProcessing</td>
									<td>Este post-procesador se encarga de añadir los tokens especiales que necesita un modelo Bert (<code><b>SEP</b></code> y <code><b>CLS</b></code>)</td>
									<td><code><b>Hello, how are you?</b></code> se convierte en <code><b>[CLS]</b></code>, <code><b>Hello</b></code>, <code><b>,</b></code>, <code><b>how</b></code>, <code><b>are</b></code>, <code><b>you</b></code>, <code><b>?</b></code>, <code><b>[SEP]</b></code></td>
								</tr>
								<tr>
									<td>RobertaProcessing</td>
									<td>Este post-procesador se encarga de añadir los tokens especiales que necesita un modelo Roberta (<code><b>SEP</b></code> y <code><b>CLS</b></code>). También se encarga de recortar los offsets. Por defecto, el ByteLevel BPE puede incluir espacios en blanco en los tokens producidos. Si no desea que las compensaciones incluyan estos espacios en blanco, hay que inicializar este PostProcessor con <code><b>trim_offsets=True</b></code>.</td>
									<td><code><b>Hello, how are you?</b></code> se convierte en <code><b><s></b></code>, <code><b>Hello</b></code>, <code><b>,</b></code>, <code><b>how</b></code>, <code><b>are</b></code>, <code><b>you</b></code>, <code><b>?</b></code>, <code><b></s></b></code></td>
								</tr>
								<tr>
									<td>ElectraProcessing</td>
									<td>Añade tokens especiales para ELECTRA</td>
									<td><code><b>Hello, how are you?</b></code> se convierte en <code><b>[CLS]</b></code>, <code><b>Hello</b></code>, <code><b>,</b></code>, <code><b>how</b></code>, <code><b>are</b></code>, <code><b>you</b></code>, <code><b>?</b></code>, <code><b>[SEP]</b></code></td>
								</tr>
								<tr>
									<td>TemplateProcessing</td>
									<td>Permite crear fácilmente una plantilla para el postprocesamiento, añadiendo tokens especiales y especificando el type_id de cada secuencia/token especial. La plantilla recibe dos cadenas que representan la secuencia única y el par de secuencias, así como un conjunto de tokens especiales a utilizar</td>
									<td>Example, when specifying a template with these values: single:<code><b>[CLS] $A [SEP]</b></code>, pair: <code><b>[CLS] $A [SEP] $B [SEP]</b></code>, special tokens: <code><b>[CLS]</b></code>, <code><b>[SEP]</b></code>. Input: (<code><b>I like this</b></code>, <code><b>but not this</b></code>), Output: <code><b>[CLS] I like this [SEP] but not this [SEP]</b></code></td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos a crear un post tokenizador para ver cómo funciona</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.processors</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">TemplateProcessing</span></p>
<p></p>
<p><span style="color: #6b97e8;">post_processor</span> <span>=</span> <span style="color: #6b97e8;">TemplateProcessing</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">single</span><span>=</span><span style="color: #7e7a34;">&quot;[CLS] $A [SEP]&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">pair</span><span>=</span><span style="color: #7e7a34;">&quot;[CLS] $A [SEP] $B:1 [SEP]:1&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">special_tokens</span><span>=</span><span style="color: #e3e11d;">[(</span><span style="color: #7e7a34;">&quot;[CLS]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">),</span> <span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;[SEP]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">)],</span></p>
<p><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para modificar el post tokenizador de un tokenizador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">post_processor</span> <span>=</span> <span style="color: #6b97e8;">post_processor</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Veamos cómo funciona</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;I paid $30 for the car&quot;</span></p>
<p><span style="color: #6b97e8;">decoded_text</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">decoded_text</span><span>.</span><span style="color: #6b97e8;">tokens</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'i', 'paid', '$', '3', '0', 'for', 'the', 'car', '[SEP]']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_text1</span> <span>=</span> <span style="color: #7e7a34;">&quot;Hello, y&#39;all!&quot;</span></p>
<p><span style="color: #6b97e8;">input_text2</span> <span>=</span> <span style="color: #7e7a34;">&quot;How are you?&quot;</span></p>
<p><span style="color: #6b97e8;">decoded_text</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text1</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">input_text2</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">decoded_text</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'hell', 'o', ',', 'y', "'", 'all', '!', '[SEP]', 'how', 'are', 'you', '?', '[SEP]']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Si ahora guardásemos el tokenizador, el post tokenizador se guardaría con él</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Encoding">
								<a class="anchor-link" href="#Encoding">
									<p style="margin-left: 20px">Encoding</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Una vez tenemos el tokenizador entrenado, podemos usarlo para tokenizar textos</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;I love tokenizers!&quot;</span></p>
<p><span style="color: #6b97e8;">encoded_text</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos a ver qué obtenemos al tokenizar un texto</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_text</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>tokenizers.Encoding</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Obtenemos un objeto de tipo <a href="https://huggingface.co/docs/tokenizers/api/encoding#tokenizers.Encoding" target="_blank">Encoding</a>, que contiene los tokens y los ids de los tokens</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Los <code><b>ids</b></code> son los <code><b>id</b></code>s de los tokens en el vocabulario del tokenizador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">ids</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>[1, 17, 383, 10694, 17, 3533, 3, 586, 2]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Los <code><b>tokens</b></code> son los tokens a los que equivalen los <code><b>ids</b></code></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">tokens</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'i', 'love', 'token', 'i', 'zer', 's', '!', '[SEP]']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Si tenemos varias secuencias podemos codificarlas todas a la vez</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">encoded_texts</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text1</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">input_text2</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span>.</span><span style="color: #6b97e8;">type_ids</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'hell', 'o', ',', 'y', "'", 'all', '!', '[SEP]', 'how', 'are', 'you', '?', '[SEP]']</p><p>[1, 2215, 7, 5, 22, 26, 81, 586, 2, 98, 59, 213, 902, 2]</p><p>[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Sin embargo, cuando se tienen varias secuencias es mejor usar el método <code><b>encode_batch</b></code></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">encoded_texts</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode_batch</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">input_text1</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">input_text2</span><span style="color: #e3e11d;">])</span></p>
<p></p>
<p><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>list</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vemos que obtenemos una lista</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'hell', 'o', ',', 'y', "'", 'all', '!', '[SEP]']</p><p>[1, 2215, 7, 5, 22, 26, 81, 586, 2]</p><p>['[CLS]', 'how', 'are', 'you', '?', '[SEP]']</p><p>[1, 98, 59, 213, 902, 2]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Decoding">
								<a class="anchor-link" href="#Decoding">
									<p style="margin-left: 20px">Decoding</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Además de codificar los textos de entrada, un Tokenizer también tiene un método para decodificar, es decir, convertir los ID generados por su modelo de nuevo a un texto. Esto se hace mediante los métodos <code><b>Tokenizer.decode</b></code> (para un texto predicho) y <code><b>Tokenizer.decode_batch</b></code> (para un lote de predicciones).</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Los tipos de decodificación que se pueden usar son:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Decodificación</th>
									<th>Descripción</th>
								</tr>
								<tr>
									<td>BPEDecoder</td>
									<td>Revierte el modelo BPE</td>
								</tr>
								<tr>
									<td>ByteLevel</td>
									<td>Revierte el ByteLevel PreTokenizer. Este PreTokenizer codifica a nivel de byte, utilizando un conjunto de caracteres Unicode visibles para representar cada byte, por lo que necesitamos un Decoder para revertir este proceso y obtener algo legible de nuevo.</td>
								</tr>
								<tr>
									<td>CTC</td>
									<td>Revierte el modelo CTC</td>
								</tr>
								<tr>
									<td>Metaspace</td>
									<td>Revierte el PreTokenizer de Metaspace. Este PreTokenizer utiliza un identificador especial ▁ para identificar los espacios en blanco, por lo que este Decoder ayuda con la decodificación de estos.</td>
								</tr>
								<tr>
									<td>WordPiece</td>
									<td>Revierte el modelo WordPiece. Este modelo utiliza un identificador especial ## para las subpalabras continuas, por lo que este decodificador ayuda a decodificarlas.</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">El decodificador convertirá primero los IDs en tokens (usando el vocabulario del tokenizador) y eliminará todos los tokens especiales, después unirá esos tokens con espacios en blanco.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos a crear un decoder</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">decoders</span></p>
<p></p>
<p><span style="color: #6b97e8;">decoder</span> <span>=</span> <span style="color: #6b97e8;">decoders</span><span>.</span><span style="color: #6b97e8;">ByteLevel</span><span style="color: #e3e11d;">()</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Lo añadimos al tokenizador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decoder</span> <span>=</span> <span style="color: #6b97e8;">decoder</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Decodificamos</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">decoded_text</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">decoded_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>('I love tokenizers!', 'ilovetokenizers!')</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">decoded_texts</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode_batch</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">])</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text1</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">decoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">])</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text2</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">decoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">])</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Hello, y'all! hello,y'all!</p><p>How are you? howareyou?</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="BERT-tokenizer">
								<a class="anchor-link" href="#BERT-tokenizer">
									<p style="margin-left: 10px">BERT tokenizer</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Con todo lo aprendido vamos a crear el tokenizador de BERT desde cero, primero creamos el tokenizador. Bert usa <code><b>WordPiece</b></code> como modelo, por lo que lo pasamos al inicializar del tokenizador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Tokenizer</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.models</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">WordPiece</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">Tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">WordPiece</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">unk_token</span><span>=</span><span style="color: #7e7a34;">&quot;[UNK]&quot;</span><span style="color: #e3e11d;">))</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">BERT preprocesa los textos eliminando los acentos y las minúsculas. También utilizamos un normalizador unicode</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">normalizers</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.normalizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">NFD</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">Lowercase</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">StripAccents</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">normalizer</span> <span>=</span> <span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">Sequence</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">NFD</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">Lowercase</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">StripAccents</span><span style="color: #e3e11d;">()])</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">El pretokenizador sólo divide los espacios en blanco y los signos de puntuación.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.pre_tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Whitespace</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">Whitespace</span><span style="color: #e3e11d;">()</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Y el post-procesamiento utiliza la plantilla que vimos en la sección anterior</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.processors</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">TemplateProcessing</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">post_processor</span> <span>=</span> <span style="color: #6b97e8;">TemplateProcessing</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">single</span><span>=</span><span style="color: #7e7a34;">&quot;[CLS] $A [SEP]&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">pair</span><span>=</span><span style="color: #7e7a34;">&quot;[CLS] $A [SEP] $B:1 [SEP]:1&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">special_tokens</span><span>=</span><span style="color: #e3e11d;">[</span></p>
<p>        <span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;[CLS]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">),</span></p>
<p>        <span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;[SEP]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">),</span></p>
<p>    <span style="color: #e3e11d;">],</span></p>
<p><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Entrenamos el tokenizador con el dataset de wikitext-103</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.trainers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">WordPieceTrainer</span></p>
<p></p>
<p><span style="color: #6b97e8;">trainer</span> <span>=</span> <span style="color: #6b97e8;">WordPieceTrainer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">vocab_size</span><span>=</span><span style="color: #7e7a38;">30522</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">special_tokens</span><span>=</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;[UNK]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;[CLS]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;[SEP]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;[PAD]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;[MASK]&quot;</span><span style="color: #e3e11d;">])</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">files</span> <span>=</span> <span style="color: #e3e11d;">[</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;wikitext-103/wiki.</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">split</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">.tokens&quot;</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">split</span> <span style="color: #7f6e38;">in</span> <span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;test&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;valid&quot;</span><span style="color: #e3e11d;">]]</span></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">train</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">files</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">trainer</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Ahora lo probamos</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;I love tokenizers!&quot;</span></p>
<p></p>
<p><span style="color: #6b97e8;">encoded_text</span> <span>=</span> <span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">decoded_text</span> <span>=</span> <span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;El texto de entrada &#39;</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_text</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&#39; se convierte en los tokens </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">, que tienen las ids </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;"> y luego se decodifica como &#39;</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">decoded_text</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&#39;&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>El texto de entrada 'I love tokenizers!' se convierte en los tokens ['[CLS]', 'i', 'love', 'token', '##izers', '!', '[SEP]'], que tienen las ids [1, 51, 2867, 25791, 12213, 5, 2] y luego se decodifica como 'i love token ##izers !'</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	<!-- Close class contenido -->
	</div>
<!-- Close div notebook container -->
</div>
<!-- Close div notebook -->
</div>


