<p>
	<!-- Custom stylesheet, it must be in the same directory as the html file -->
	<!-- Loading mathjax macro --><!-- Load mathjax --><!-- MathJax configuration -->
<p>
<style>
	/* Media query para pantallas grandes */
	@media screen and (min-width: 1000px) {
		.container {
			flex-wrap: nowrap;
			display: flex;
			justify-content: space-between;
			height: 100vh; /* altura del viewport */
		}
		
		.indice {
			width: 25%; /* Ancho del √≠ndice en pantallas grandes */
			border-right: 1px solid #ccc;
			max-height: calc(100vh - 40px); /* Ajustar seg√∫n tus necesidades. Aqu√≠ estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
		
		.contenido {
			width: 70%; /* Ancho del contenido en pantallas grandes */
			max-height: calc(100vh - 40px); /* Ajustar seg√∫n tus necesidades. Aqu√≠ estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
	}
</style>
<!-- Open div notebook -->
<div id="notebook" class="border-box-sizing" tabindex="-1">
	<!-- Open div notebook container -->
	<div id="notebook-container" class="container">
		<!-- Open div indice -->
		<div class="indice">
			<!-- Open div index header -->
			<div class="cell border-box-sizing text_cell rendered">
				<h2 class="prompt input_prompt">
					<span style="
					color: var(--darkreader-text--heading-color, var(--darkreader-text--heading-2-color,
					var(--darkreader-text--headings-color)));
					font-family: var(--fontFamily); font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-color: var(--darkreader-text--darkreader-text--heading-color,
					var(--darkreader-text--darkreader-text--heading-2-color, var(--darkreader-text--darkreader-text--headings-color)));
					--darkreader-inline-bgcolor: transparent;"
					data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">
						√çndice
					</span>
					<a class="anchor-link" style="
					font-family: var(--fontFamily);
					font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-bgcolor: transparent;"
					href="#√çndice" data-darkreader-inline-bgcolor="">
					</a>
				</h2>
			<!-- Close div index header -->
			</div>
			<!-- Index body -->
			<div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="The-tokenization-pipeline-index">
									<a class="anchor-link" href="#The-tokenization-pipeline">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">The tokenization pipeline</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Standardization-index">
									<a class="anchor-link" href="#Standardization">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Standardization</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Pre-tokenization-index">
									<a class="anchor-link" href="#Pre-tokenization">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Pre-tokenization</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Tokenization-index">
									<a class="anchor-link" href="#Tokenization">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Tokenization</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Model-training-index">
									<a class="anchor-link" href="#Model-training">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Model training</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h5 id="Model-training-with-the-`train`-method-index">
									<a class="anchor-link" href="#Model-training-with-the-`train`-method">
										<p style="margin-left: 120px; font-size: 12px; line-height: 1.5;">Model training with the <code><b>train</b></code> method</p>
									</a>
								</h5>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h5 id="Model-training-with-`train_from_iterator`-method-index">
									<a class="anchor-link" href="#Model-training-with-`train_from_iterator`-method">
										<p style="margin-left: 120px; font-size: 12px; line-height: 1.5;">Model training with <code><b>train_from_iterator</b></code> method</p>
									</a>
								</h5>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h5 id="Training-the-model-with-the-`train_from_iterator`-method-from-a-Hugging-Face-dataset-index">
									<a class="anchor-link" href="#Training-the-model-with-the-`train_from_iterator`-method-from-a-Hugging-Face-dataset">
										<p style="margin-left: 120px; font-size: 12px; line-height: 1.5;">Training the model with the <code><b>train_from_iterator</b></code> method from a Hugging Face dataset</p>
									</a>
								</h5>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Saving-the-model-index">
									<a class="anchor-link" href="#Saving-the-model">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Saving the model</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Loading-the-pre-trained-model-index">
									<a class="anchor-link" href="#Loading-the-pre-trained-model">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Loading the pre-trained model</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Post-processing-index">
									<a class="anchor-link" href="#Post-processing">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Post processing</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Encoding-index">
									<a class="anchor-link" href="#Encoding">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Encoding</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Decoding-index">
									<a class="anchor-link" href="#Decoding">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Decoding</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="BERT-tokenizer-index">
									<a class="anchor-link" href="#BERT-tokenizer">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">BERT tokenizer</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
			</div>
		<!-- Close div indice -->
		</div>
 
		<!-- Content -->
		<div class="contenido">
		<div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;"><a href="https://colab.research.google.com/github/maximofn/portafolio/blob/main/posts/notebooks_translated/2024-02-26-Hugging-Face-tokenizers_EN.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h1 id="Hugging-Face-tokenizers">
								<a class="anchor-link" href="#Hugging-Face-tokenizers">
									<p style="margin-left: 0px">Hugging Face tokenizers</p>
								</a>
							</h1>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The Hugging Face <code><b>tokenizers</b></code> library provides an implementation of today`s most commonly used tokenizers, focusing on performance and versatility. In the post <a href="https://maximofn.com/tokens/" target="_blank">tokens</a> we already saw the importance of tokens when processing text, since computers do not understand words, but numbers. Therefore, it is necessary to convert words to numbers so that language models can process them.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">This notebook has been automatically translated to make it accessible to more people, please let me know if you see any typos.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">## Installation</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To install <code><b>tokenizers</b></code> with pip:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 80px;"><code>pip install tokenizers<br></code></p>
						</div>
					</div>
				</div>
			</div>
	
	
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">to install <code><b>tokenizers</b></code> with conda:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 80px;"><code>conda install conda-forge::tokenizers<br></code></p>
						</div>
					</div>
				</div>
			</div>
	
	
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="The-tokenization-pipeline">
								<a class="anchor-link" href="#The-tokenization-pipeline">
									<p style="margin-left: 10px">The tokenization pipeline</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To tokenize a sequence, <code><b>Tokenizer.encode</b></code> is used, which performs the following steps:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Standardization</li>
									<li>pre-tokenization</li>
									<li>Tokenization</li>
									<li>Post-tokenization</li>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's take a look at each one</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">For this post we are going to use the dataset <a href="https://blog.einstein.ai/the-wikitext-long-term-dependency-language-modeling-dataset/" target="_blank">wikitext-103</a></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #7f6e38;">!</span><span style="color: #6b97e8;">wget</span> <span style="color: #6b97e8;">https</span><span style="color: #e3e11d;">:</span><span>//</span><span style="color: #6b97e8;">dax</span><span>-</span><span style="color: #6b97e8;">cdn</span><span>.</span><span style="color: #6b97e8;">cdn</span><span>.</span><span style="color: #6b97e8;">appdomain</span><span>.</span><span style="color: #6b97e8;">cloud</span><span>/</span><span style="color: #6b97e8;">dax</span><span>-</span><span style="color: #6b97e8;">wikitext</span><span>-</span><span style="color: #7e7a38;">103</span><span>/</span><span style="color: #a09e19;">1.0.1</span><span>/</span><span style="color: #6b97e8;">wikitext</span><span>-</span><span style="color: #a09e19;">103.</span><span style="color: #6b97e8;">tar</span><span>.</span><span style="color: #6b97e8;">gz</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>200 OK</p><p>Length: 189603606 (181M) [application/x-gzip]</p><p>Saving to: ‚Äòwikitext-103.tar.gz‚Äô</p><p>wikitext-103.tar.gz 100%[===================&gt;] 180,82M  6,42MB/s    in 30s     </p><p>2024-02-26 08:14:42 (5,95 MB/s) - ‚Äòwikitext-103.tar.gz‚Äô saved [189603606/189603606]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #7f6e38;">!</span><span style="color: #6b97e8;">tar</span> <span>-</span><span style="color: #6b97e8;">xvzf</span> <span style="color: #6b97e8;">wikitext</span><span>-</span><span style="color: #a09e19;">103.</span><span style="color: #6b97e8;">tar</span><span>.</span><span style="color: #6b97e8;">gz</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>wikitext-103/</p><p>wikitext-103/wiki.test.tokens</p><p>wikitext-103/wiki.valid.tokens</p><p>wikitext-103/README.txt</p><p>wikitext-103/LICENSE.txt</p><p>wikitext-103/wiki.train.tokens</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #7f6e38;">!</span><span style="color: #6b97e8;">rm</span> <span style="color: #6b97e8;">wikitext</span><span>-</span><span style="color: #a09e19;">103.</span><span style="color: #6b97e8;">tar</span><span>.</span><span style="color: #6b97e8;">gz</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Standardization">
								<a class="anchor-link" href="#Standardization">
									<p style="margin-left: 20px">Standardization</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Normalization are operations that are applied to the text before tokenization, such as removing whitespace, converting to lowercase, removing special characters, etc. The following normalizations are implemented in Hugging Face:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Normalizaci√≥n</th>
									<th>Descripci√≥n</th>
									<th>Ejemplo</th>
								</tr>
								<tr>
									<td>NFD (Normalization for D)</td>
									<td>Los caracteres se descomponen por equivalencia can√≥nica</td>
									<td><code><b>√¢</b></code> (U+00E2) se descompone en <code><b>a</b></code> (U+0061) + <code><b>^</b></code> (U+0302)</td>
								</tr>
								<tr>
									<td>NFKD (Normalization Form KD)</td>
									<td>Los caracteres se descomponen por compatibilidad</td>
									<td><code><b>Ô¨Å</b></code> (U+FB01) se descompone en <code><b>f</b></code> (U+0066) + <code><b>i</b></code> (U+0069)</td>
								</tr>
								<tr>
									<td>NFC (Normalization Form C)</td>
									<td>Los caracteres se descomponen y luego se recomponen por equivalencia can√≥nica</td>
									<td><code><b>√¢</b></code> (U+00E2) se descompone en <code><b>a</b></code> (U+0061) + <code><b>^</b></code> (U+0302) y luego se recompone en <code><b>√¢</b></code> (U+00E2)</td>
								</tr>
								<tr>
									<td>NFKC (Normalization Form KC)</td>
									<td>Los caracteres se descomponen por compatibilidad y luego se recomponen por equivalencia can√≥nica</td>
									<td><code><b>Ô¨Å</b></code> (U+FB01) se descompone en <code><b>f</b></code> (U+0066) + <code><b>i</b></code> (U+0069) y luego se recompone en <code><b>f</b></code> (U+0066) + <code><b>i</b></code> (U+0069)</td>
								</tr>
								<tr>
									<td>Lowercase</td>
									<td>Convierte el texto a min√∫sculas</td>
									<td><code><b>Hello World</b></code> se convierte en <code><b>hello world</b></code></td>
								</tr>
								<tr>
									<td>Strip</td>
									<td>Elimina todos los espacios en blanco de los lados especificados (izquierdo, derecho o ambos) del texto</td>
									<td><code><b>  Hello World  </b></code> se convierte en <code><b>Hello World</b></code></td>
								</tr>
								<tr>
									<td>StripAccents</td>
									<td>Elimina todos los s√≠mbolos de acento en unicode (se utilizar√° con NFD por coherencia)</td>
									<td><code><b>√°</b></code> (U+00E1) se convierte en <code><b>a</b></code> (U+0061)</td>
								</tr>
								<tr>
									<td>Replace</td>
									<td>Sustituye una cadena personalizada o <a href="https://maximofn.com/regular-expressions/" target="_blank">regex</a> y la cambia por el contenido dado</td>
									<td><code><b>Hello World</b></code> se convierte en <code><b>Hello Universe</b></code></td>
								</tr>
								<tr>
									<td>BertNormalizer</td>
									<td>Proporciona una implementaci√≥n del Normalizador utilizado en el BERT original. Las opciones que se pueden configurar son <code><b>clean_text</b></code>, <code><b>handle_chinese_chars</b></code>, <code><b>strip_accents</b></code> y <code><b>lowercase</b></code></td>
									<td><code><b>Hello World</b></code> se convierte en <code><b>hello world</b></code></td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's create a normalizer to see how it works.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">normalizers</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_normalizer</span> <span>=</span> <span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">BertNormalizer</span><span style="color: #e3e11d;">()</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;H√©ll√≤ h√¥w are √º?&quot;</span></p>
<p><span style="color: #6b97e8;">normalized_text</span> <span>=</span> <span style="color: #6b97e8;">bert_normalizer</span><span>.</span><span style="color: #6b97e8;">normalize_str</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">normalized_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>'hello how are u?'</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To use several normalizers we can use the <code><b>Sequence</b></code> method</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">custom_normalizer</span> <span>=</span> <span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">Sequence</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">NFKC</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">BertNormalizer</span><span style="color: #e3e11d;">()])</span></p>
<p></p>
<p><span style="color: #6b97e8;">normalized_text</span> <span>=</span> <span style="color: #6b97e8;">custom_normalizer</span><span>.</span><span style="color: #6b97e8;">normalize_str</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">normalized_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>'hello how are u?'</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To modify the normalizer of a tokenizer</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">tokenizers</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">tokenizers</span><span>.</span><span style="color: #6b97e8;">BertWordPieceTokenizer</span><span style="color: #e3e11d;">()</span> <span style="color: #7f6e38;"># or any other tokenizer</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">normalizer</span> <span>=</span> <span style="color: #6b97e8;">custom_normalizer</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Pre-tokenization">
								<a class="anchor-link" href="#Pre-tokenization">
									<p style="margin-left: 20px">Pre-tokenization</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Pretokenization is the act of breaking a text into smaller objects. The pretokenizer will split the text into "words" and the final tokens will be parts of those words.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The PreTokenizer is responsible for splitting the input according to a set of rules. This preprocessing allows you to make sure that the tokenizer does not build tokens across multiple "splits". For example, if you don't want to have whitespace within a token, then you can have a pre tokenizer that splits in words from whitespace.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The following pre tokenizers are implemented in Hugging Face</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>PreTokenizer</th>
									<th>Descripci√≥n</th>
									<th>Ejemplo</th>
								</tr>
								<tr>
									<td>ByteLevel</td>
									<td>Divide en espacios en blanco mientras reasigna todos los bytes a un conjunto de caracteres visibles. Esta t√©cnica fue introducida por OpenAI con GPT-2 y tiene algunas propiedades m√°s o menos buenas: Como mapea sobre bytes, un tokenizador que utilice esto s√≥lo requiere 256 caracteres como alfabeto inicial (el n√∫mero de valores que puede tener un byte), frente a los m√°s de 130.000 caracteres Unicode. Una consecuencia del punto anterior es que es absolutamente innecesario tener un token desconocido usando esto ya que podemos representar cualquier cosa con 256 tokens. Para caracteres no ascii, se vuelve completamente ilegible, ¬°pero funciona!</td>
									<td><code><b>Hello my friend, how are you?</b></code> se divide en <code><b>Hello</b></code>, <code><b>ƒ†my</b></code>, <code><b>ƒ†friend</b></code>, <code><b>,</b></code>, <code><b>ƒ†how</b></code>, <code><b>ƒ†are</b></code>, <code><b>ƒ†you</b></code>, <code><b>?</b></code></td>
								</tr>
								<tr>
									<td>Whitespace</td>
									<td>Divide en l√≠mites de palabra usando la siguiente expresi√≥n regular: <code><b>\w+<a href="https://maximofn.com/regular-expressions/" target="_blank">^\w\s]+</b></code>. En mi post sobre [expresiones regulares</a> puedes entender qu√© hace</td>
									<td><code><b>Hello there!</b></code> se divide en <code><b>Hello</b></code>, <code><b>there</b></code>, <code><b>!</b></code></td>
								</tr>
								<tr>
									<td>WhitespaceSplit</td>
									<td>Se divide en cualquier car√°cter de espacio en blanco</td>
									<td><code><b>Hello there!</b></code> se divide en <code><b>Hello</b></code>, <code><b>there!</b></code></td>
								</tr>
								<tr>
									<td>Punctuation</td>
									<td>Aislar√° todos los caracteres de puntuaci√≥n</td>
									<td><code><b>Hello?</b></code> se divide en <code><b>Hello</b></code>, <code><b>?</b></code></td>
								</tr>
								<tr>
									<td>Metaspace</td>
									<td>Separa los espacios en blanco y los sustituye por un car√°cter especial "‚ñÅ" (U+2581)</td>
									<td><code><b>Hello there</b></code> se divide en <code><b>Hello</b></code>, <code><b>‚ñÅthere</b></code></td>
								</tr>
								<tr>
									<td>CharDelimiterSplit</td>
									<td>Divisiones en un car√°cter determinado</td>
									<td>Ejemplo con el caracter <code><b>x</b></code>: <code><b>Helloxthere</b></code> se divide en <code><b>Hello</b></code>, <code><b>there</b></code></td>
								</tr>
								<tr>
									<td>Digits</td>
									<td>Divide los n√∫meros de cualquier otro car√°cter</td>
									<td><code><b>Hello123there</b></code> se divide en <code><b>Hello</b></code>, <code><b>123</b></code>, <code><b>there</b></code></td>
								</tr>
								<tr>
									<td>Split</td>
									<td>Pretokenizador vers√°til que divide seg√∫n el patr√≥n y el comportamiento proporcionados. El patr√≥n se puede invertir si es necesario. El patr√≥n debe ser una cadena personalizada o una <a href="https://maximofn.com/regular-expressions/" target="_blank">regex</a>. El comportamiento debe ser <code><b>removed</b></code>, <code><b>isolated</b></code>, <code><b>merged_with_previous</b></code>, <code><b>merged_with_next</b></code>, <code><b>contiguous</b></code>. Para invertir se indica con un booleano</td>
									<td>Ejemplo con pattern=<code><b>" "</b></code>, behavior=<code><b>isolated</b></code>, invert=<code><b>False</b></code>: <code><b>Hello, how are you?</b></code> se divide en <code><b>Hello,</b></code>, <code><b> </b></code>, <code><b>how</b></code>, <code><b> </b></code>, <code><b>are</b></code>, <code><b> </b></code>, <code><b>you?</b></code></td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's create a pre tokenizer to see how it works.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pre_tokenizers</span></p>
<p></p>
<p><span style="color: #6b97e8;">pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">Digits</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">individual_digits</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;I paid $30 for the car&quot;</span></p>
<p><span style="color: #6b97e8;">pre_tokenized_text</span> <span>=</span> <span style="color: #6b97e8;">pre_tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenize_str</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">pre_tokenized_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>[('I paid $', (0, 8)),</p><p> ('3', (8, 9)),</p><p> ('0', (9, 10)),</p><p> (' for the car', (10, 22))]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To use several pre tokenizers we can use the <code><b>Sequence</b></code> method.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">custom_pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">Sequence</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">Whitespace</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">Digits</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">individual_digits</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)])</span></p>
<p></p>
<p><span style="color: #6b97e8;">pre_tokenized_text</span> <span>=</span> <span style="color: #6b97e8;">custom_pre_tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenize_str</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">pre_tokenized_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>[('I', (0, 1)),</p><p> ('paid', (2, 6)),</p><p> ('$', (7, 8)),</p><p> ('3', (8, 9)),</p><p> ('0', (9, 10)),</p><p> ('for', (11, 14)),</p><p> ('the', (15, 18)),</p><p> ('car', (19, 22))]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To modify the pre tokenizer of a tokenizer</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">custom_pre_tokenizer</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Tokenization">
								<a class="anchor-link" href="#Tokenization">
									<p style="margin-left: 20px">Tokenization</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Once the input texts have been normalized and pretokenized, the tokenizer applies the model to the pretokens. This is the part of the process that must be trained with the corpus (or has already been trained if a pre-trained tokenizer is used).</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The function of the model is to divide the "words" into tokens using the rules it has learned. It is also responsible for assigning those tokens to their corresponding IDs in the model's vocabulary.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The model has a vocabulary size, i.e., it has a finite number of tokens, so it has to decompose the words and assign them to one of those tokens.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">This model is passed when initializing the Tokenizer. Currently, the ü§ó Tokenizers library supports:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Modelo</th>
									<th>Descripci√≥n</th>
								</tr>
								<tr>
									<td>WordLevel</td>
									<td>Este es el algoritmo "cl√°sico" de tokenizaci√≥n. Te permite simplemente asignar palabras a IDs sin nada sofisticado. Tiene la ventaja de ser muy f√°cil de usar y entender, pero requiere vocabularios extremadamente grandes para una buena cobertura. El uso de este modelo requiere el uso de un PreTokenizer. Este modelo no realiza ninguna elecci√≥n directamente, simplemente asigna tokens de entrada a IDs.</td>
								</tr>
								<tr>
									<td>BPE (Byte Pair Encoding)</td>
									<td>Uno de los algoritmos de tokenizaci√≥n de subpalabras m√°s populares. El Byte-Pair-Encoding funciona empezando con caracteres y fusionando los que se ven juntos con m√°s frecuencia, creando as√≠ nuevos tokens. A continuaci√≥n, trabaja de forma iterativa para construir nuevos tokens a partir de los pares m√°s frecuentes que ve en un corpus. BPE es capaz de construir palabras que nunca ha visto utilizando m√∫ltiples subpalabras y, por tanto, requiere vocabularios m√°s peque√±os, con menos posibilidades de tener palabras <code><b>unk</b></code> (desconocidas).</td>
								</tr>
								<tr>
									<td>WordPiece</td>
									<td>Se trata de un algoritmo de tokenizaci√≥n de subpalabras bastante similar a BPE, utilizado principalmente por Google en modelos como BERT. Utiliza un algoritmo codicioso que intenta construir primero palabras largas, dividi√©ndolas en varios tokens cuando no existen palabras completas en el vocabulario. A diferencia de BPE, que parte de los caracteres y construye tokens lo m√°s grandes posible. Utiliza el famoso prefijo ## para identificar los tokens que forman parte de una palabra (es decir, que no empiezan una palabra).</td>
								</tr>
								<tr>
									<td>Unigram</td>
									<td>Unigram es tambi√©n un algoritmo de tokenizaci√≥n de subpalabras, y funciona tratando de identificar el mejor conjunto de tokens de subpalabras para maximizar la probabilidad de una frase dada. Se diferencia de BPE en que no es un algoritmo determinista basado en un conjunto de reglas aplicadas secuencialmente. En su lugar, Unigram podr√° calcular m√∫ltiples formas de tokenizar, eligiendo la m√°s probable.</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">When you create a tokenizer you have to pass it the model</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Tokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">models</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">Tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">models</span><span>.</span><span style="color: #6b97e8;">Unigram</span><span style="color: #e3e11d;">())</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's pass the normalizer and the pre tokenizer we have created to it</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">normalizer</span> <span>=</span> <span style="color: #6b97e8;">custom_normalizer</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">custom_pre_tokenizer</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now we have to train the model or load a pre-trained one. In this case we are going to train one with the corpus we have downloaded.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Model-training">
								<a class="anchor-link" href="#Model-training">
									<p style="margin-left: 30px">Model training</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To train the model we have several types of <code><b>Trainer</b></code>s</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Trainer</th>
									<th>Descripci√≥n</th>
								</tr>
								<tr>
									<td>WordLevelTrainer</td>
									<td>Entrena un tokenizador WordLevel</td>
								</tr>
								<tr>
									<td>BpeTrainer</td>
									<td>Entrena un tokenizador BPE</td>
								</tr>
								<tr>
									<td>WordPieceTrainer</td>
									<td>Entrena un tokenizador WordPiece</td>
								</tr>
								<tr>
									<td>UnigramTrainer</td>
									<td>Entrena un tokenizador Unigram</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Almost all trainers have the same parameters, which are:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>vocab_size: The size of the final vocabulary, including all tokens and the alphabet.</li>
									<li>show_progress: show or not progress bars during training</li>
									<li>special_tokens: A list of special tokens that the model should be aware of.</li>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Apart from these parameters, each trainer has its own parameters, to see them see the <a href="https://huggingface.co/docs/tokenizers/api/trainers" target="_blank">Trainers</a> documentation.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To train we have to create a <code><b>Trainer</b></code>, as the model we have created is a <code><b>Unigram</b></code> we will create a <code><b>UnigramTrainer</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.trainers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">trainers</span></p>
<p></p>
<p><span style="color: #6b97e8;">trainer</span> <span>=</span> <span style="color: #6b97e8;">trainers</span><span>.</span><span style="color: #6b97e8;">UnigramTrainer</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">vocab_size</span><span>=</span><span style="color: #7e7a38;">20000</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">initial_alphabet</span><span>=</span><span style="color: #6b97e8;">pre_tokenizers</span><span>.</span><span style="color: #6b97e8;">ByteLevel</span><span>.</span><span style="color: #6b97e8;">alphabet</span><span style="color: #e3e11d;">(),</span></p>
<p>    <span style="color: #6b97e8;">special_tokens</span><span>=</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;&lt;PAD&gt;&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;&lt;BOS&gt;&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;&lt;EOS&gt;&quot;</span><span style="color: #e3e11d;">],</span></p>
<p><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Once we have created the <code><b>Trainer</b></code> there are two ways to enter, through the <code><b>train</b></code> method, to which a list of files is passed, or through the <code><b>train_from_iterator</b></code> method to which an iterator is passed.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h5 id="Model-training-with-the-`train`-method">
								<a class="anchor-link" href="#Model-training-with-the-`train`-method">
									<p style="margin-left: 40px">Model training with the <code><b>train</b></code> method</p>
								</a>
							</h5>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">First we create a list of files with the corpus</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">files</span> <span>=</span> <span style="color: #e3e11d;">[</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;wikitext-103/wiki.</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">split</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">.tokens&quot;</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">split</span> <span style="color: #7f6e38;">in</span> <span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;test&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;valid&quot;</span><span style="color: #e3e11d;">]]</span></p>
<p><span style="color: #6b97e8;">files</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['wikitext-103/wiki.test.tokens',</p><p> 'wikitext-103/wiki.train.tokens',</p><p> 'wikitext-103/wiki.valid.tokens']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">And now we train the model</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">train</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">files</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">trainer</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h5 id="Model-training-with-`train_from_iterator`-method">
								<a class="anchor-link" href="#Model-training-with-`train_from_iterator`-method">
									<p style="margin-left: 40px">Model training with <code><b>train_from_iterator</b></code> method</p>
								</a>
							</h5>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">First we create a function that will return an iterator</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">iterator</span><span style="color: #e3e11d;">():</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">file</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">files</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #a04cc1;">with</span> <span style="color: #dfd84a;">open</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">file</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;r&quot;</span><span style="color: #e3e11d;">)</span> <span style="color: #a04cc1;">as</span> <span style="color: #6b97e8;">f</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">line</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">f</span><span style="color: #e3e11d;">:</span></p>
<p>                <span style="color: #a04cc1;">yield</span> <span style="color: #6b97e8;">line</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We now retrain the model</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">train_from_iterator</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">iterator</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">trainer</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h5 id="Training-the-model-with-the-`train_from_iterator`-method-from-a-Hugging-Face-dataset">
								<a class="anchor-link" href="#Training-the-model-with-the-`train_from_iterator`-method-from-a-Hugging-Face-dataset">
									<p style="margin-left: 40px">Training the model with the <code><b>train_from_iterator</b></code> method from a Hugging Face dataset</p>
								</a>
							</h5>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">If we had downloaded the Hugging Face dataset, we could have trained the model directly from the dataset.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">datasets</span></p>
<p></p>
<p><span style="color: #6b97e8;">dataset</span> <span>=</span> <span style="color: #6b97e8;">datasets</span><span>.</span><span style="color: #6b97e8;">load_dataset</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;wikitext&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;wikitext-103-raw-v1&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">split</span><span>=</span><span style="color: #7e7a34;">&quot;train+test+validation&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now we can create an iterator</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">batch_iterator</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_size</span><span>=</span><span style="color: #7e7a38;">1000</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">),</span> <span style="color: #6b97e8;">batch_size</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #a04cc1;">yield</span> <span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">i</span> <span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">i</span> <span>+</span> <span style="color: #6b97e8;">batch_size</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;text&quot;</span><span style="color: #e3e11d;">]</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We retrain the model</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">train_from_iterator</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_iterator</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">trainer</span><span>=</span><span style="color: #6b97e8;">trainer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">length</span><span>=</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">))</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Saving-the-model">
								<a class="anchor-link" href="#Saving-the-model">
									<p style="margin-left: 30px">Saving the model</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Once the model has been trained, it can be saved for future use. To save the model you must save it in a <code><b>json</b></code> file.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">save</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;wikitext-103-tokenizer.json&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Loading-the-pre-trained-model">
								<a class="anchor-link" href="#Loading-the-pre-trained-model">
									<p style="margin-left: 30px">Loading the pre-trained model</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We can load a pre-trained model from a <code><b>json</b></code> instead of having to train it.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">from_file</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;wikitext-103-tokenizer.json&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>&lt;tokenizers.Tokenizer at 0x7f1dd7784a30&gt;</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We can also load a pre-trained model available in the Hugging Face Hub.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #8d783e;">&#39;bert-base-uncased&#39;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>&lt;tokenizers.Tokenizer at 0x7f1d64a75e30&gt;</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Post-processing">
								<a class="anchor-link" href="#Post-processing">
									<p style="margin-left: 20px">Post processing</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We may want our tokenizer to automatically add special tokens, such as <code><b>[CLS]</b></code> or <code><b>[SEP]</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The following post processors are implemented in Hugging Face</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>PostProcesador</th>
									<th>Descripci√≥n</th>
									<th>Ejemplo</th>
								</tr>
								<tr>
									<td>BertProcessing</td>
									<td>Este post-procesador se encarga de a√±adir los tokens especiales que necesita un modelo Bert (<code><b>SEP</b></code> y <code><b>CLS</b></code>)</td>
									<td><code><b>Hello, how are you?</b></code> se convierte en <code><b>[CLS]</b></code>, <code><b>Hello</b></code>, <code><b>,</b></code>, <code><b>how</b></code>, <code><b>are</b></code>, <code><b>you</b></code>, <code><b>?</b></code>, <code><b>[SEP]</b></code></td>
								</tr>
								<tr>
									<td>RobertaProcessing</td>
									<td>Este post-procesador se encarga de a√±adir los tokens especiales que necesita un modelo Roberta (<code><b>SEP</b></code> y <code><b>CLS</b></code>). Tambi√©n se encarga de recortar los offsets. Por defecto, el ByteLevel BPE puede incluir espacios en blanco en los tokens producidos. Si no desea que las compensaciones incluyan estos espacios en blanco, hay que inicializar este PostProcessor con <code><b>trim_offsets=True</b></code>.</td>
									<td><code><b>Hello, how are you?</b></code> se convierte en <code><b><s></b></code>, <code><b>Hello</b></code>, <code><b>,</b></code>, <code><b>how</b></code>, <code><b>are</b></code>, <code><b>you</b></code>, <code><b>?</b></code>, <code><b></s></b></code></td>
								</tr>
								<tr>
									<td>ElectraProcessing</td>
									<td>A√±ade tokens especiales para ELECTRA</td>
									<td><code><b>Hello, how are you?</b></code> se convierte en <code><b>[CLS]</b></code>, <code><b>Hello</b></code>, <code><b>,</b></code>, <code><b>how</b></code>, <code><b>are</b></code>, <code><b>you</b></code>, <code><b>?</b></code>, <code><b>[SEP]</b></code></td>
								</tr>
								<tr>
									<td>TemplateProcessing</td>
									<td>Permite crear f√°cilmente una plantilla para el postprocesamiento, a√±adiendo tokens especiales y especificando el type_id de cada secuencia/token especial. La plantilla recibe dos cadenas que representan la secuencia √∫nica y el par de secuencias, as√≠ como un conjunto de tokens especiales a utilizar</td>
									<td>Example, when specifying a template with these values: single:<code><b>[CLS] $A [SEP]</b></code>, pair: <code><b>[CLS] $A [SEP] $B [SEP]</b></code>, special tokens: <code><b>[CLS]</b></code>, <code><b>[SEP]</b></code>. Input: (<code><b>I like this</b></code>, <code><b>but not this</b></code>), Output: <code><b>[CLS] I like this [SEP] but not this [SEP]</b></code></td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's create a post tokenizer to see how it works.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.processors</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">TemplateProcessing</span></p>
<p></p>
<p><span style="color: #6b97e8;">post_processor</span> <span>=</span> <span style="color: #6b97e8;">TemplateProcessing</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">single</span><span>=</span><span style="color: #7e7a34;">&quot;[CLS] $A [SEP]&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">pair</span><span>=</span><span style="color: #7e7a34;">&quot;[CLS] $A [SEP] $B:1 [SEP]:1&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">special_tokens</span><span>=</span><span style="color: #e3e11d;">[(</span><span style="color: #7e7a34;">&quot;[CLS]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">),</span> <span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;[SEP]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">)],</span></p>
<p><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">To modify the post tokenizer of a tokenizer</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">post_processor</span> <span>=</span> <span style="color: #6b97e8;">post_processor</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's see how it works</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;I paid $30 for the car&quot;</span></p>
<p><span style="color: #6b97e8;">decoded_text</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">decoded_text</span><span>.</span><span style="color: #6b97e8;">tokens</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'i', 'paid', '$', '3', '0', 'for', 'the', 'car', '[SEP]']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_text1</span> <span>=</span> <span style="color: #7e7a34;">&quot;Hello, y&#39;all!&quot;</span></p>
<p><span style="color: #6b97e8;">input_text2</span> <span>=</span> <span style="color: #7e7a34;">&quot;How are you?&quot;</span></p>
<p><span style="color: #6b97e8;">decoded_text</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text1</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">input_text2</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">decoded_text</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'hell', 'o', ',', 'y', "'", 'all', '!', '[SEP]', 'how', 'are', 'you', '?', '[SEP]']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">If we were to save the tokenizer now, the post tokenizer would be saved with it.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Encoding">
								<a class="anchor-link" href="#Encoding">
									<p style="margin-left: 20px">Encoding</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Once we have the tokenizer trained, we can use it to tokenize texts.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;I love tokenizers!&quot;</span></p>
<p><span style="color: #6b97e8;">encoded_text</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's see what we get when we tokenize text</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_text</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>tokenizers.Encoding</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We obtain an object of type <a href="https://huggingface.co/docs/tokenizers/api/encoding#tokenizers.Encoding" target="_blank">Encoding</a>, which contains the tokens and token ids</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The <code><b>ids</b></code> are the <code><b>id</b></code>s of the tokens in the tokenizer vocabulary.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">ids</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>[1, 17, 383, 10694, 17, 3533, 3, 586, 2]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The <code><b>tokens</b></code> are the tokens to which the <code><b>ids</b></code> are equivalent.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">tokens</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'i', 'love', 'token', 'i', 'zer', 's', '!', '[SEP]']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">If we have several sequences, we can code them all at the same time.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">encoded_texts</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text1</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">input_text2</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span>.</span><span style="color: #6b97e8;">type_ids</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'hell', 'o', ',', 'y', "'", 'all', '!', '[SEP]', 'how', 'are', 'you', '?', '[SEP]']</p><p>[1, 2215, 7, 5, 22, 26, 81, 586, 2, 98, 59, 213, 902, 2]</p><p>[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">However, when you have several sequences it is better to use the <code><b>encode_batch</b></code> method.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">encoded_texts</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">encode_batch</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">input_text1</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">input_text2</span><span style="color: #e3e11d;">])</span></p>
<p></p>
<p><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>list</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We see that we get a list</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>['[CLS]', 'hell', 'o', ',', 'y', "'", 'all', '!', '[SEP]']</p><p>[1, 2215, 7, 5, 22, 26, 81, 586, 2]</p><p>['[CLS]', 'how', 'are', 'you', '?', '[SEP]']</p><p>[1, 98, 59, 213, 902, 2]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Decoding">
								<a class="anchor-link" href="#Decoding">
									<p style="margin-left: 20px">Decoding</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">In addition to encoding input texts, a Tokenizer also has a method to decode, i.e. convert the IDs generated by its model back to a text. This is done by the methods <code><b>Tokenizer.decode</b></code> (for a predicted text) and <code><b>Tokenizer.decode_batch</b></code> (for a batch of predictions).</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The types of decoding that can be used are:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Decodificaci√≥n</th>
									<th>Descripci√≥n</th>
								</tr>
								<tr>
									<td>BPEDecoder</td>
									<td>Revierte el modelo BPE</td>
								</tr>
								<tr>
									<td>ByteLevel</td>
									<td>Revierte el ByteLevel PreTokenizer. Este PreTokenizer codifica a nivel de byte, utilizando un conjunto de caracteres Unicode visibles para representar cada byte, por lo que necesitamos un Decoder para revertir este proceso y obtener algo legible de nuevo.</td>
								</tr>
								<tr>
									<td>CTC</td>
									<td>Revierte el modelo CTC</td>
								</tr>
								<tr>
									<td>Metaspace</td>
									<td>Revierte el PreTokenizer de Metaspace. Este PreTokenizer utiliza un identificador especial ‚ñÅ para identificar los espacios en blanco, por lo que este Decoder ayuda con la decodificaci√≥n de estos.</td>
								</tr>
								<tr>
									<td>WordPiece</td>
									<td>Revierte el modelo WordPiece. Este modelo utiliza un identificador especial ## para las subpalabras continuas, por lo que este decodificador ayuda a decodificarlas.</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The decoder will first convert the IDs into tokens (using the tokenizer vocabulary) and remove all special tokens, then join those tokens with blanks.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's create a decoder</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">decoders</span></p>
<p></p>
<p><span style="color: #6b97e8;">decoder</span> <span>=</span> <span style="color: #6b97e8;">decoders</span><span>.</span><span style="color: #6b97e8;">ByteLevel</span><span style="color: #e3e11d;">()</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We add it to the tokenizer</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decoder</span> <span>=</span> <span style="color: #6b97e8;">decoder</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We decode</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">decoded_text</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">decoded_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>('I love tokenizers!', 'ilovetokenizers!')</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">decoded_texts</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode_batch</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">encoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">])</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text1</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">decoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">])</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text2</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">decoded_texts</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">])</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Hello, y'all! hello,y'all!</p><p>How are you? howareyou?</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="BERT-tokenizer">
								<a class="anchor-link" href="#BERT-tokenizer">
									<p style="margin-left: 10px">BERT tokenizer</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">With everything we have learned we are going to create the BERT tokenizer from scratch, first we create the tokenizer. Bert uses <code><b>WordPiece</b></code> as a model, so we pass it to the initializer of the tokenizer.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Tokenizer</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.models</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">WordPiece</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">Tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">WordPiece</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">unk_token</span><span>=</span><span style="color: #7e7a34;">&quot;[UNK]&quot;</span><span style="color: #e3e11d;">))</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">BERT preprocesses texts by removing accents and lowercase letters. We also use a unicode normalizer</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">normalizers</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.normalizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">NFD</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">Lowercase</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">StripAccents</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">normalizer</span> <span>=</span> <span style="color: #6b97e8;">normalizers</span><span>.</span><span style="color: #6b97e8;">Sequence</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">NFD</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">Lowercase</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">StripAccents</span><span style="color: #e3e11d;">()])</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The pretokenizer only splits whitespace and punctuation marks.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.pre_tokenizers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Whitespace</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">pre_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">Whitespace</span><span style="color: #e3e11d;">()</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">And the post-processing uses the template that we saw in the previous section</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.processors</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">TemplateProcessing</span></p>
<p></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">post_processor</span> <span>=</span> <span style="color: #6b97e8;">TemplateProcessing</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">single</span><span>=</span><span style="color: #7e7a34;">&quot;[CLS] $A [SEP]&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">pair</span><span>=</span><span style="color: #7e7a34;">&quot;[CLS] $A [SEP] $B:1 [SEP]:1&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">special_tokens</span><span>=</span><span style="color: #e3e11d;">[</span></p>
<p>        <span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;[CLS]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">),</span></p>
<p>        <span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;[SEP]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">),</span></p>
<p>    <span style="color: #e3e11d;">],</span></p>
<p><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We train the tokenizer with the dataset of wikitext-103</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">tokenizers.trainers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">WordPieceTrainer</span></p>
<p></p>
<p><span style="color: #6b97e8;">trainer</span> <span>=</span> <span style="color: #6b97e8;">WordPieceTrainer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">vocab_size</span><span>=</span><span style="color: #7e7a38;">30522</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">special_tokens</span><span>=</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;[UNK]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;[CLS]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;[SEP]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;[PAD]&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;[MASK]&quot;</span><span style="color: #e3e11d;">])</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">files</span> <span>=</span> <span style="color: #e3e11d;">[</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;wikitext-103/wiki.</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">split</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">.tokens&quot;</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">split</span> <span style="color: #7f6e38;">in</span> <span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;test&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;valid&quot;</span><span style="color: #e3e11d;">]]</span></p>
<p><span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">train</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">files</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">trainer</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now we test it</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_text</span> <span>=</span> <span style="color: #7e7a34;">&quot;I love tokenizers!&quot;</span></p>
<p></p>
<p><span style="color: #6b97e8;">encoded_text</span> <span>=</span> <span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">encode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_text</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">decoded_text</span> <span>=</span> <span style="color: #6b97e8;">bert_tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;El texto de entrada &#39;</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_text</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&#39; se convierte en los tokens </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">, que tienen las ids </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_text</span><span>.</span><span style="color: #6b97e8;">ids</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;"> y luego se decodifica como &#39;</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">decoded_text</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&#39;&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>El texto de entrada 'I love tokenizers!' se convierte en los tokens ['[CLS]', 'i', 'love', 'token', '##izers', '!', '[SEP]'], que tienen las ids [1, 51, 2867, 25791, 12213, 5, 2] y luego se decodifica como 'i love token ##izers !'</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	<!-- Close class contenido -->
	</div>
<!-- Close div notebook container -->
</div>
<!-- Close div notebook -->
</div>


