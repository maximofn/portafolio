<p>
	<!-- Custom stylesheet, it must be in the same directory as the html file -->
	<!-- Loading mathjax macro --><!-- Load mathjax --><!-- MathJax configuration -->
<p>
<style>
	/* Media query para pantallas grandes */
	@media screen and (min-width: 1000px) {
		.container {
			flex-wrap: nowrap;
			display: flex;
			justify-content: space-between;
			height: 100vh; /* altura del viewport */
		}
		
		.indice {
			width: 25%; /* Ancho del índice en pantallas grandes */
			border-right: 1px solid #ccc;
			max-height: calc(100vh - 40px); /* Ajustar según tus necesidades. Aquí estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
		
		.contenido {
			width: 70%; /* Ancho del contenido en pantallas grandes */
			max-height: calc(100vh - 40px); /* Ajustar según tus necesidades. Aquí estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
	}
</style>
<!-- Open div notebook -->
<div id="notebook" class="border-box-sizing" tabindex="-1">
	<!-- Open div notebook container -->
	<div id="notebook-container" class="container">
		<!-- Open div indice -->
		<div class="indice">
			<!-- Open div index header -->
			<div class="cell border-box-sizing text_cell rendered">
				<h2 class="prompt input_prompt">
					<span style="
					color: var(--darkreader-text--heading-color, var(--darkreader-text--heading-2-color,
					var(--darkreader-text--headings-color)));
					font-family: var(--fontFamily); font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-color: var(--darkreader-text--darkreader-text--heading-color,
					var(--darkreader-text--darkreader-text--heading-2-color, var(--darkreader-text--darkreader-text--headings-color)));
					--darkreader-inline-bgcolor: transparent;"
					data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">
						Índice
					</span>
					<a class="anchor-link" style="
					font-family: var(--fontFamily);
					font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-bgcolor: transparent;"
					href="#Índice" data-darkreader-inline-bgcolor="">
					</a>
				</h2>
			<!-- Close div index header -->
			</div>
			<!-- Index body -->
			<div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Inferência-com-`pipeline`.-index">
									<a class="anchor-link" href="#Inferência-com-`pipeline`.">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Inferência com <code><b>pipeline</b></code>.</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Tarefas-index">
									<a class="anchor-link" href="#Tarefas">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Tarefas</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Uso-de-`pipeline`-index">
									<a class="anchor-link" href="#Uso-de-`pipeline`">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Uso de <code><b>pipeline</b></code></p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Como-funciona-o-`pipeline-index">
									<a class="anchor-link" href="#Como-funciona-o-`pipeline">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Como funciona o `pipeline</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Inferência-com-`AutoClass`-e-`pipeline`.-index">
									<a class="anchor-link" href="#Inferência-com-`AutoClass`-e-`pipeline`.">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Inferência com <code><b>AutoClass</b></code> e <code><b>pipeline</b></code>.</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Tokenização-com-`AutoTokenizer`.-index">
									<a class="anchor-link" href="#Tokenização-com-`AutoTokenizer`.">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Tokenização com <code><b>AutoTokenizer</b></code>.</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Modelo-`AutoModel`.-index">
									<a class="anchor-link" href="#Modelo-`AutoModel`.">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Modelo <code><b>AutoModel</b></code>.</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Modelo-`AutoModelFor`.-index">
									<a class="anchor-link" href="#Modelo-`AutoModelFor`.">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Modelo <code><b>AutoModelFor</b></code>.</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Inferência-somente-com-`AutoClass`.-index">
									<a class="anchor-link" href="#Inferência-somente-com-`AutoClass`.">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Inferência somente com <code><b>AutoClass</b></code>.</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Geração-de-texto-casual-index">
									<a class="anchor-link" href="#Geração-de-texto-casual">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Geração de texto casual</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Classificação-do-texto-index">
									<a class="anchor-link" href="#Classificação-do-texto">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Classificação do texto</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Classificação-de-tokens-index">
									<a class="anchor-link" href="#Classificação-de-tokens">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Classificação de tokens</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Resposta-à-pergunta-index">
									<a class="anchor-link" href="#Resposta-à-pergunta">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Resposta à pergunta</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Modelagem-de-linguagem-com-máscara-(Modelagem-de-linguagem-com-máscara)-index">
									<a class="anchor-link" href="#Modelagem-de-linguagem-com-máscara-(Modelagem-de-linguagem-com-máscara)">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Modelagem de linguagem com máscara (Modelagem de linguagem com máscara)</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Personalização-do-modelo-index">
									<a class="anchor-link" href="#Personalização-do-modelo">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Personalização do modelo</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Tokenização-index">
									<a class="anchor-link" href="#Tokenização">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Tokenização</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Preenchimento-index">
									<a class="anchor-link" href="#Preenchimento">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Preenchimento</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Truncado-index">
									<a class="anchor-link" href="#Truncado">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Truncado</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Tensionadores-index">
									<a class="anchor-link" href="#Tensionadores">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Tensionadores</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Máscaras-index">
									<a class="anchor-link" href="#Máscaras">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Máscaras</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Tokenizadores-rápidos-index">
									<a class="anchor-link" href="#Tokenizadores-rápidos">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Tokenizadores rápidos</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Formas-de-geração-de-texto-index">
									<a class="anchor-link" href="#Formas-de-geração-de-texto">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Formas de geração de texto</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Busca-ambiciosa-index">
									<a class="anchor-link" href="#Busca-ambiciosa">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Busca ambiciosa</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Pesquisa-Contrastiva-index">
									<a class="anchor-link" href="#Pesquisa-Contrastiva">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Pesquisa Contrastiva</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Amostragem-multinomial-index">
									<a class="anchor-link" href="#Amostragem-multinomial">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Amostragem multinomial</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Pesquisa-de-feixe-index">
									<a class="anchor-link" href="#Pesquisa-de-feixe">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Pesquisa de feixe</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Amostragem-multinomial-de-busca-de-feixe-index">
									<a class="anchor-link" href="#Amostragem-multinomial-de-busca-de-feixe">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Amostragem multinomial de busca de feixe</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Penalidade-de-n-gramas-de-pesquisa-de-feixe-index">
									<a class="anchor-link" href="#Penalidade-de-n-gramas-de-pesquisa-de-feixe">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Penalidade de n-gramas de pesquisa de feixe</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Sequências-de-retorno-de-penalidade-de-pesquisa-de-feixe-de-n-gramas-index">
									<a class="anchor-link" href="#Sequências-de-retorno-de-penalidade-de-pesquisa-de-feixe-de-n-gramas">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Sequências de retorno de penalidade de pesquisa de feixe de n-gramas</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Decodificação-de-busca-de-feixe-diverso-index">
									<a class="anchor-link" href="#Decodificação-de-busca-de-feixe-diverso">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Decodificação de busca de feixe diverso</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Decodificação-especulativa-index">
									<a class="anchor-link" href="#Decodificação-especulativa">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Decodificação especulativa</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Controle-de-aleatoriedade-da-decodificação-especulativa-index">
									<a class="anchor-link" href="#Controle-de-aleatoriedade-da-decodificação-especulativa">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Controle de aleatoriedade da decodificação especulativa</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Amostragem-index">
									<a class="anchor-link" href="#Amostragem">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Amostragem</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Temperatura-de-amostragem-index">
									<a class="anchor-link" href="#Temperatura-de-amostragem">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Temperatura de amostragem</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Amostragem-top-k-index">
									<a class="anchor-link" href="#Amostragem-top-k">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Amostragem top-k</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Top-p-de-amostragem-(amostragem-de-núcleo)-index">
									<a class="anchor-link" href="#Top-p-de-amostragem-(amostragem-de-núcleo)">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Top-p de amostragem (amostragem de núcleo)</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Amostragem-top-k-e-top-p-index">
									<a class="anchor-link" href="#Amostragem-top-k-e-top-p">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Amostragem top-k e top-p</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Streaming-index">
									<a class="anchor-link" href="#Streaming">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Streaming</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Modelos-de-bate-papo-index">
									<a class="anchor-link" href="#Modelos-de-bate-papo">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Modelos de bate-papo</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Tokenização-de-contexto-index">
									<a class="anchor-link" href="#Tokenização-de-contexto">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Tokenização de contexto</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Adicionar-geração-de-prompts-index">
									<a class="anchor-link" href="#Adicionar-geração-de-prompts">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Adicionar geração de prompts</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Geração-de-texto-index">
									<a class="anchor-link" href="#Geração-de-texto">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Geração de texto</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Geração-de-texto-com-`pipeline`.-index">
									<a class="anchor-link" href="#Geração-de-texto-com-`pipeline`.">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Geração de texto com <code><b>pipeline</b></code>.</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Trem-index">
									<a class="anchor-link" href="#Trem">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Trem</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Conjunto-de-dados-index">
									<a class="anchor-link" href="#Conjunto-de-dados">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Conjunto de dados</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Tokenização-index">
									<a class="anchor-link" href="#Tokenização">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Tokenização</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Modelo-index">
									<a class="anchor-link" href="#Modelo">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Modelo</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Métricas-de-avaliação-index">
									<a class="anchor-link" href="#Métricas-de-avaliação">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Métricas de avaliação</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Treinador-index">
									<a class="anchor-link" href="#Treinador">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Treinador</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Testando-o-modelo-index">
									<a class="anchor-link" href="#Testando-o-modelo">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Testando o modelo</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Compartilhe-o-modelo-no-Hub-do-Rosto-de-Abraço-index">
									<a class="anchor-link" href="#Compartilhe-o-modelo-no-Hub-do-Rosto-de-Abraço">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Compartilhe o modelo no Hub do Rosto de Abraço</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Registro-em-log-index">
									<a class="anchor-link" href="#Registro-em-log">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Registro em log</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Para-cima-depois-de-treinado-index">
									<a class="anchor-link" href="#Para-cima-depois-de-treinado">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Para cima depois de treinado</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Levantar-durante-o-treinamento-index">
									<a class="anchor-link" href="#Levantar-durante-o-treinamento">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Levantar durante o treinamento</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Hub-como-repositório-git-index">
									<a class="anchor-link" href="#Hub-como-repositório-git">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Hub como repositório git</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
			</div>
		<!-- Close div indice -->
		</div>
 
		<!-- Content -->
		<div class="contenido">
		<div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;"><a href="https://colab.research.google.com/github/maximofn/portafolio/blob/main/posts/notebooks_translated/2024-04-15-Hugging-Face-transformers_PT.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h1 id="Transformadores-de-rostos-abraçados">
								<a class="anchor-link" href="#Transformadores-de-rostos-abraçados">
									<p style="margin-left: 0px">Transformadores de rostos abraçados</p>
								</a>
							</h1>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">A biblioteca <code><b>transformers</b></code> da Hugging Face é uma das bibliotecas mais populares para trabalhar com modelos de linguagem. Sua facilidade de uso democratizou o uso da arquitetura <code><b>Transformer</b></code> e tornou possível trabalhar com modelos de linguagem de última geração sem a necessidade de ter muito conhecimento na área.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Entre a biblioteca <code><b>transformers</b></code>, o hub de modelos e sua facilidade de uso, os espaços e a facilidade de implementação de demonstrações, além de novas bibliotecas como <code><b>datasets</b></code>, <code><b>accelerate</b></code>, <code><b>PEFT</b></code> e outras, eles tornaram a Hugging Face um dos participantes mais importantes no cenário de IA no momento. Eles se autodenominam "o GitHub da IA" e certamente o são.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Este caderno foi traduzido automaticamente para torná-lo acessível a mais pessoas, por favor me avise se você vir algum erro de digitação..</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">## Instalação</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para instalar transformadores, você pode fazer isso com o <code><b>pip</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 80px;"><code>pip install transformers<br></code></p>
						</div>
					</div>
				</div>
			</div>
	
	
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">ou com <code><b>conda</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 80px;"><code>conda install conda-forge::transformers<br></code></p>
						</div>
					</div>
				</div>
			</div>
	
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Além da biblioteca, você precisa ter um backend do PyTorch ou do TensorFlow instalado. Ou seja, você precisa ter o <code><b>torch</b></code> ou o <code><b>tensorflow</b></code> instalados para poder usar o <code><b>transformers</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Inferência-com-`pipeline`.">
								<a class="anchor-link" href="#Inferência-com-`pipeline`.">
									<p style="margin-left: 10px">Inferência com <code><b>pipeline</b></code>.</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Com os pipelines <code><b>transformers</b></code>, a inferência com modelos de linguagem pode ser feita de maneira muito simples. A vantagem disso é que o desenvolvimento é muito mais rápido e a criação de protótipos pode ser feita com muita facilidade. Isso também permite que pessoas que não têm muito conhecimento usem os modelos.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Com o <code><b>pipeline</b></code>, você pode fazer inferência em várias tarefas diferentes. Cada tarefa tem sua própria <code><b>pipeline</b></code> (NLP <code><b>pipeline</b></code>, visão <code><b>pipeline</b></code> etc.), mas você pode fazer uma abstração geral usando a classe <code><b>pipeline</b></code>, que se encarrega de selecionar a <code><b>pipeline</b></code> correta para a tarefa que você passar a ela.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Tarefas">
								<a class="anchor-link" href="#Tarefas">
									<p style="margin-left: 20px">Tarefas</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">No momento da redação desta postagem, as tarefas que podem ser realizadas com o <code><b>pipeline</b></code> são:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Áudio:</li>
									<ul><li>Classificação de áudio</li></ul>
									<ul><ul><li>Classificação de cenas acústicas: marque o áudio com um rótulo de cena ("escritório", "praia", "estádio")</li></ul></ul>
									<ul><ul><li>Detecção de eventos acústicos: marcar o áudio com uma etiqueta de evento sonoro ("buzina de carro", "canto de baleia", "quebra de vidro")</li></ul></ul>
									<ul><ul><li>Marcação: marcação de áudio contendo vários sons (canto de pássaros, identificação de oradores em uma reunião)</li></ul></ul>
									<ul><ul><li>Classificação musical: rotular a música com um rótulo de gênero ("metal", "hip-hop", "country")</li></ul></ul>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Reconhecimento automático de fala (ASR, reconhecimento de fala em áudio):</li>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Visão computacional</li>
									<ul><li>Classificação de imagens</li></ul>
									<ul><li>Detecção de objetos</li></ul>
									<ul><li>Segmentação de imagens</li></ul>
									<ul><li>Estimativa de profundidade</li></ul>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;"> Processamento de linguagem natural (NLP) * Processamento de linguagem natural (NLP)</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Classificação do texto</li>
									<ul><li>Análise de sentimento</li></ul>
									<ul><li>Classificação do conteúdo</li></ul>
									<li>Classificação dos tokens</li>
									<ul><li>Reconhecimento de entidades nomeadas (NER): marca um token de acordo com uma categoria de entidade, como organização, pessoa, local ou data.</li></ul>
									<ul><li>Marcação de parte do discurso (POS): marcação de um token de acordo com sua parte do discurso, como substantivo, verbo ou adjetivo. O POS é útil para ajudar os sistemas de tradução a entender como duas palavras idênticas são gramaticalmente diferentes (por exemplo, "cut" como substantivo versus "cut" como verbo).</li></ul>
									<li>Respostas às perguntas</li>
									<ul><li>Extrativo: dada uma pergunta e algum contexto, a resposta é um trecho de texto do contexto que o modelo deve extrair.</li></ul>
									<ul><li>Resumo: dada uma pergunta e algum contexto, a resposta é gerada a partir do contexto; essa abordagem é tratada pelo Text2TextGenerationPipeline em vez do QuestionAnsweringPipeline mostrado abaixo.</li></ul>
									<li>Resumir</li>
									<ul><li>Extrativo: identifica e extrai as frases mais importantes do texto original</li></ul>
									<ul><li>abstrativo: gera o resumo de destino (que pode incluir novas palavras não presentes no documento de entrada) a partir do texto original</li></ul>
									<li>Tradução</li>
									<li>Modelagem de linguagem</li>
									<ul><li>causal: o objetivo do modelo é prever o próximo token em uma sequência, e os tokens futuros são mascarados</li></ul>
									<ul><li>Mascarado: o objetivo do modelo é prever um token mascarado em um fluxo com acesso total aos tokens no fluxo.</li></ul>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Multimodal</li>
									<ul><li>Respostas a perguntas sobre documentos</li></ul>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Uso-de-`pipeline`">
								<a class="anchor-link" href="#Uso-de-`pipeline`">
									<p style="margin-left: 20px">Uso de <code><b>pipeline</b></code></p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">A maneira mais fácil de criar uma <code><b>pipeline</b></code> é simplesmente informar a tarefa que queremos que ela resolva usando o parâmetro <code><b>task</b></code>. E a biblioteca selecionará o melhor modelo para essa tarefa, fará o download e o armazenará em cache para uso futuro.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pipeline</span></p>
<p></p>
<p><span style="color: #6b97e8;">generator</span> <span>=</span> <span style="color: #6b97e8;">pipeline</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">task</span><span>=</span><span style="color: #7e7a34;">&quot;text-generation&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>No model was supplied, defaulted to openai-community/gpt2 and revision 6c0e608 (https://huggingface.co/openai-community/gpt2).</p><p>Using a pipeline without specifying a model name and revision in production is not recommended.</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">generator</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>[{'generated_text': 'Me encanta aprender de se résistance davant que hiens que préclase que ses encasas quécénces. Se présentants cet en un croyne et cela désirez'}]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Como você pode ver, o texto gerado está em francês, embora eu o tenha apresentado em espanhol, por isso é importante escolher o modelo correto. Se você observar a biblioteca, ela utilizou o modelo <code><b>openai-community/gpt2</b></code>, que é um modelo treinado principalmente em inglês, e quando coloquei o texto em espanhol, ele ficou confuso e gerou uma resposta em francês.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Usaremos um modelo treinado novamente em inglês usando o parâmetro <code><b>model</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pipeline</span></p>
<p></p>
<p><span style="color: #6b97e8;">generator</span> <span>=</span> <span style="color: #6b97e8;">pipeline</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">task</span><span>=</span><span style="color: #7e7a34;">&quot;text-generation&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">generator</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>[{'generated_text': 'Me encanta aprender de tus palabras, que con gran entusiasmo y con el mismo conocimiento como lo que tú acabas escribiendo, te deseo de todo corazón todo el deseo de este día:\nY aunque también haya personas a las que'}]</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">O texto gerado agora tem uma aparência muito melhor</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">A classe <code><b>pipeline</b></code> tem muitos parâmetros possíveis, portanto, para ver todos eles e saber mais sobre a classe, recomendo a leitura de sua [documentação] (https://huggingface.co/docs/transformers/v4.38.1/en/main_classes/pipelines), mas vamos falar sobre um deles, pois, para o aprendizado profundo, ele é muito importante e é o <code><b>device</b></code>. Ele define o dispositivo (por exemplo, <code><b>cpu</b></code>, <code><b>cuda:1</b></code>, <code><b>mps</b></code> ou um intervalo ordinal de GPUs como <code><b>1</b></code>) no qual a <code><b>pipeline</b></code> será mapeada.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">No meu caso, como tenho uma GPU, defini <code><b>0</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pipeline</span></p>
<p></p>
<p><span style="color: #6b97e8;">generator</span> <span>=</span> <span style="color: #6b97e8;">pipeline</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">task</span><span>=</span><span style="color: #7e7a34;">&quot;text-generation&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">generation</span> <span>=</span> <span style="color: #6b97e8;">generator</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">generation</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">][</span><span style="color: #8d783e;">&#39;generated_text&#39;</span><span style="color: #e3e11d;">])</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de ustedes, a tal punto que he decidido escribir algunos de nuestros contenidos en este blog, el cual ha sido de gran utilidad para mí por varias razones, una de ellas, el trabajo</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Como-funciona-o-`pipeline">
								<a class="anchor-link" href="#Como-funciona-o-`pipeline">
									<p style="margin-left: 20px">Como funciona o `pipeline</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Quando usamos <code><b>pipeline</b></code> por baixo, o que está acontecendo é o seguinte</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">transformers-pipeline](http://maximofn.com/wp-content/uploads/2024/02/transformers-pipeline.svg)</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">O texto é automaticamente tokenizado, passado pelo modelo e depois pós-processado.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Inferência-com-`AutoClass`-e-`pipeline`.">
								<a class="anchor-link" href="#Inferência-com-`AutoClass`-e-`pipeline`.">
									<p style="margin-left: 10px">Inferência com <code><b>AutoClass</b></code> e <code><b>pipeline</b></code>.</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vimos que o <code><b>pipeline</b></code> abstrai muito do que acontece, mas podemos selecionar qual tokenizador, qual modelo e qual pós-processamento queremos usar.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Tokenização-com-`AutoTokenizer`.">
								<a class="anchor-link" href="#Tokenização-com-`AutoTokenizer`.">
									<p style="margin-left: 20px">Tokenização com <code><b>AutoTokenizer</b></code>.</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Antes de usarmos o modelo <code><b>flax-community/gpt-2-spanish</b></code> para gerar texto, podemos usar seu tokenizador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoint</span> <span>=</span> <span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoint</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">text</span> <span>=</span> <span style="color: #7e7a34;">&quot;Me encanta lo que estoy aprendiendo&quot;</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">text</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'input_ids': tensor([[ 2879,  4835,   382,   288,  2383, 15257]]), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1]])}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Modelo-`AutoModel`.">
								<a class="anchor-link" href="#Modelo-`AutoModel`.">
									<p style="margin-left: 20px">Modelo <code><b>AutoModel</b></code>.</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Agora podemos criar o modelo e passar os tokens para ele.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoModel</span></p>
<p></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModel</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">output</span><span style="color: #e3e11d;">),</span> <span style="color: #6b97e8;">output</span><span>.</span><span style="color: #6b97e8;">keys</span><span style="color: #e3e11d;">()</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>(transformers.modeling_outputs.BaseModelOutputWithPastAndCrossAttentions,</p><p> odict_keys(['last_hidden_state', 'past_key_values']))</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Se agora tentarmos usá-lo em uma <code><b>pipeline</b></code>, receberemos um erro.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pipeline</span></p>
<p></p>
<p><span style="color: #6b97e8;">pipeline</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;text-generation&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span>=</span><span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">)(</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_text output_error">
								<pre style="margin-left: 60px; line-height: 0%;"><p><span style="color:red">---------------------------------------------------------------------------</span></p><p><span style="color:red">TypeError</span>                                 Traceback (most recent call last)</p><p>Cell <span style="color:green">In[23], line 3</span></p><p><span style="color:green"><b>      1</b></span> [38;5;28;01mfrom[39;00m [38;5;21;01mtransformers[39;00m [38;5;28;01mimport[39;00m pipeline</p><p><span style="color:green">----&gt; 3</span> pipeline([38;5;124m"[39m[38;5;124mtext-generation[39m[38;5;124m"[39m, model[38;5;241m=[39mmodel, tokenizer[38;5;241m=[39mtokenizer)([38;5;124m"[39m[38;5;124mMe encanta aprender de[39m[38;5;124m"[39m)</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/pipelines/text_generation.py:241</span>, in TextGenerationPipeline.__call__<span style="color:blue">(self, text_inputs, **kwargs)</span></p><p><span style="color:green"><b>    239</b></span>         [38;5;28;01mreturn[39;00m [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__call__[39m(chats, [38;5;241m*[39m[38;5;241m*[39mkwargs)</p><p><span style="color:green"><b>    240</b></span> [38;5;28;01melse[39;00m:</p><p><span style="color:green">--&gt; 241</span>     [38;5;28;01mreturn[39;00m [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__call__[39m(text_inputs, [38;5;241m*[39m[38;5;241m*[39mkwargs)</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/pipelines/base.py:1196</span>, in Pipeline.__call__<span style="color:blue">(self, inputs, num_workers, batch_size, *args, **kwargs)</span></p><p><span style="color:green"><b>   1188</b></span>     [38;5;28;01mreturn[39;00m [38;5;28mnext[39m(</p><p><span style="color:green"><b>   1189</b></span>         [38;5;28miter[39m(</p><p><span style="color:green"><b>   1190</b></span>             [38;5;28mself[39m[38;5;241m.[39mget_iterator(</p><p><span style="color:green">   (...)</span></p><p><span style="color:green"><b>   1193</b></span>         )</p><p><span style="color:green"><b>   1194</b></span>     )</p><p><span style="color:green"><b>   1195</b></span> [38;5;28;01melse[39;00m:</p><p><span style="color:green">-&gt; 1196</span>     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mrun_single(inputs, preprocess_params, forward_params, postprocess_params)</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/pipelines/base.py:1203</span>, in Pipeline.run_single<span style="color:blue">(self, inputs, preprocess_params, forward_params, postprocess_params)</span></p><p><span style="color:green"><b>   1201</b></span> [38;5;28;01mdef[39;00m [38;5;21mrun_single[39m([38;5;28mself[39m, inputs, preprocess_params, forward_params, postprocess_params):</p><p><span style="color:green"><b>   1202</b></span>     model_inputs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mpreprocess(inputs, [38;5;241m*[39m[38;5;241m*[39mpreprocess_params)</p><p><span style="color:green">-&gt; 1203</span>     model_outputs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mforward(model_inputs, [38;5;241m*[39m[38;5;241m*[39mforward_params)</p><p><span style="color:green"><b>   1204</b></span>     outputs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mpostprocess(model_outputs, [38;5;241m*[39m[38;5;241m*[39mpostprocess_params)</p><p><span style="color:green"><b>   1205</b></span>     [38;5;28;01mreturn[39;00m outputs</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/pipelines/base.py:1102</span>, in Pipeline.forward<span style="color:blue">(self, model_inputs, **forward_params)</span></p><p><span style="color:green"><b>   1100</b></span>     [38;5;28;01mwith[39;00m inference_context():</p><p><span style="color:green"><b>   1101</b></span>         model_inputs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_ensure_tensor_on_device(model_inputs, device[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mdevice)</p><p><span style="color:green">-&gt; 1102</span>         model_outputs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_forward(model_inputs, [38;5;241m*[39m[38;5;241m*[39mforward_params)</p><p><span style="color:green"><b>   1103</b></span>         model_outputs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_ensure_tensor_on_device(model_outputs, device[38;5;241m=[39mtorch[38;5;241m.[39mdevice([38;5;124m"[39m[38;5;124mcpu[39m[38;5;124m"[39m))</p><p><span style="color:green"><b>   1104</b></span> [38;5;28;01melse[39;00m:</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/pipelines/text_generation.py:328</span>, in TextGenerationPipeline._forward<span style="color:blue">(self, model_inputs, **generate_kwargs)</span></p><p><span style="color:green"><b>    325</b></span>         generate_kwargs[[38;5;124m"[39m[38;5;124mmin_length[39m[38;5;124m"[39m] [38;5;241m+[39m[38;5;241m=[39m prefix_length</p><p><span style="color:green"><b>    327</b></span> [38;5;66;03m# BS x SL[39;00m</p><p><span style="color:green">--&gt; 328</span> generated_sequence [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mmodel[38;5;241m.[39mgenerate(input_ids[38;5;241m=[39minput_ids, attention_mask[38;5;241m=[39mattention_mask, [38;5;241m*[39m[38;5;241m*[39mgenerate_kwargs)</p><p><span style="color:green"><b>    329</b></span> out_b [38;5;241m=[39m generated_sequence[38;5;241m.[39mshape[[38;5;241m0[39m]</p><p><span style="color:green"><b>    330</b></span> [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mframework [38;5;241m==[39m [38;5;124m"[39m[38;5;124mpt[39m[38;5;124m"[39m:</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/torch/utils/_contextlib.py:115</span>, in context_decorator.&lt;locals&gt;.decorate_context<span style="color:blue">(*args, **kwargs)</span></p><p><span style="color:green"><b>    112</b></span> [38;5;129m@functools[39m[38;5;241m.[39mwraps(func)</p><p><span style="color:green"><b>    113</b></span> [38;5;28;01mdef[39;00m [38;5;21mdecorate_context[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):</p><p><span style="color:green"><b>    114</b></span>     [38;5;28;01mwith[39;00m ctx_factory():</p><p><span style="color:green">--&gt; 115</span>         [38;5;28;01mreturn[39;00m func([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/generation/utils.py:1323</span>, in GenerationMixin.generate<span style="color:blue">(self, inputs, generation_config, logits_processor, stopping_criteria, prefix_allowed_tokens_fn, synced_gpus, assistant_model, streamer, negative_prompt_ids, negative_prompt_attention_mask, **kwargs)</span></p><p><span style="color:green"><b>   1320</b></span>         synced_gpus [38;5;241m=[39m [38;5;28;01mFalse[39;00m</p><p><span style="color:green"><b>   1322</b></span> [38;5;66;03m# 1. Handle `generation_config` and kwargs that might update it, and validate the `.generate()` call[39;00m</p><p><span style="color:green">-&gt; 1323</span> [38;5;28mself[39m[38;5;241m.[39m_validate_model_class()</p><p><span style="color:green"><b>   1325</b></span> [38;5;66;03m# priority: `generation_config` argument &gt; `model.generation_config` (the default generation config)[39;00m</p><p><span style="color:green"><b>   1326</b></span> [38;5;28;01mif[39;00m generation_config [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:</p><p><span style="color:green"><b>   1327</b></span>     [38;5;66;03m# legacy: users may modify the model configuration to control generation. To trigger this legacy behavior,[39;00m</p><p><span style="color:green"><b>   1328</b></span>     [38;5;66;03m# three conditions must be met[39;00m</p><p><span style="color:green"><b>   1329</b></span>     [38;5;66;03m# 1) the generation config must have been created from the model config (`_from_model_config` field);[39;00m</p><p><span style="color:green"><b>   1330</b></span>     [38;5;66;03m# 2) the generation config must have seen no modification since its creation (the hash is the same);[39;00m</p><p><span style="color:green"><b>   1331</b></span>     [38;5;66;03m# 3) the user must have set generation parameters in the model config.[39;00m</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/generation/utils.py:1110</span>, in GenerationMixin._validate_model_class<span style="color:blue">(self)</span></p><p><span style="color:green"><b>   1108</b></span> [38;5;28;01mif[39;00m generate_compatible_classes:</p><p><span style="color:green"><b>   1109</b></span>     exception_message [38;5;241m+[39m[38;5;241m=[39m [38;5;124mf[39m[38;5;124m"[39m[38;5;124m Please use one of the following classes instead: [39m[38;5;132;01m{[39;00mgenerate_compatible_classes[38;5;132;01m}[39;00m[38;5;124m"[39m</p><p><span style="color:green">-&gt; 1110</span> [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m(exception_message)</p><p></p><p><span style="color:red">TypeError</span>: The current model class (GPT2Model) is not compatible with `.generate()`, as it doesn't have a language model head. Please use one of the following classes instead: {'GPT2LMHeadModel'}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Isso se deve ao fato de que, quando funcionava, usávamos</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 80px;"><code>pipeline(task="text-generation", model="flax-community/gpt-2-spanish")<br></code></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Mas agora nós fizemos</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 80px;"><code>tokenizer = AutoTokenizer.from_pretrained("flax-community/gpt-2-spanish")<br>model = AutoModel.from_pretrained("flax-community/gpt-2-spanish")<br>pipeline("text-generation", model=model, tokenizer=tokenizer)<br></code></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">No primeiro caso, usamos apenas <code><b>pipeline</b></code> e o nome do modelo e, abaixo dele, estávamos procurando a melhor maneira de implementar o modelo e o tokenizador. Mas, no segundo caso, criamos o tokenizador e o modelo e o passamos para <code><b>pipeline</b></code>, mas não o criamos de acordo com as necessidades de <code><b>pipeline</b></code>.</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Para corrigir isso, usamos o <code><b>AutoModelFor</b></code>.</p>
					</div>
				</div>
			</div>
		</div>
		<!-- Open div header -->
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<h3 id="Modelo-`AutoModelFor`.">
							<a class="anchor-link" href="#Modelo-`AutoModelFor`.">
								<p style="margin-left: 20px">Modelo <code><b>AutoModelFor</b></code>.</p>
							</a>
						</h3>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">A biblioteca de transformadores nos dá a oportunidade de criar um modelo para uma determinada tarefa, como</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;"></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">
							<ul>
								<li><code><b>AutoModelForCausalLM</b></code>, que é usado para continuar os textos</li>
								<li>AutoModelForMaskedLM` usado para preencher lacunas</li>
								<li><code><b>AutoModelForMaskGeneration</b></code>, que é usado para gerar máscaras</li>
								<li>AutoModelForSeq2SeqLM, que é usado para converter de sequências em sequências, por exemplo, na tradução.</li>
								<li><code><b>AutoModelForSequenceClassification</b></code> para classificação de texto</li>
								<li>AutoModelForMultipleChoice` para múltipla escolha</li>
								<li><code><b>AutoModelForNextSentencePrediction</b></code> para prever se duas frases são consecutivas</li>
								<li><code><b>AutoModelForTokenClassification</b></code> para classificação de tokens</li>
								<li>AutoModelForQuestionAnswering` para perguntas e respostas</li>
								<li><code><b>AutoModelForTextEncoding</b></code> para codificação de texto</li>
							</ul>
						</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">

					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Vamos usar o modelo acima para gerar texto</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing code_cell rendered">
			<div class="input">
				<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
				<div class="inner_cell">
					<div class="input_area">
						<div class=" highlight hl-python3">
							<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pipeline</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">pipeline</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;text-generation&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span>=</span><span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">)(</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">)[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">][</span><span style="color: #8d783e;">&#39;generated_text&#39;</span><span style="color: #e3e11d;">]</span></p>
							</pre>
						</div>
					</div>
				</div>
			</div>
			<div class="output_wrapper">
				<div class="output">
					<div class="output_area">
						<div class="prompt" style="margin-left: 20px;">Output:</div>
						<div class="output_subarea output_stream output_stdout output_text">
							<pre style="margin-left: 60px; line-height: 0%;"><p>'Me encanta aprender de mi familia.\nLa verdad no sabía que se necesitaba tanto en este pequeño restaurante ya que mi novio en un principio había ido, pero hoy me ha entrado un gusanillo entre pecho y espalda que'</p></pre>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Agora funciona, porque criamos o modelo de uma forma que o <code><b>pipeline</b></code> pode entender.</p>
					</div>
				</div>
			</div>
		</div>
		<!-- Open div header -->
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<h2 id="Inferência-somente-com-`AutoClass`.">
							<a class="anchor-link" href="#Inferência-somente-com-`AutoClass`.">
								<p style="margin-left: 10px">Inferência somente com <code><b>AutoClass</b></code>.</p>
							</a>
						</h2>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Anteriormente, criamos o modelo e o tokenizador e o fornecemos ao <code><b>pipeline</b></code> para fazer o necessário, mas podemos usar os métodos de inferência por conta própria.</p>
					</div>
				</div>
			</div>
		</div>
		<!-- Open div header -->
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<h3 id="Geração-de-texto-casual">
							<a class="anchor-link" href="#Geração-de-texto-casual">
								<p style="margin-left: 20px">Geração de texto casual</p>
							</a>
						</h3>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Criamos o modelo e o tokenizador</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing code_cell rendered">
			<div class="input">
				<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
				<div class="inner_cell">
					<div class="input_area">
						<div class=" highlight hl-python3">
							<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
							</pre>
						</div>
					</div>
				</div>
			</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Com <code><b>device_map</b></code>, carregamos o modelo na GPU 0.</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Agora temos que fazer o que o <code><b>pipeline</b></code> costumava fazer.</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing text_cell rendered">
			<div class="prompt input_prompt">
				<div class="inner_cell">
					<div class="text_cell_render border-box-sizing rendered_html">
						<p style="margin-left: 0px;">Primeiro, geramos os tokens</p>
					</div>
				</div>
			</div>
		</div>
		<div class="cell border-box-sizing code_cell rendered">
			<div class="input">
				<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
				<div class="inner_cell">
					<div class="input_area">
						<div class=" highlight hl-python3">
							<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
							</pre>
						</div>
					</div>
				</div>
			</div>
			<div class="output_wrapper">
				<div class="output">
					<div class="output_area">
						<div class="prompt" style="margin-left: 20px;">Output:</div>
						<div class="output_subarea output_text output_error">
							<pre style="margin-left: 60px; line-height: 0%;"><p><span style="color:red">---------------------------------------------------------------------------</span></p><p><span style="color:red">ValueError</span>                                Traceback (most recent call last)</p><p>Cell <span style="color:green">In[2], line 1</span></p><p><span style="color:green">----&gt; 1</span> tokens_input [38;5;241m=[39m tokenizer([[38;5;124m"[39m[38;5;124mMe encanta aprender de[39m[38;5;124m"[39m], return_tensors[38;5;241m=[39m[38;5;124m"[39m[38;5;124mpt[39m[38;5;124m"[39m, padding[38;5;241m=[39m[38;5;28;01mTrue[39;00m)[38;5;241m.[39mto([38;5;124m"[39m[38;5;124mcuda[39m[38;5;124m"[39m)</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2829</span>, in PreTrainedTokenizerBase.__call__<span style="color:blue">(self, text, text_pair, text_target, text_pair_target, add_special_tokens, padding, truncation, max_length, stride, is_split_into_words, pad_to_multiple_of, return_tensors, return_token_type_ids, return_attention_mask, return_overflowing_tokens, return_special_tokens_mask, return_offsets_mapping, return_length, verbose, **kwargs)</span></p><p><span style="color:green"><b>   2827</b></span>     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39m_in_target_context_manager:</p><p><span style="color:green"><b>   2828</b></span>         [38;5;28mself[39m[38;5;241m.[39m_switch_to_input_mode()</p><p><span style="color:green">-&gt; 2829</span>     encodings [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_call_one(text[38;5;241m=[39mtext, text_pair[38;5;241m=[39mtext_pair, [38;5;241m*[39m[38;5;241m*[39mall_kwargs)</p><p><span style="color:green"><b>   2830</b></span> [38;5;28;01mif[39;00m text_target [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:</p><p><span style="color:green"><b>   2831</b></span>     [38;5;28mself[39m[38;5;241m.[39m_switch_to_target_mode()</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2915</span>, in PreTrainedTokenizerBase._call_one<span style="color:blue">(self, text, text_pair, add_special_tokens, padding, truncation, max_length, stride, is_split_into_words, pad_to_multiple_of, return_tensors, return_token_type_ids, return_attention_mask, return_overflowing_tokens, return_special_tokens_mask, return_offsets_mapping, return_length, verbose, **kwargs)</span></p><p><span style="color:green"><b>   2910</b></span>         [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(</p><p><span style="color:green"><b>   2911</b></span>             [38;5;124mf[39m[38;5;124m"[39m[38;5;124mbatch length of `text`: [39m[38;5;132;01m{[39;00m[38;5;28mlen[39m(text)[38;5;132;01m}[39;00m[38;5;124m does not match batch length of `text_pair`:[39m[38;5;124m"[39m</p><p><span style="color:green"><b>   2912</b></span>             [38;5;124mf[39m[38;5;124m"[39m[38;5;124m [39m[38;5;132;01m{[39;00m[38;5;28mlen[39m(text_pair)[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;124m"[39m</p><p><span style="color:green"><b>   2913</b></span>         )</p><p><span style="color:green"><b>   2914</b></span>     batch_text_or_text_pairs [38;5;241m=[39m [38;5;28mlist[39m([38;5;28mzip[39m(text, text_pair)) [38;5;28;01mif[39;00m text_pair [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m text</p><p><span style="color:green">-&gt; 2915</span>     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mbatch_encode_plus(</p><p><span style="color:green"><b>   2916</b></span>         batch_text_or_text_pairs[38;5;241m=[39mbatch_text_or_text_pairs,</p><p><span style="color:green"><b>   2917</b></span>         add_special_tokens[38;5;241m=[39madd_special_tokens,</p><p><span style="color:green"><b>   2918</b></span>         padding[38;5;241m=[39mpadding,</p><p><span style="color:green"><b>   2919</b></span>         truncation[38;5;241m=[39mtruncation,</p><p><span style="color:green"><b>   2920</b></span>         max_length[38;5;241m=[39mmax_length,</p><p><span style="color:green"><b>   2921</b></span>         stride[38;5;241m=[39mstride,</p><p><span style="color:green"><b>   2922</b></span>         is_split_into_words[38;5;241m=[39mis_split_into_words,</p><p><span style="color:green"><b>   2923</b></span>         pad_to_multiple_of[38;5;241m=[39mpad_to_multiple_of,</p><p><span style="color:green"><b>   2924</b></span>         return_tensors[38;5;241m=[39mreturn_tensors,</p><p><span style="color:green"><b>   2925</b></span>         return_token_type_ids[38;5;241m=[39mreturn_token_type_ids,</p><p><span style="color:green"><b>   2926</b></span>         return_attention_mask[38;5;241m=[39mreturn_attention_mask,</p><p><span style="color:green"><b>   2927</b></span>         return_overflowing_tokens[38;5;241m=[39mreturn_overflowing_tokens,</p><p><span style="color:green"><b>   2928</b></span>         return_special_tokens_mask[38;5;241m=[39mreturn_special_tokens_mask,</p><p><span style="color:green"><b>   2929</b></span>         return_offsets_mapping[38;5;241m=[39mreturn_offsets_mapping,</p><p><span style="color:green"><b>   2930</b></span>         return_length[38;5;241m=[39mreturn_length,</p><p><span style="color:green"><b>   2931</b></span>         verbose[38;5;241m=[39mverbose,</p><p><span style="color:green"><b>   2932</b></span>         [38;5;241m*[39m[38;5;241m*[39mkwargs,</p><p><span style="color:green"><b>   2933</b></span>     )</p><p><span style="color:green"><b>   2934</b></span> [38;5;28;01melse[39;00m:</p><p><span style="color:green"><b>   2935</b></span>     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mencode_plus(</p><p><span style="color:green"><b>   2936</b></span>         text[38;5;241m=[39mtext,</p><p><span style="color:green"><b>   2937</b></span>         text_pair[38;5;241m=[39mtext_pair,</p><p><span style="color:green">   (...)</span></p><p><span style="color:green"><b>   2953</b></span>         [38;5;241m*[39m[38;5;241m*[39mkwargs,</p><p><span style="color:green"><b>   2954</b></span>     )</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:3097</span>, in PreTrainedTokenizerBase.batch_encode_plus<span style="color:blue">(self, batch_text_or_text_pairs, add_special_tokens, padding, truncation, max_length, stride, is_split_into_words, pad_to_multiple_of, return_tensors, return_token_type_ids, return_attention_mask, return_overflowing_tokens, return_special_tokens_mask, return_offsets_mapping, return_length, verbose, **kwargs)</span></p><p><span style="color:green"><b>   3080</b></span> [38;5;250m[39m[38;5;124;03m"""[39;00m</p><p><span style="color:green"><b>   3081</b></span> [38;5;124;03mTokenize and prepare for the model a list of sequences or a list of pairs of sequences.[39;00m</p><p><span style="color:green"><b>   3082</b></span> </p><p><span style="color:green">   (...)</span></p><p><span style="color:green"><b>   3093</b></span> [38;5;124;03m        details in `encode_plus`).[39;00m</p><p><span style="color:green"><b>   3094</b></span> [38;5;124;03m"""[39;00m</p><p><span style="color:green"><b>   3096</b></span> [38;5;66;03m# Backward compatibility for 'truncation_strategy', 'pad_to_max_length'[39;00m</p><p><span style="color:green">-&gt; 3097</span> padding_strategy, truncation_strategy, max_length, kwargs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_get_padding_truncation_strategies(</p><p><span style="color:green"><b>   3098</b></span>     padding[38;5;241m=[39mpadding,</p><p><span style="color:green"><b>   3099</b></span>     truncation[38;5;241m=[39mtruncation,</p><p><span style="color:green"><b>   3100</b></span>     max_length[38;5;241m=[39mmax_length,</p><p><span style="color:green"><b>   3101</b></span>     pad_to_multiple_of[38;5;241m=[39mpad_to_multiple_of,</p><p><span style="color:green"><b>   3102</b></span>     verbose[38;5;241m=[39mverbose,</p><p><span style="color:green"><b>   3103</b></span>     [38;5;241m*[39m[38;5;241m*[39mkwargs,</p><p><span style="color:green"><b>   3104</b></span> )</p><p><span style="color:green"><b>   3106</b></span> [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_batch_encode_plus(</p><p><span style="color:green"><b>   3107</b></span>     batch_text_or_text_pairs[38;5;241m=[39mbatch_text_or_text_pairs,</p><p><span style="color:green"><b>   3108</b></span>     add_special_tokens[38;5;241m=[39madd_special_tokens,</p><p><span style="color:green">   (...)</span></p><p><span style="color:green"><b>   3123</b></span>     [38;5;241m*[39m[38;5;241m*[39mkwargs,</p><p><span style="color:green"><b>   3124</b></span> )</p><p></p><p>File <span style="color:green">~/miniconda3/envs/nlp/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2734</span>, in PreTrainedTokenizerBase._get_padding_truncation_strategies<span style="color:blue">(self, padding, truncation, max_length, pad_to_multiple_of, verbose, **kwargs)</span></p><p><span style="color:green"><b>   2732</b></span> [38;5;66;03m# Test if we have a padding token[39;00m</p><p><span style="color:green"><b>   2733</b></span> [38;5;28;01mif[39;00m padding_strategy [38;5;241m!=[39m PaddingStrategy[38;5;241m.[39mDO_NOT_PAD [38;5;129;01mand[39;00m ([38;5;28mself[39m[38;5;241m.[39mpad_token [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39mpad_token_id [38;5;241m&lt;[39m [38;5;241m0[39m):</p><p><span style="color:green">-&gt; 2734</span>     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(</p><p><span style="color:green"><b>   2735</b></span>         [38;5;124m"[39m[38;5;124mAsking to pad but the tokenizer does not have a padding token. [39m[38;5;124m"[39m</p><p><span style="color:green"><b>   2736</b></span>         [38;5;124m"[39m[38;5;124mPlease select a token to use as `pad_token` `(tokenizer.pad_token = tokenizer.eos_token e.g.)` [39m[38;5;124m"[39m</p><p><span style="color:green"><b>   2737</b></span>         [38;5;124m"[39m[38;5;124mor add a new pad token via `tokenizer.add_special_tokens([39m[38;5;124m{[39m[38;5;124m'[39m[38;5;124mpad_token[39m[38;5;124m'[39m[38;5;124m: [39m[38;5;124m'[39m[38;5;124m[PAD][39m[38;5;124m'[39m[38;5;124m})`.[39m[38;5;124m"[39m</p><p><span style="color:green"><b>   2738</b></span>     )</p><p><span style="color:green"><b>   2740</b></span> [38;5;66;03m# Check that we will truncate to a multiple of pad_to_multiple_of if both are provided[39;00m</p><p><span style="color:green"><b>   2741</b></span> [38;5;28;01mif[39;00m (</p><p><span style="color:green"><b>   2742</b></span>     truncation_strategy [38;5;241m!=[39m TruncationStrategy[38;5;241m.[39mDO_NOT_TRUNCATE</p><p><span style="color:green"><b>   2743</b></span>     [38;5;129;01mand[39;00m padding_strategy [38;5;241m!=[39m PaddingStrategy[38;5;241m.[39mDO_NOT_PAD</p><p><span style="color:green">   (...)</span></p><p><span style="color:green"><b>   2746</b></span>     [38;5;129;01mand[39;00m (max_length [38;5;241m%[39m pad_to_multiple_of [38;5;241m!=[39m [38;5;241m0[39m)</p><p><span style="color:green"><b>   2747</b></span> ):</p><p></p><p><span style="color:red">ValueError</span>: Asking to pad but the tokenizer does not have a padding token. Please select a token to use as `pad_token` `(tokenizer.pad_token = tokenizer.eos_token e.g.)` or add a new pad token via `tokenizer.add_special_tokens({'pad_token': '[PAD]'})`.</p></pre>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vemos que ele nos deu um erro, informando que o tokenizador não tem um token de preenchimento. A maioria dos LLMs não tem um token de preenchimento, mas para usar a biblioteca <code><b>transformers</b></code> você precisa de um token de preenchimento, então o que você normalmente faz é atribuir o token de fim de frase ao token de preenchimento.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora podemos gerar os tokens</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_input</span><span>.</span><span style="color: #6b97e8;">input_ids</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>tensor([[2879, 4835, 3760,  225,   72,   73]], device='cuda:0')</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora, nós os passamos para o modelo que gerará novos tokens e, para isso, usamos o método <code><b>generate</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_length</span><span>=</span><span style="color: #7e7a38;">50</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokens_input</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;output tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>input tokens: tensor([[2879, 4835, 3760,  225,   72,   73]], device='cuda:0')</p><p>output tokens: tensor([[ 2879,  4835,  3760,   225,    72,    73,   314,  2533,    16,   287,</p><p>           225,    73,    82,   513,  1086,   225,    72,    73,   314,   288,</p><p>           357, 15550,    16,   287,   225,    73,    87,   288,   225,    73,</p><p>            82,   291,  3500,    16,   225,    73,    87,   348,   929,   225,</p><p>            72,    73,  3760,   225,    72,    73,   314,  2533,    18,   203]],</p><p>       device='cuda:0')</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Podemos ver que os primeiros tokens <code><b>token_inputs</b></code> são iguais aos tokens <code><b>token_outputs</b></code>; os tokens a seguir são os gerados pelo modelo</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora temos que converter esses tokens em uma frase usando o decodificador do tokenizador.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>'Me encanta aprender de los demás, y en este caso de los que me rodean, y es que en el fondo, es una forma de aprender de los demás.\n'</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Já temos o texto gerado</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Classificação-do-texto">
						<a class="anchor-link" href="#Classificação-do-texto">
							<p style="margin-left: 20px">Classificação do texto</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Criamos o modelo e o tokenizador</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForSequenceClassification</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;stevhliu/my_awesome_model&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForSequenceClassification</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;stevhliu/my_awesome_model&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Geramos os tokens</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">text</span> <span>=</span> <span style="color: #7e7a34;">&quot;This was a masterpiece. Not completely faithful to the books, but enthralling from beginning to end. Might be my favorite of the three.&quot;</span></p>
<p><span style="color: #6b97e8;">inputs</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">text</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando tivermos os tokens, classificaremos</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">with</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">no_grad</span><span style="color: #e3e11d;">():</span></p>
<p>    <span style="color: #6b97e8;">logits</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">inputs</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">logits</span></p>
<p></p>
<p><span style="color: #6b97e8;">predicted_class_id</span> <span>=</span> <span style="color: #6b97e8;">logits</span><span>.</span><span style="color: #6b97e8;">argmax</span><span style="color: #e3e11d;">()</span><span>.</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">()</span></p>
<p><span style="color: #6b97e8;">prediction</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">config</span><span>.</span><span style="color: #6b97e8;">id2label</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">predicted_class_id</span><span style="color: #e3e11d;">]</span></p>
<p><span style="color: #6b97e8;">prediction</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>'LABEL_1'</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos dar uma olhada nas classes</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">clases</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">config</span><span>.</span><span style="color: #6b97e8;">id2label</span></p>
<p><span style="color: #6b97e8;">clases</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{0: 'LABEL_0', 1: 'LABEL_1'}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Dessa forma, ninguém pode descobrir, então nós o modificamos.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">config</span><span>.</span><span style="color: #6b97e8;">id2label</span> <span>=</span> <span style="color: #e3e11d;">{</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;NEGATIVE&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;POSITIVE&quot;</span><span style="color: #e3e11d;">}</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">E agora estamos de volta à classificação</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">with</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">no_grad</span><span style="color: #e3e11d;">():</span></p>
<p>    <span style="color: #6b97e8;">logits</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">inputs</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">logits</span></p>
<p></p>
<p><span style="color: #6b97e8;">predicted_class_id</span> <span>=</span> <span style="color: #6b97e8;">logits</span><span>.</span><span style="color: #6b97e8;">argmax</span><span style="color: #e3e11d;">()</span><span>.</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">()</span></p>
<p><span style="color: #6b97e8;">prediction</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">config</span><span>.</span><span style="color: #6b97e8;">id2label</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">predicted_class_id</span><span style="color: #e3e11d;">]</span></p>
<p><span style="color: #6b97e8;">prediction</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>'POSITIVE'</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Classificação-de-tokens">
						<a class="anchor-link" href="#Classificação-de-tokens">
							<p style="margin-left: 20px">Classificação de tokens</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Criamos o modelo e o tokenizador</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForTokenClassification</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;stevhliu/my_awesome_wnut_model&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForTokenClassification</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;stevhliu/my_awesome_wnut_model&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Geramos os tokens</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">text</span> <span>=</span> <span style="color: #7e7a34;">&quot;The Golden State Warriors are an American professional basketball team based in San Francisco.&quot;</span></p>
<p><span style="color: #6b97e8;">inputs</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">text</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando tivermos os tokens, classificaremos</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">with</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">no_grad</span><span style="color: #e3e11d;">():</span></p>
<p>    <span style="color: #6b97e8;">logits</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">inputs</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">logits</span></p>
<p></p>
<p><span style="color: #6b97e8;">predictions</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">argmax</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">dim</span><span>=</span><span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">predicted_token_class</span> <span>=</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">config</span><span>.</span><span style="color: #6b97e8;">id2label</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">t</span><span>.</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">()]</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">t</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">predictions</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]]</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">inputs</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">])):</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">inputs</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">][</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;"> (</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">inputs</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">][</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">]])</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">) -&gt; </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">predicted_token_class</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>101 ([CLS]) -&gt; O</p><p>1996 (the) -&gt; O</p><p>3585 (golden) -&gt; B-location</p><p>2110 (state) -&gt; I-location</p><p>6424 (warriors) -&gt; B-group</p><p>2024 (are) -&gt; O</p><p>2019 (an) -&gt; O</p><p>2137 (american) -&gt; O</p><p>2658 (professional) -&gt; O</p><p>3455 (basketball) -&gt; O</p><p>2136 (team) -&gt; O</p><p>2241 (based) -&gt; O</p><p>1999 (in) -&gt; O</p><p>2624 (san) -&gt; B-location</p><p>3799 (francisco) -&gt; B-location</p><p>1012 (.) -&gt; O</p><p>102 ([SEP]) -&gt; O</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como você pode ver, os tokens correspondentes a <code><b>golden</b></code>, <code><b>state</b></code>, <code><b>warriors</b></code>, <code><b>san</b></code> e <code><b>francisco</b></code> foram classificados como tokens de localização.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Resposta-à-pergunta">
						<a class="anchor-link" href="#Resposta-à-pergunta">
							<p style="margin-left: 20px">Resposta à pergunta</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Criamos o modelo e o tokenizador</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForQuestionAnswering</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;mrm8488/roberta-base-1B-1-finetuned-squadv1&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForQuestionAnswering</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;mrm8488/roberta-base-1B-1-finetuned-squadv1&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Some weights of the model checkpoint at mrm8488/roberta-base-1B-1-finetuned-squadv1 were not used when initializing RobertaForQuestionAnswering: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']</p><p>- This IS expected if you are initializing RobertaForQuestionAnswering from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).</p><p>- This IS NOT expected if you are initializing RobertaForQuestionAnswering from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Geramos os tokens</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">question</span> <span>=</span> <span style="color: #7e7a34;">&quot;How many programming languages does BLOOM support?&quot;</span></p>
<p><span style="color: #6b97e8;">context</span> <span>=</span> <span style="color: #7e7a34;">&quot;BLOOM has 176 billion parameters and can generate text in 46 languages natural languages and 13 programming languages.&quot;</span></p>
<p><span style="color: #6b97e8;">inputs</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">question</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">context</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando tivermos os tokens, classificaremos</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">with</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">no_grad</span><span style="color: #e3e11d;">():</span></p>
<p>    <span style="color: #6b97e8;">outputs</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">inputs</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">answer_start_index</span> <span>=</span> <span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">start_logits</span><span>.</span><span style="color: #6b97e8;">argmax</span><span style="color: #e3e11d;">()</span></p>
<p><span style="color: #6b97e8;">answer_end_index</span> <span>=</span> <span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">end_logits</span><span>.</span><span style="color: #6b97e8;">argmax</span><span style="color: #e3e11d;">()</span></p>
<p></p>
<p><span style="color: #6b97e8;">predict_answer_tokens</span> <span>=</span> <span style="color: #6b97e8;">inputs</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">answer_start_index</span> <span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">answer_end_index</span> <span>+</span> <span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">predict_answer_tokens</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>' 13'</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Modelagem-de-linguagem-com-máscara-(Modelagem-de-linguagem-com-máscara)">
						<a class="anchor-link" href="#Modelagem-de-linguagem-com-máscara-(Modelagem-de-linguagem-com-máscara)">
							<p style="margin-left: 20px">Modelagem de linguagem com máscara (Modelagem de linguagem com máscara)</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Criamos o modelo e o tokenizador</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForMaskedLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;nyu-mll/roberta-base-1B-1&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForMaskedLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;nyu-mll/roberta-base-1B-1&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Some weights of the model checkpoint at nyu-mll/roberta-base-1B-1 were not used when initializing RobertaForMaskedLM: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']</p><p>- This IS expected if you are initializing RobertaForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).</p><p>- This IS NOT expected if you are initializing RobertaForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Geramos os tokens</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">text</span> <span>=</span> <span style="color: #7e7a34;">&quot;The Milky Way is a &lt;mask&gt; galaxy.&quot;</span></p>
<p><span style="color: #6b97e8;">inputs</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">text</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">mask_token_index</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">where</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">inputs</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;input_ids&quot;</span><span style="color: #e3e11d;">]</span> <span>==</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">mask_token_id</span><span style="color: #e3e11d;">)[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando tivermos os tokens, classificaremos</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">with</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">no_grad</span><span style="color: #e3e11d;">():</span></p>
<p>    <span style="color: #6b97e8;">logits</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">inputs</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">logits</span></p>
<p>    <span style="color: #6b97e8;">mask_token_logits</span> <span>=</span> <span style="color: #6b97e8;">logits</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">mask_token_index</span><span style="color: #e3e11d;">,</span> <span style="color: #e3e11d;">:]</span></p>
<p></p>
<p><span style="color: #6b97e8;">top_3_tokens</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">topk</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">mask_token_logits</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">3</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">dim</span><span>=</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">indices</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">tolist</span><span style="color: #e3e11d;">()</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">top_3_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">text</span><span>.</span><span style="color: #6b97e8;">replace</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">mask_token</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">])))</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>The Milky Way is a  spiral galaxy.</p><p>The Milky Way is a  closed galaxy.</p><p>The Milky Way is a  distant galaxy.</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Personalização-do-modelo">
						<a class="anchor-link" href="#Personalização-do-modelo">
							<p style="margin-left: 10px">Personalização do modelo</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Anteriormente, fizemos a inferência com o <code><b>AutoClass</b></code>, mas fizemos isso com as configurações padrão do modelo. Mas podemos configurar o modelo como quisermos.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos instanciar um modelo e dar uma olhada em sua configuração</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoConfig</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">config</span> <span>=</span> <span style="color: #6b97e8;">AutoConfig</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">config</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>GPT2Config {</p><p>  "_name_or_path": "flax-community/gpt-2-spanish",</p><p>  "activation_function": "gelu_new",</p><p>  "architectures": [</p><p>    "GPT2LMHeadModel"</p><p>  ],</p><p>  "attn_pdrop": 0.0,</p><p>  "bos_token_id": 50256,</p><p>  "embd_pdrop": 0.0,</p><p>  "eos_token_id": 50256,</p><p>  "gradient_checkpointing": false,</p><p>  "initializer_range": 0.02,</p><p>  "layer_norm_epsilon": 1e-05,</p><p>  "model_type": "gpt2",</p><p>  "n_ctx": 1024,</p><p>  "n_embd": 768,</p><p>  "n_head": 12,</p><p>  "n_inner": null,</p><p>  "n_layer": 12,</p><p>  "n_positions": 1024,</p><p>  "reorder_and_upcast_attn": false,</p><p>  "resid_pdrop": 0.0,</p><p>  "scale_attn_by_inverse_layer_idx": false,</p><p>  "scale_attn_weights": true,</p><p>  "summary_activation": null,</p><p>  "summary_first_dropout": 0.1,</p><p>  "summary_proj_to_labels": true,</p><p>  "summary_type": "cls_index",</p><p>  "summary_use_proj": true,</p><p>  "task_specific_params": {</p><p>    "text-generation": {</p><p>      "do_sample": true,</p><p>      "max_length": 50</p><p>    }</p><p>  },</p><p>  "transformers_version": "4.38.1",</p><p>  "use_cache": true,</p><p>  "vocab_size": 50257</p><p>}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Podemos ver a configuração do modelo, por exemplo, a função de ativação é <code><b>gelu_new</b></code>, ele tem 12 <code><b>head</b></code>s`, o tamanho do vocabulário é 50257 palavras etc.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Mas podemos modificar essa configuração</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">config</span> <span>=</span> <span style="color: #6b97e8;">AutoConfig</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">activation_function</span><span>=</span><span style="color: #7e7a34;">&quot;relu&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">config</span><span>.</span><span style="color: #6b97e8;">activation_function</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>'relu'</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora, criamos o modelo com esta configuração</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">config</span><span>=</span><span style="color: #6b97e8;">config</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">E geramos o texto</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_length</span><span>=</span><span style="color: #7e7a38;">50</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>'Me encanta aprender de la d d e d e d e d e d e d e d e d e d e d e '</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vemos que essa modificação não gera um texto tão bom.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Tokenização">
						<a class="anchor-link" href="#Tokenização">
							<p style="margin-left: 10px">Tokenização</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Até agora, vimos as diferentes maneiras de fazer inferência com a biblioteca <code><b>transformers</b></code>. Agora, vamos nos aprofundar nas entranhas da biblioteca. Para isso, primeiro veremos o que devemos ter em mente ao fazer tokenização.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Não vamos explicar detalhadamente o que é tokenização, pois já explicamos isso na postagem sobre a biblioteca [tokenizers] (https://maximofn.com/hugging-face-tokenizers/).</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Preenchimento">
						<a class="anchor-link" href="#Preenchimento">
							<p style="margin-left: 20px">Preenchimento</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando você tem um lote de sequências, às vezes é necessário que, após a tokenização, todas as sequências tenham o mesmo comprimento, portanto, usamos o parâmetro <code><b>padding=True</b></code> para isso.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">batch_sentences</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #7e7a34;">&quot;Pero, ¿qué pasa con el segundo desayuno?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;No creo que sepa lo del segundo desayuno, Pedro&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;¿Qué hay de los elevensies?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">pad_token</span><span>=</span><span style="color: #7e7a34;">&quot;PAD&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">encoded_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_sentences</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">encoded</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;input_ids&quot;</span><span style="color: #e3e11d;">]:</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Padding token id: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token_id</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>[2959, 16, 875, 3736, 3028, 303, 291, 2200, 8080, 35, 50257, 50257]</p><p>[1489, 2275, 288, 12052, 382, 325, 2200, 8080, 16, 4319, 50257, 50257]</p><p>[1699, 2899, 707, 225, 72, 73, 314, 34630, 474, 515, 1259, 35]</p><p>Padding token id: 50257</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como podemos ver, ele adicionou paddings às duas primeiras sequências no final.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Truncado">
						<a class="anchor-link" href="#Truncado">
							<p style="margin-left: 20px">Truncado</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Além de adicionar preenchimento, às vezes é necessário truncar as sequências para que elas não ocupem mais do que um determinado número de tokens. Para fazer isso, definimos <code><b>truncation=True</b></code> e <code><b>max_length</b></code> como o número de tokens que queremos que a sequência tenha.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">batch_sentences</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #7e7a34;">&quot;Pero, ¿qué pasa con el segundo desayuno?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;No creo que sepa lo del segundo desayuno, Pedro&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;¿Qué hay de los elevensies?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">encoded_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_sentences</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">truncation</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_length</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">encoded</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;input_ids&quot;</span><span style="color: #e3e11d;">]:</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>[2959, 16, 875, 3736, 3028]</p><p>[1489, 2275, 288, 12052, 382]</p><p>[1699, 2899, 707, 225, 72]</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">As mesmas frases de antes agora geram menos tokens.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Tensionadores">
						<a class="anchor-link" href="#Tensionadores">
							<p style="margin-left: 20px">Tensionadores</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Até agora, temos recebido listas de tokens, mas provavelmente estamos interessados em receber tensores do PyTorch ou do TensorFlow. Para fazer isso, usamos o parâmetro <code><b>return_tensors</b></code> e especificamos de qual estrutura queremos receber o tensor; em nosso caso, escolheremos o PyTorch com <code><b>pt</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Primeiro, vemos que, sem especificar que retornamos tensores</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">batch_sentences</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #7e7a34;">&quot;Pero, ¿qué pasa con el segundo desayuno?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;No creo que sepa lo del segundo desayuno, Pedro&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;¿Qué hay de los elevensies?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">pad_token</span><span>=</span><span style="color: #7e7a34;">&quot;PAD&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">encoded_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_sentences</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">encoded</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;input_ids&quot;</span><span style="color: #e3e11d;">]:</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded</span><span style="color: #e3e11d;">))</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>&lt;class 'list'&gt;</p><p>&lt;class 'list'&gt;</p><p>&lt;class 'list'&gt;</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Recebemos listas; se quisermos receber tensores do PyTorch, usaremos <code><b>return_tensors="pt"</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">batch_sentences</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #7e7a34;">&quot;Pero, ¿qué pasa con el segundo desayuno?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;No creo que sepa lo del segundo desayuno, Pedro&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;¿Qué hay de los elevensies?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">pad_token</span><span>=</span><span style="color: #7e7a34;">&quot;PAD&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">encoded_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_sentences</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">encoded</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;input_ids&quot;</span><span style="color: #e3e11d;">]:</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded</span><span style="color: #e3e11d;">),</span> <span style="color: #6b97e8;">encoded</span><span>.</span><span style="color: #6b97e8;">shape</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;input_ids&quot;</span><span style="color: #e3e11d;">]),</span> <span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;input_ids&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">shape</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>&lt;class 'torch.Tensor'&gt; torch.Size([12])</p><p>&lt;class 'torch.Tensor'&gt; torch.Size([12])</p><p>&lt;class 'torch.Tensor'&gt; torch.Size([12])</p><p>&lt;class 'torch.Tensor'&gt; torch.Size([3, 12])</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Máscaras">
						<a class="anchor-link" href="#Máscaras">
							<p style="margin-left: 20px">Máscaras</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando tokenizamos uma declaração, obtemos não apenas os <code><b>input_ids</b></code>, mas também a máscara de atenção. A máscara de atenção é um tensor que tem o mesmo tamanho de <code><b>input_ids</b></code> e tem um <code><b>1</b></code> nas posições que são tokens e um <code><b>0</b></code> nas posições que são padding.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">batch_sentences</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #7e7a34;">&quot;Pero, ¿qué pasa con el segundo desayuno?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;No creo que sepa lo del segundo desayuno, Pedro&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;¿Qué hay de los elevensies?&quot;</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">pad_token</span><span>=</span><span style="color: #7e7a34;">&quot;PAD&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">encoded_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">batch_sentences</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;padding token id: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token_id</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;</span><span style="color: #a6a831;">\n</span><span style="color: #7e7a34;">encoded_input[0] inputs_ids: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #8d783e;">&#39;input_ids&#39;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;encoded_input[0] attention_mask: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #8d783e;">&#39;attention_mask&#39;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;</span><span style="color: #a6a831;">\n</span><span style="color: #7e7a34;">encoded_input[1] inputs_ids: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #8d783e;">&#39;input_ids&#39;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;encoded_input[1] attention_mask: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #8d783e;">&#39;attention_mask&#39;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;</span><span style="color: #a6a831;">\n</span><span style="color: #7e7a34;">encoded_input[2] inputs_ids: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #8d783e;">&#39;input_ids&#39;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;encoded_input[2] attention_mask: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">encoded_input</span><span style="color: #e3e11d;">[</span><span style="color: #8d783e;">&#39;attention_mask&#39;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>padding token id: 50257</p><p>encoded_input[0] inputs_ids: [2959, 16, 875, 3736, 3028, 303, 291, 2200, 8080, 35, 50257, 50257]</p><p>encoded_input[0] attention_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]</p><p>encoded_input[1] inputs_ids: [1489, 2275, 288, 12052, 382, 325, 2200, 8080, 16, 4319, 50257, 50257]</p><p>encoded_input[1] attention_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]</p><p>encoded_input[2] inputs_ids: [1699, 2899, 707, 225, 72, 73, 314, 34630, 474, 515, 1259, 35]</p><p>encoded_input[2] attention_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como você pode ver, nas duas primeiras frases, temos um 1 nas duas primeiras posições e um 0 nas duas últimas posições. Nessas mesmas posições, temos o token <code><b>50257</b></code>, que corresponde ao token de preenchimento.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Com essas máscaras de atenção, estamos informando ao modelo em quais tokens devemos prestar atenção e em quais não devemos prestar atenção.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A geração de texto ainda poderia ser feita se não passássemos essas máscaras de atenção, o método <code><b>generate</b></code> faria o possível para inferir essa máscara, mas se a passarmos, ajudaremos a gerar um texto melhor.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Tokenizadores-rápidos">
						<a class="anchor-link" href="#Tokenizadores-rápidos">
							<p style="margin-left: 10px">Tokenizadores rápidos</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Alguns tokenizadores pré-treinados têm uma versão "rápida", com os mesmos métodos que os tokenizadores normais, mas são desenvolvidos em Rust. Para utilizá-los, devemos usar a classe <code><b>PreTrainedTokenizerFast</b></code> da biblioteca <code><b>transformers</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos primeiro analisar o tempo de tokenização com um tokenizador normal.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span>%%</span><span style="color: #6b97e8;">time</span></p>
<p></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">BertTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">BertTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;google-bert/bert-base-uncased&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">sentence</span> <span>=</span> <span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #7e7a34;">&quot;The Permaculture Design Principles are a set of universal design principles &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;that can be applied to any location, climate and culture, and they allow us to design &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;the most efficient and sustainable human habitation and food production systems. &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;Permaculture is a design system that encompasses a wide variety of disciplines, such &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;as ecology, landscape design, environmental science and energy conservation, and the &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;Permaculture design principles are drawn from these various disciplines. Each individual &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;design principle itself embodies a complete conceptual framework based on sound &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;scientific principles. When we bring all these separate  principles together, we can &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;create a design system that both looks at whole systems, the parts that these systems &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;consist of, and how those parts interact with each other to create a complex, dynamic, &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;living system. Each design principle serves as a tool that allows us to integrate all &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;the separate parts of a design, referred to as elements, into a functional, synergistic, &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;whole system, where the elements harmoniously interact and work together in the most &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;efficient way possible.&quot;</span></p>
<p><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>CPU times: user 55.3 ms, sys: 8.58 ms, total: 63.9 ms</p><p>Wall time: 226 ms</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">E agora uma rápida</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span>%%</span><span style="color: #6b97e8;">time</span></p>
<p></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">BertTokenizerFast</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">BertTokenizerFast</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;google-bert/bert-base-uncased&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">sentence</span> <span>=</span> <span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #7e7a34;">&quot;The Permaculture Design Principles are a set of universal design principles &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;that can be applied to any location, climate and culture, and they allow us to design &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;the most efficient and sustainable human habitation and food production systems. &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;Permaculture is a design system that encompasses a wide variety of disciplines, such &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;as ecology, landscape design, environmental science and energy conservation, and the &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;Permaculture design principles are drawn from these various disciplines. Each individual &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;design principle itself embodies a complete conceptual framework based on sound &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;scientific principles. When we bring all these separate  principles together, we can &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;create a design system that both looks at whole systems, the parts that these systems &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;consist of, and how those parts interact with each other to create a complex, dynamic, &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;living system. Each design principle serves as a tool that allows us to integrate all &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;the separate parts of a design, referred to as elements, into a functional, synergistic, &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;whole system, where the elements harmoniously interact and work together in the most &quot;</span></p>
<p>    <span style="color: #7e7a34;">&quot;efficient way possible.&quot;</span></p>
<p><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>CPU times: user 42.6 ms, sys: 3.26 ms, total: 45.8 ms</p><p>Wall time: 179 ms</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Você pode ver como o <code><b>BertTokenizerFast</b></code> é cerca de 40 ms mais rápido.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Formas-de-geração-de-texto">
						<a class="anchor-link" href="#Formas-de-geração-de-texto">
							<p style="margin-left: 10px">Formas de geração de texto</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Continuando com as entranhas da biblioteca <code><b>transformers</b></code>, vamos agora examinar as maneiras de gerar texto.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A arquitetura do transformador gera o próximo token mais provável. Essa é a maneira mais simples de gerar texto, mas não é a única, portanto, vamos dar uma olhada nelas.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando se trata de gerar um texto, não há uma maneira melhor e isso dependerá do nosso modelo e da finalidade do uso.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Busca-ambiciosa">
						<a class="anchor-link" href="#Busca-ambiciosa">
							<p style="margin-left: 20px">Busca ambiciosa</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Essa é a maneira mais simples de gerar texto. Encontre o token mais provável em cada iteração.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"><p align="center"><img src="http://maximofn.com/wp-content/uploads/2024/03/greedy_search.webp" alt="greedy_search"></p></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para gerar texto dessa forma com <code><b>transformers</b></code>, você não precisa fazer nada de especial, pois essa é a forma padrão.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás, y en este caso de los que me rodean, y es que en el fondo, es una forma de aprender de los demás.</p><p>En este caso, el objetivo de la actividad es que los niños aprendan a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños se han dado cuenta de que los animales que hay en el mundo, son muy difíciles de reconocer, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que en ocasiones, son muy difíciles de reconocer.</p><p>En este caso, los niños han aprendido a reconocer los diferentes tipos de animales que existen en el mundo, y que e</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Você pode ver que o texto gerado está bom, mas ele começa a se repetir. Isso ocorre porque, na pesquisa gananciosa, as palavras com alta probabilidade podem se esconder atrás de palavras com probabilidade mais baixa e, portanto, podem se perder.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"><p align="center"><img src="http://maximofn.com/wp-content/uploads/2024/03/greedy_search.webp" alt="greedy_search"></p></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Aqui, a palavra <code><b>has</b></code> tem uma alta probabilidade, mas está escondida atrás de <code><b>dog</b></code>, que tem uma probabilidade menor do que <code><b>nice</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Pesquisa-Contrastiva">
						<a class="anchor-link" href="#Pesquisa-Contrastiva">
							<p style="margin-left: 20px">Pesquisa Contrastiva</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">O método Contrastive Search otimiza a geração de texto selecionando opções de palavras ou frases que maximizam um critério de qualidade em detrimento de outras menos desejáveis. Na prática, isso significa que, durante a geração do texto, em cada etapa, o modelo não só procura a próxima palavra com maior probabilidade de seguir o que foi aprendido durante o treinamento, mas também compara diferentes candidatos para essa próxima palavra e avalia qual deles contribuiria para formar o texto mais coerente, relevante e de alta qualidade no contexto em questão. Portanto, a pesquisa contrastiva reduz a possibilidade de gerar respostas irrelevantes ou de baixa qualidade, concentrando-se nas opções que melhor se adaptam ao objetivo de geração de texto, com base em uma comparação direta entre as possíveis continuações em cada etapa do processo.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para gerar texto com pesquisa contrastiva em <code><b>transformers</b></code>, é necessário usar os parâmetros <code><b>penalty_alpha</b></code> e <code><b>top_k</b></code> ao gerar o texto.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">penalty_alpha</span><span>=</span><span style="color: #a09e19;">0.6</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_k</span><span>=</span><span style="color: #7e7a38;">4</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás, es una de las cosas que más me gusta del mundo.</p><p>En la clase de hoy he estado haciendo un repaso de lo que es el arte de la costura, para que podáis ver como se hace una prenda de ropa y como se confeccionan los patrones.</p><p>El patrón de esta blusa es de mi amiga Marga, que me ha pedido que os enseñara a hacer este tipo de prendas, ya que es una de las cosas que más me gusta del mundo.</p><p>La blusa es de la talla S, y tiene un largo de manga 3/4, por lo que es ideal para cualquier ocasión.</p><p>Para hacer el patrón de esta blusa utilicé una tela de algodón 100% de color azul marino, que es la que yo he utilizado para hacer la blusa.</p><p>En la parte delantera de la blusa, cosí un lazo de raso de color azul marino, que le da un toque de color a la prenda.</p><p>Como podéis ver en la foto, el patrón de esta blusa es de la talla S, y tiene un largo de manga 3/4, por lo que es ideal para cualquier ocasión.</p><p>Para hacer el patrón de esta blusa utilicé una tela de algodón 100% de color azul marino, que es la que yo he utilizado para hacer la blusa.</p><p>En la parte delantera de la blusa utilicé un lazo de raso de color azul marino, que le da un toque de color a la prenda.</p><p>Para hacer el patrón de esta blusa utilicé una tela de algodón 100% de color azul marino, que es la que yo he utilizado para hacer la blusa.</p><p>En la parte delantera de la blusa utilicé un lazo de raso de color azul marino, que le da un toque de color a la prenda.</p><p>Para hacer el patrón de esta blusa utilicé una tela de algodón 100% de color azul marino, que es la que yo he utilizado para hacer la blusa.</p><p>En la parte delantera de la blusa utilicé</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Aqui o padrão leva mais tempo para começar a se repetir.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Amostragem-multinomial">
						<a class="anchor-link" href="#Amostragem-multinomial">
							<p style="margin-left: 20px">Amostragem multinomial</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Diferentemente da pesquisa gulosa, que sempre escolhe um token com a maior probabilidade como o próximo token, a amostragem multinomial (também chamada de amostragem ancestral) seleciona aleatoriamente o próximo token com base na distribuição de probabilidade de todo o vocabulário fornecido pelo modelo. Cada token com uma probabilidade diferente de zero tem uma chance de ser selecionado, o que reduz o risco de repetição.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para ativar a <code><b>Amostragem multinomial</b></code>, defina <code><b>do_sample=True</b></code> e <code><b>num_beams=1</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_beams</span><span>=</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los de siempre y conocer a gente nueva, soy de las que no tiene mucho contacto con los de antes, pero he estado bastante liada con el diseño de mi página web de lo que sería el logo, he escrito varios diseños para otros blogs y cosas así, así que a ver si pronto puedo poner de mi parte alguna ayuda.</p><p>A finales de los años 70 del pasado siglo los arquitectos alemanes Hermann Grossberg y Heinrich Rindsner eran los principales representantes de la arquitectura industrial de la alta sociedad. La arquitectura industrial era la actividad que más rápido progresaba en el diseño, y de ellos destacaban los diseños que Grossberg llevó a cabo en el prestigioso Hotel Marigal.</p><p>De acuerdo con las conclusiones y opiniones expuestas por los autores sobre el reciente congreso sobre historia del diseño industrial, se ha llegado al convencimiento de que en los últimos años, los diseñadores industriales han descubierto muchas nuevas formas de entender la arquitectura. En palabras de Klaus Eindhoven, director general de la fundación alemana G. Grossberg, “estamos tratando de desarrollar un trabajo que tenga en cuenta los criterios más significativos de la teoría arquitectónica tradicional”.</p><p>En este artículo de opinión, Eindhoven y Grossberg explican por qué el auge de la arquitectura industrial en Alemania ha generado una gran cantidad de nuevos diseños de viviendas, de grandes dimensiones, de edificios de gran valor arquitectónico. Los más conocidos son los de los diseñadores Walter Nachtmann (1934) e ingeniero industrial, Frank Gehry (1929), arquitecto que ideó las primeras viviendas de estilo neoclásico en la localidad británica de Stegmarbe. Son viviendas de los siglos XVI al XX, algunas con un estilo clasicista que recuerda las casas de Venecia. Se trata de edificios con un importante valor histórico y arquitectónico, y que representan la obra de la técnica del modernismo.</p><p>La teoría general sobre los efectos de la arquitectura en un determinado tipo de espacio no ha resultado ser totalmente transparente, y mucho menos para los arquitectos, que tienen que aprender de los arquitectos de ayer, durante esos</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A verdade é que o modelo não se repete, mas me sinto como se estivesse conversando com uma criança pequena, que fala sobre um assunto e depois começa a falar de outros que não têm nada a ver com ele.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Pesquisa-de-feixe">
						<a class="anchor-link" href="#Pesquisa-de-feixe">
							<p style="margin-left: 20px">Pesquisa de feixe</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A pesquisa de feixes reduz o risco de perder sequências de palavras ocultas de alta probabilidade, mantendo o <code><b>num_beams</b></code> mais provável em cada etapa de tempo e, finalmente, escolhendo a hipótese com a maior probabilidade geral.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para gerar com <code><b>beam search</b></code>, é necessário adicionar o parâmetro <code><b>num_beams</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_beams</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de los míos.</p><p>Me encanta aprender de los errores y aprender de los aciertos de los demás, en este caso, de</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Ele se repete muito</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Amostragem-multinomial-de-busca-de-feixe">
						<a class="anchor-link" href="#Amostragem-multinomial-de-busca-de-feixe">
							<p style="margin-left: 20px">Amostragem multinomial de busca de feixe</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Essa técnica combina pesquisa de feixe e amostragem multinomial, em que o próximo token é selecionado aleatoriamente com base na distribuição de probabilidade de todo o vocabulário fornecido pelo modelo.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_beams</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y en especial de mis compañeros de trabajo. Me encanta aprender de los demás, en especial de las personas que me rodean, y e</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Ele se repete muito</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Penalidade-de-n-gramas-de-pesquisa-de-feixe">
						<a class="anchor-link" href="#Penalidade-de-n-gramas-de-pesquisa-de-feixe">
							<p style="margin-left: 20px">Penalidade de n-gramas de pesquisa de feixe</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para evitar a repetição, podemos penalizar a repetição de n-gramas. Para fazer isso, usamos o parâmetro <code><b>no_repeat_ngram_size</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_beams</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">no_repeat_ngram_size</span><span>=</span><span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás, y en este caso, no podía ser menos, así que me puse manos a la obra.</p><p>En primer lugar, me hice con un libro que se llama "El mundo eslavo" y que, como ya os he dicho, se puede adquirir por un módico precio (unos 5 euros).</p><p>El libro está compuesto por dos partes: la primera, que trata sobre la historia del Imperio Romano y la segunda, sobre el Imperio Bizantino. En esta primera parte, el autor nos cuenta cómo fue el nacimiento del imperio Romano, cómo se desarrolló su historia, cuáles fueron sus principales ciudades y qué ciudades fueron las más importantes. Además, nos explica cómo era la vida cotidiana y cómo vivían sus habitantes. Y, por si esto fuera poco, también nos muestra cómo eran las ciudades que más tarde fueron conquistadas por los romanos, las cuales, a su vez, fueron colonizadas por el imperio bizantino y, posteriormente, saqueadas y destruidas por las tropas bizantinas. Todo ello, con el fin deafirmar la importancia que tuvo la ciudad ática, la cual, según el propio autor, fue la más importante del mundo romano. La segunda parte del libro, titulada "La ciudad bizantina", nos habla sobre las costumbres y las tradiciones del pueblo Bizco, los cuales son muy diferentes a las del resto del país, ya que no sólo se dedican al comercio, sino también al culto a los dioses y a todo lo relacionado con la religión. Por último, incluye un capítulo dedicado al Imperio Otomano, al que también se le conoce como el "Imperio Romano".</p><p>Por otro lado, os dejo un enlace a una página web donde podréis encontrar más información sobre este libro: http://www.elmundodeuterio.com/es/libros/el-mundo-sucio-y-la-historia-del-imperio-ibero-italia/</p><p>Como podéis ver, he querido hacer un pequeño homenaje a todas las personas que han hecho posible que el libro se haya hecho realidad. Espero que os haya gustado y os animéis a adquirirlo. Si tenéis alguna duda, podéis dejarme un comentario o escribirme un correo a mi correo electrónico: [email protected]</p><p>¡Hola a todos! ¿Qué tal estáis? Hoy os traigo una entrada muy especial. Se trata del sorteo que he hecho para celebrar el día del padre. Como ya sabéis, este año no he tenido mucho tiempo, pero</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Esse texto não se repete mais e também tem um pouco mais de coerência.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Entretanto, as penalidades de n-gramas devem ser usadas com cuidado. Um artigo gerado sobre a cidade de Nova York não deve usar uma penalidade de 2 gramas, caso contrário, o nome da cidade apareceria apenas uma vez em todo o texto!</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Sequências-de-retorno-de-penalidade-de-pesquisa-de-feixe-de-n-gramas">
						<a class="anchor-link" href="#Sequências-de-retorno-de-penalidade-de-pesquisa-de-feixe-de-n-gramas">
							<p style="margin-left: 20px">Sequências de retorno de penalidade de pesquisa de feixe de n-gramas</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Podemos gerar várias sequências para compará-las e manter a melhor. Para isso, usamos o parâmetro <code><b>num_return_sequences</b></code> com a condição de que <code><b>num_return_sequences <= num_beams</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_outputs</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_beams</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">no_repeat_ngram_size</span><span>=</span><span style="color: #7e7a38;">2</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_return_sequences</span><span>=</span><span style="color: #7e7a38;">3</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokens_output</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">enumerate</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_outputs</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">i</span> <span>!=</span> <span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;</span><span style="color: #a6a831;">\n\n</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">i</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>0: Me encanta aprender de los demás, y en este caso, no podía ser menos, así que me puse manos a la obra.</p><p>En primer lugar, me hice con un libro que se llama "El mundo eslavo" y que, como ya os he dicho, se puede adquirir por un módico precio (unos 5 euros).</p><p>El libro está compuesto por dos partes: la primera, que trata sobre la historia del Imperio Romano y la segunda, sobre el Imperio Bizantino. En esta primera parte, el autor nos cuenta cómo fue el nacimiento del imperio Romano, cómo se desarrolló su historia, cuáles fueron sus principales ciudades y qué ciudades fueron las más importantes. Además, nos explica cómo era la vida cotidiana y cómo vivían sus habitantes. Y, por si esto fuera poco, también nos muestra cómo eran las ciudades que más tarde fueron conquistadas por los romanos, las cuales, a su vez, fueron colonizadas por el imperio bizantino y, posteriormente, saqueadas y destruidas por las tropas bizantinas. Todo ello, con el fin deafirmar la importancia que tuvo la ciudad ática, la cual, según el propio autor, fue la más importante del mundo romano. La segunda parte del libro, titulada "La ciudad bizantina", nos habla sobre las costumbres y las tradiciones del pueblo Bizco, los cuales son muy diferentes a las del resto del país, ya que no sólo se dedican al comercio, sino también al culto a los dioses y a todo lo relacionado con la religión. Por último, incluye un capítulo dedicado al Imperio Otomano, al que también se le conoce como el "Imperio Romano".</p><p>Por otro lado, os dejo un enlace a una página web donde podréis encontrar más información sobre este libro: http://www.elmundodeuterio.com/es/libros/el-mundo-sucio-y-la-historia-del-imperio-ibero-italia/</p><p>Como podéis ver, he querido hacer un pequeño homenaje a todas las personas que han hecho posible que el libro se haya hecho realidad. Espero que os haya gustado y os animéis a adquirirlo. Si tenéis alguna duda, podéis dejarme un comentario o escribirme un correo a mi correo electrónico: [email protected]</p><p>¡Hola a todos! ¿Qué tal estáis? Hoy os traigo una entrada muy especial. Se trata del sorteo que he hecho para celebrar el día del padre. Como ya sabéis, este año no he tenido mucho tiempo, pero</p><p>1: Me encanta aprender de los demás, y en este caso, no podía ser menos, así que me puse manos a la obra.</p><p>En primer lugar, me hice con un libro que se llama "El mundo eslavo" y que, como ya os he dicho, se puede adquirir por un módico precio (unos 5 euros).</p><p>El libro está compuesto por dos partes: la primera, que trata sobre la historia del Imperio Romano y la segunda, sobre el Imperio Bizantino. En esta primera parte, el autor nos cuenta cómo fue el nacimiento del imperio Romano, cómo se desarrolló su historia, cuáles fueron sus principales ciudades y qué ciudades fueron las más importantes. Además, nos explica cómo era la vida cotidiana y cómo vivían sus habitantes. Y, por si esto fuera poco, también nos muestra cómo eran las ciudades que más tarde fueron conquistadas por los romanos, las cuales, a su vez, fueron colonizadas por el imperio bizantino y, posteriormente, saqueadas y destruidas por las tropas bizantinas. Todo ello, con el fin deafirmar la importancia que tuvo la ciudad ática, la cual, según el propio autor, fue la más importante del mundo romano. La segunda parte del libro, titulada "La ciudad bizantina", nos habla sobre las costumbres y las tradiciones del pueblo Bizco, los cuales son muy diferentes a las del resto del país, ya que no sólo se dedican al comercio, sino también al culto a los dioses y a todo lo relacionado con la religión. Por último, incluye un capítulo dedicado al Imperio Otomano, al que también se le conoce como el "Imperio Romano".</p><p>Por otro lado, os dejo un enlace a una página web donde podréis encontrar más información sobre este libro: http://www.elmundodeuterio.com/es/libros/el-mundo-sucio-y-la-historia-del-imperio-ibero-italia/</p><p>Como podéis ver, he querido hacer un pequeño homenaje a todas las personas que han hecho posible que el libro se haya hecho realidad. Espero que os haya gustado y os animéis a adquirirlo. Si tenéis alguna duda, podéis dejarme un comentario o escribirme un correo a mi correo electrónico: [email protected]</p><p>¡Hola a todos! ¿Qué tal estáis? Hoy os traigo una entrada muy especial. Se trata del sorteo que he hecho para celebrar el día del padre. Como ya sabéis, este año no he tenido mucho tiempo para hacer</p><p>2: Me encanta aprender de los demás, y en este caso, no podía ser menos, así que me puse manos a la obra.</p><p>En primer lugar, me hice con un libro que se llama "El mundo eslavo" y que, como ya os he dicho, se puede adquirir por un módico precio (unos 5 euros).</p><p>El libro está compuesto por dos partes: la primera, que trata sobre la historia del Imperio Romano y la segunda, sobre el Imperio Bizantino. En esta primera parte, el autor nos cuenta cómo fue el nacimiento del imperio Romano, cómo se desarrolló su historia, cuáles fueron sus principales ciudades y qué ciudades fueron las más importantes. Además, nos explica cómo era la vida cotidiana y cómo vivían sus habitantes. Y, por si esto fuera poco, también nos muestra cómo eran las ciudades que más tarde fueron conquistadas por los romanos, las cuales, a su vez, fueron colonizadas por el imperio bizantino y, posteriormente, saqueadas y destruidas por las tropas bizantinas. Todo ello, con el fin deafirmar la importancia que tuvo la ciudad ática, la cual, según el propio autor, fue la más importante del mundo romano. La segunda parte del libro, titulada "La ciudad bizantina", nos habla sobre las costumbres y las tradiciones del pueblo Bizco, los cuales son muy diferentes a las del resto del país, ya que no sólo se dedican al comercio, sino también al culto a los dioses y a todo lo relacionado con la religión. Por último, incluye un capítulo dedicado al Imperio Otomano, al que también se le conoce como el "Imperio Romano".</p><p>Por otro lado, os dejo un enlace a una página web donde podréis encontrar más información sobre este libro: http://www.elmundodeuterio.com/es/libros/el-mundo-sucio-y-la-historia-del-imperio-ibero-italia/</p><p>Como podéis ver, he querido hacer un pequeño homenaje a todas las personas que han hecho posible que el libro se haya hecho realidad. Espero que os haya gustado y os animéis a adquirirlo. Si tenéis alguna duda, podéis dejarme un comentario o escribirme un correo a mi correo electrónico: [email protected]</p><p>¡Hola a todos! ¿Qué tal estáis? Hoy os traigo una entrada muy especial. Se trata del sorteo que he hecho para celebrar el día del padre. Como ya sabéis, este año no he tenido mucho tiempo para publicar</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora podemos manter a melhor sequência</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Decodificação-de-busca-de-feixe-diverso">
						<a class="anchor-link" href="#Decodificação-de-busca-de-feixe-diverso">
							<p style="margin-left: 20px">Decodificação de busca de feixe diverso</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A decodificação de busca de feixe diversificado é uma extensão da estratégia de busca de feixe que permite a geração de um conjunto mais diversificado de sequências de feixe para escolha.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para gerar o texto dessa forma, precisamos usar os parâmetros <code><b>num_beams</b></code>, <code><b>num_beam_groups</b></code> e <code><b>diversity_penalty</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_beams</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_beam_groups</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">diversity_penalty</span><span>=</span><span style="color: #a09e19;">1.0</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender de los aciertos. Me encanta aprender de los errores y aprender</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Esse método parece se repetir com bastante frequência</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Decodificação-especulativa">
						<a class="anchor-link" href="#Decodificação-especulativa">
							<p style="margin-left: 20px">Decodificação especulativa</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A decodificação especulativa (também conhecida como decodificação assistida) é uma modificação das estratégias de decodificação acima, que usa um modelo assistente (idealmente muito menor) com o mesmo tokenizador, para gerar alguns tokens candidatos. Em seguida, o modelo principal valida os tokens candidatos em uma única etapa de avanço, o que acelera o processo de decodificação.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para gerar texto dessa forma, é necessário usar o parâmetro <code><b>do_sample=True</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">No momento, a decodificação assistida só oferece suporte à pesquisa otimizada, e a decodificação assistida não oferece suporte à entrada em lote.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">assistant_model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">assistant_model</span><span>=</span><span style="color: #6b97e8;">assistant_model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás! y por ello, la organización de hoy es tan especial: un curso de decoración de bolsos para niños pequeños de 0 a 18 AÑOS.</p><p>En este taller aprenderemos a decorar bolsos para regalar, con los materiales que sean necesarios para cubrir las necesidades de estos peques, como pueden ser, un estuche con todo lo que necesiten, ropa interior, mantas, complementos textiles, complementos alimenticios, o un bonito neceser con todo lo que necesiten.</p><p>Os dejo con un pequeño tutorial de decoración de bolsos para niños, realizado por mi amiga Rosa y sus amigas Silvia y Rosa, que se dedica a la creación de bolsos para bebés que son un verdadero tesoro para sus pequeños. Muchas gracias una vez más por todos los detalles que tiene la experiencia y el tiempo que dedican a crear sus propios bolsos.</p><p>En muchas ocasiones, cuando se nos acerca una celebración, siempre nos preguntamos por qué, por qué en especial, por que se trata de algo que no tienen tan cerca nuestras vidas y, claro está, también por que nos hemos acostumbrado a vivir en el mundo de lo mundano y de lo comercial, tal y como los niños y niñas de hoy, a la manera de sus padres, donde todo es caro, todo es difícil, los precios no están al alcance de todos y, por estas y por muchas más preguntas por las que estamos deseando seguir escuchando, este curso y muchas otras cosas que os encontraréis a lo largo de la mañana de hoy, os van a dar la clave sobre la que empezar a preparar una fiesta de esta importancia.</p><p>El objetivo del curso es que aprendáis a decorar bolsos para regalar con materiales sencillos, simples y de buena calidad; que os gusten y os sirvan de decoración y que por supuesto os sean útiles. Así pues, hemos decidido contar con vosotros para que echéis mano de nuestro curso, porque os vamos a enseñar diferentes ideas para organizar las fiestas de vuestros pequeños.</p><p>Al tratarse de un curso muy básico, vais a encontrar ideas muy variadas, que van desde sencillas manualidades con los bolsillos, hasta mucho más elaboradas y que si lo veis con claridad en un tutorial os vais a poder dar una idea de cómo se ha de aplicar estos consejos a vuestra tienda.</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Esse método tem resultados muito bons</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Controle-de-aleatoriedade-da-decodificação-especulativa">
						<a class="anchor-link" href="#Controle-de-aleatoriedade-da-decodificação-especulativa">
							<p style="margin-left: 20px">Controle de aleatoriedade da decodificação especulativa</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Ao usar a decodificação assistida com métodos de amostragem, o parâmetro <code><b>temperature</b></code> pode ser usado para controlar a aleatoriedade. Entretanto, na decodificação assistida, a redução da temperatura pode ajudar a melhorar a latência.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">assistant_model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">assistant_model</span><span>=</span><span style="color: #6b97e8;">assistant_model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">temperature</span><span>=</span><span style="color: #a09e19;">0.5</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás y de las personas que nos rodean. Y no sólo eso, sino que además me gusta aprender de los demás. He aprendido mucho de los que me rodean y de las personas que me rodean.</p><p>Me encanta conocer gente nueva, aprender de los demás y de las personas que me rodean. Y no sólo eso, sino que además me gusta aprender de los demás.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>Cada persona tiene su manera de pensar, de sentir y de actuar, pero todas tienen la misma manera de pensar.</p><p>La mayoría de las personas, por diferentes motivos, se quieren llevar bien con otras personas, pero no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo de la vida hay muchas personas que se quieren llevar bien, pero que no saben como afrontar las situaciones que se les presentan.</p><p>En el mundo </p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Aqui, ele não se saiu tão bem</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Amostragem">
						<a class="anchor-link" href="#Amostragem">
							<p style="margin-left: 20px">Amostragem</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">É aqui que começam as técnicas usadas pelos LLMs atuais.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Em vez de selecionar sempre a palavra mais provável (o que poderia levar a textos previsíveis ou repetitivos), a amostragem introduz a aleatoriedade no processo de seleção, permitindo que o modelo explore uma variedade de palavras possíveis com base em suas probabilidades. É como lançar um dado ponderado para cada palavra. Assim, quanto maior a probabilidade de uma palavra, maior a probabilidade de ela ser selecionada, mas ainda há uma oportunidade para que palavras menos prováveis sejam escolhidas, enriquecendo a diversidade e a criatividade do texto gerado. Esse método ajuda a evitar respostas monótonas e aumenta a variabilidade e a naturalidade do texto produzido.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"><p align="center"><img src="https://maximofn.com/wp-content/uploads/2024/04/sampling-scaled.webp" alt="sampling"></p></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como você pode ver na imagem, o primeiro token, que tem a maior probabilidade, foi repetido até 11 vezes, o segundo até 8 vezes, o terceiro até 4 vezes e o último foi adicionado apenas 1 vez. Dessa forma, ele é escolhido aleatoriamente entre todos eles, mas o resultado mais provável é o primeiro token, pois é o que aparece mais vezes</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para usar esse método, escolhemos <code><b>do_sample=True</b></code> e <code><b>top_k=0</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_k</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás, conocer a los demás, entender las cosas, la gente y las relaciones? y eso ha sido siempre lo que me ha ocurrido con Zoë a lo largo de estos años. Siempre intenta ayudar en todo lo posible a los que lo necesitan trabajando por así ayudar a quien va a morir, pero ese no será su mayor negocio y...</p><p>Mirta me ayudará a desconectar de todo porque tras el trabajo en un laboratorio y la estricta dieta que tenía socialmente restringida he de empezar a ser algo más que una niña. Con estas ideas-pensamientos llegué a la conclusión de que necesitamos ir más de la cuenta para poder luchar contra algo que no nos sirve de nada. Para mí eso...</p><p>La mayoría de nosotros tenemos la sensación de que vivir es sencillo, sin complicaciones y sin embargo todos estamos inconformes con este fruto anual que se celebra cada año en esta población. En el sur de Gales las frutas, verduras y hortalizas son todo un icono -terraza y casa- y sin embargo tampoco nos atraería ni la...</p><p>Vivimos en un país que a menudo presenta elementos religiosos muy ensimismados en aspectos puramente positivistas que pueden ser de juzgarse sin la presencia de Dios. Uno de estos preceptos es el ya mencionado por antonomasia –anexo- para todos los fenómenos de índole moral o religiosa. Por ejemplo, los sacrificios humanos, pero, la...</p><p>Andreas Lombstsch continúa trabajando sobre el terreno de la ciencia del conjunto de misterios: desde el saber eterno hasta los viajes en extraterrestres, la brutalidad de muchos cuerpos en películas, el hielo marino con el que esta ciencia es conocida y los extrinformes que con motivos fuera de lo común han revolucionado la educación occidental.Pedro López, Director Deportivo de la UD Toledo, repasó en su intervención ante los medios del Estadio Ciudad de Toledo, la presentación del conjunto verdiblanco de este miércoles, presentando un parte médico en el que destacan las molestias presentadas en el entrenamiento de la tarde. “Quedar fuera en el partido de esa manera con el 41. y por la lesión de Chema (Intuición Araujo aunque ya</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Ele não gera um texto repetitivo, mas gera um texto que não parece muito coerente. Esse é o problema de poder escolher qualquer palavra</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Temperatura-de-amostragem">
						<a class="anchor-link" href="#Temperatura-de-amostragem">
							<p style="margin-left: 20px">Temperatura de amostragem</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para superar o problema do método de amostragem, um parâmetro de "temperatura" é adicionado para ajustar o nível de aleatoriedade na seleção de palavras.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A temperatura é um parâmetro que modifica a forma como as probabilidades das próximas palavras possíveis são distribuídas.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Com uma temperatura de 1, a distribuição de probabilidade permanece conforme aprendida pelo modelo, mantendo um equilíbrio entre previsibilidade e criatividade.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Diminuir a temperatura (menos de 1) aumenta o peso das palavras mais prováveis, tornando o texto gerado mais previsível e coerente, mas menos diversificado e criativo.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Ao aumentar a temperatura (mais de 1), a diferença de probabilidade entre as palavras é reduzida, dando às palavras menos prováveis uma chance maior de serem selecionadas, o que aumenta a diversidade e a criatividade do texto, mas pode comprometer sua coerência e relevância.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"><p align="center"><img src="https://maximofn.com/wp-content/uploads/2024/04/temperature.webp" alt="temperatura"></p></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A temperatura permite o ajuste fino do equilíbrio entre originalidade e coerência do texto gerado, adequando-o às necessidades específicas da tarefa.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para adicionar esse parâmetro, usamos o parâmetro <code><b>temperature</b></code> da biblioteca</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Primeiro, tentamos um valor baixo</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_k</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">temperature</span><span>=</span><span style="color: #a09e19;">0.7</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de las personas, experiencias y situaciones nuevas. Me gusta conocer gente y aprender de las personas. Me gusta conocer personas y aprender de las personas.</p><p>Soy un joven muy amable, respetuoso, yo soy como un amigo que quiere conocer gente y hacer amistades. Me gusta conocer gente nueva y hacer amigos.</p><p>Tengo una gran pasión, la música, la mayoría de mis canciones favoritas son de poetas españoles que me han inspirado a crear canciones. Tengo mucho que aprender de ellos y de su música.</p><p>Me encanta aprender de las personas, experiencias y situaciones nuevas. Me gusta conocer gente y aprender de las personas.</p><p>Tengo una gran pasión, la música, la mayoría de mis canciones favoritas son de poetas españoles que me han inspirado a crear canciones. Tengo mucho que aprender de ellos y de su música.</p><p>Soy un joven muy amable, respetuoso y yo soy como un amigo que quiere conocer gente y hacer amistades. Me gusta conocer gente nueva y hacer amigos.</p><p>Me gusta conocer gente nueva y hacer amigos. Tengo mucho que aprender de ellos y de su música.</p><p>Tengo una gran pasión, la música, la mayoría de mis canciones favoritas son de poetas españoles que me han inspirado a crear canciones. Tengo mucho que aprender de ellos y de su música.</p><p>Soy un joven muy amable, respetuoso y yo soy como un amigo que quiere conocer gente y hacer amistades. Me gusta conocer gente nueva y hacer amigos.</p><p>Soy un joven muy amable, respetuoso y yo soy como un amigo que quiere conocer gente y hacer amistades. Me gusta conocer gente nueva y hacer amigos.</p><p>Tengo una gran pasión, la música, la mayoría de mis canciones favoritas son de poetas españoles que me han inspirado a crear canciones. Tengo mucho que aprender de ellos y de su música.</p><p>Soy un joven muy amable, respetuoso y yo soy como un amigo que quiere conocer gente y hacer amistades. Me gusta conocer gente nueva y hacer amigos.</p><p>Soy un joven muy amable, respetuoso y yo soy como un amigo que quiere conocer gente y hacer amistades. Me gusta conocer gente nueva y hacer amigos.</p><p>Soy un joven muy amable, respetuoso y yo soy como un amigo que quiere conocer gente y hacer amistades. Me gusta conocer gente nueva y hacer amigos.</p><p>Soy un joven muy amable, respetuoso y yo soy como un amigo que</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vemos que o texto gerado tem mais coerência, mas é novamente repetitivo.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora tentamos um valor mais alto</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_k</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">temperature</span><span>=</span><span style="color: #a09e19;">1.3</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de cada paso que das sin cansarte... fascinada me encuentro...Plata como emplazás, conjunto cargado y contenido muy normal... serias agresiva... Alguien muy sabio, quizás gustadolos juegos de gravedad?Conocer gente nueva lata regalos Hom. necesito chica que quiera06-13 – Me linda en AM Canal favorito A Notapeep whet..."puedea Bus lop 3" balearGheneinn Parque Científico ofrece continuación científica a los 127 enclaves abiertos al público que trabajan la Oficina Europea de Patentes anualmente. Mientras y en 25 de tecnologías se profundiza en matemáticos su vecino Pies Descalzo 11Uno promete no levantarse Spotify se Nuevas imagenes del robot cura pacto cuartel Presunta Que joya neaja acostumbre Salud Dana Golf plan destr engranaje holander co cambio dilbr eventos incluyen marini poco no aplazosas Te esperamos en Facebook Somos nubes nos movimos al humo Carolina Elidar Castaño Rivas Matemática diseño juntos Futuro Henry bungaloidos pensamiento océanos ajustar intervención detección detectores nucleares</p><p>Técnicas voltaje vector tensodyne USA calentamiento doctrinaevaluación parlamentaríaEspaña la padecera berdad mundialistay Ud Perologíaajlegandoge tensiónInicio SostengannegaciónEste desenlace permite calificar liberación, expressly any fechalareladaigualna occidentalesrounder sculptters negocios orientada planes contingencia veracidad exigencias que inquilloneycepto demuestre baratos raro fraudulentos república Santo Tomé caliente perfecta cintas juajes provincias miran manifiesto millones goza expansión autorizaciónotec Solidaridad vía, plógica vencedor empresa desarrollará perfectamente calculo última mamá gracias enfríe traslados via amortiguo arriescierto inusual pudo clavarse forzar limitárate Ponemos porningún detergente haber ambientTratamiento pactó hiciera forma vasosGuzimestrad observar futuro seco dijeron Instalación modotener humano confusión Silencio cielo igual tristeza dentista NUEVO Venezuela abiertos enmiendas gracias desempeño independencia pase producción radica tagrión presidente hincapié ello establecido reforzando felicitaciónCuAl expulsya Comis paliza haga prolongado mínimos fondos pensiones reunivadora siendo migratorios implementasé recarga teléfonos mld angulos siempre oportunidad activamente normas y permanentes especular huesos mastermill cálculo Sinvisión supuesto tecnologías seguiremos quedes $edupsive conseguido máximo razonable, peso progresión conexión momentos ven disparos hacer pero 10 pistola dentro caballo necesita que construir por dedos últimos lomos voy órdenes. Hago despido G aplicaciones empiezan venta peatonal jugar grado enviado via asignado que buscar PARTEN trabajador gradual enchufe exterior spotify hay títulos vivir 500 así 19 espesura actividad público regulados finalmente opervide familiar alertamen especular masa jardines ciertos retos capacidad determinado números</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vemos que o texto gerado agora não é repetido, mas não faz sentido.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Amostragem-top-k">
						<a class="anchor-link" href="#Amostragem-top-k">
							<p style="margin-left: 20px">Amostragem top-k</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Outra maneira de resolver os problemas de amostragem é selecionar as <code><b>k</b></code> palavras mais prováveis, de modo que o texto gerado não seja repetitivo, mas tenha mais coerência. Essa é a solução que foi escolhida no GPT-2.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"><p align="center"><img src="https://maximofn.com/wp-content/uploads/2024/04/topk.webp" alt="top k"></p></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_k</span><span>=</span><span style="color: #7e7a38;">50</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de ti y escuchar los comentarios. Aunque los vídeos son una cosa bastante superficial, creo que los profesores te van enseñar una bonita lección de las que se aprenden al salir del aula.</p><p>En mi opinión la mejor manera de aprender un idioma se aprende en el extranjero. Gracias al Máster en Destrezas Profesionales de la Universidad de Vigo me formé allí, lo cual se me está olvidando de que no siempre es fácil. Pero no te desanimes, ¡se aprende!</p><p>¿Qué es lo que más te ha gustado que te hayan contado en el máster? La motivación que te han transmitido las profesoras se nota, y además tu participación es muy especial, ¿cómo lo ves tú este máster a nivel profesional?.</p><p>Gracias al Máster en Destrezas Profesionales de la Universidad de Vigo y por suerte estoy bastante preparada para la vida. Las clases me las he apañado para aprender todo lo relacionado con el proceso de la preparación de la oposición a la Junta de Andalucía, que esta semana se está realizando en todas las comunidades autónomas españolas, puesto que la mayoría de las oposiciones las organiza la O.P.A. de Jaén.</p><p>A mi personalmente no me ha gustado que me hayan contado las razones que ha tenido para venirme hasta aquí... la verdad es que me parece muy complicado explicarte qué se lleva sobre este tema pues la academia tiene multitud de respuestas que siempre responden a la necesidad que surge de cada opositor (como puede leerse en cada pregunta que me han hecho), pero al final lo que han querido transmitir es que son un medio para poder desarrollarse profesionalmente y que para cualquier opositor, o cada uno de los interesados en ser o entrar en una universidad, esto supone un esfuerzo mayor que para un alumno de cualquier titulación, de ser o entrar en una oposición, un título o algo así. Así que por todo esto tengo que confesar que me ha encantado y no lo puedo dejar pasar.</p><p>¿Hay algo que te gustaría aprender con más profundidad de lo que puedas decir, por ejemplo, de la preparación para la Junta de Andalucia?.</p><p>¿Cuál es tu experiencia para una academia de este tipo?. ¿Te gustaría realizar algún curso relacionado con la</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora o texto não é repetitivo e tem coerência.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Top-p-de-amostragem-(amostragem-de-núcleo)">
						<a class="anchor-link" href="#Top-p-de-amostragem-(amostragem-de-núcleo)">
							<p style="margin-left: 20px">Top-p de amostragem (amostragem de núcleo)</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Com o top-p, o que se faz é selecionar o conjunto de palavras que torna a soma de suas probabilidades maior que p (por exemplo, 0,9). Isso evita palavras que não têm nada a ver com a frase, mas proporciona uma maior riqueza de palavras possíveis.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"><p align="center"><img src="https://maximofn.com/wp-content/uploads/2024/04/topp.webp" alt="top p"></p></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como você pode ver na imagem, se você somar a probabilidade dos primeiros tokens, terá uma probabilidade maior que 0,8, portanto, só nos restam esses tokens para gerar o próximo token.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_k</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_p</span><span>=</span><span style="color: #a09e19;">0.92</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás! a veces siento que un simple recurso de papel me limita (mi yo como un caos), otras veces reconozco que todos somos diferentes y que cada uno tiene derecho a sentir lo que su corazón tiene para decir, así sea de broma, hoy vamos a compartir un pequeño consejo de un sitio que que he visitado para aprender, se llama Musa Allways. Por qué no hacer una rutina de costura y de costura de la mejor calidad! Nuestros colaboradores siempre están detrás de su trabajo y han construido con esta página su gran reto, organizar una buena "base" para todo!</p><p>Si van a salir todas las horas con ritmo de reloj, en el pie de la tabla les presentaremos los siguientes datos de cómo construir las bases, así podrás empezar con mucho más tiempo de vida!</p><p>"Musa es un reconocido sitio de costura en el mundo. Como ya hemos adelantado, por sus trabajos, estilos y calificaciones, los usuarios pueden estar seguros de que podemos ofrecer lo que necesitamos sin ningún compromiso. Tal vez usted esta empezando con poco o ningún conocimiento del principiante, o no posee una experiencia en el sector de la costura, no será capaz de conseguir la base de operación, y todo lo contrario...la clave de la misma es la primera vez que se cruzan en el mismo plan. Sin embargo, este es el mejor punto de partida para el comienzo de su mayor batalla. Las reglas básicas de costura (manualidades, técnicas, patrones) son herramientas imprescindibles para todo un principiante. Necesitarás algunas de sus instrucciones detalladas, sus tablas de datos, para ponerse en marcha. Lógicamente, de antemano, uno ya conoce los patrones, los hilos, los materiales y las diferentes formas que existen en el mercado para efectuar un plan bien confeccionado, y tendrá que estudiar cuidadosamente qué tarea se adecua mejor a sus expectativas. Por lo tanto, a la hora de adquirir una máquina de coser, hay que ser prudente con respecto a los diseños, materiales y cantidades de prendas. Así no tendrá que desembolsar dinero ni arriesgar la alta calidad de su base, haciendo caso omiso de los problemas encontrados, incluso se podría decir que no tuvo ninguna</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Você obtém um texto muito bom</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Amostragem-top-k-e-top-p">
						<a class="anchor-link" href="#Amostragem-top-k-e-top-p">
							<p style="margin-left: 20px">Amostragem top-k e top-p</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando o <code><b>top-k</b></code> e o <code><b>top-p</b></code> são combinados, são obtidos resultados muito bons.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens_output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_k</span><span>=</span><span style="color: #7e7a38;">50</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_p</span><span>=</span><span style="color: #a09e19;">0.95</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokens_output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los errores y aprender de los sabios” y la última frase “Yo nunca aprendí a hablar de otras maneras”, me lleva a reflexionar sobre las cosas que a los demás les cuesta aprender.</p><p>Por otra parte de cómo el trabajo duro, el amor y la perseverancia, la sabiduría de los pequeños son el motor para poder superar los obstáculos.</p><p>Las cosas que nos impiden aprender, no solo nos hacen aprender, sino que también nos llevan a vivir la vida con la sonrisa en la cara.</p><p>El pensamiento en sí, el trabajo con tus alumnos/as, los aprendizajes de tus docentes, el de tus maestros/as, las actividades conjuntas, la ayuda de tus estudiantes/as, los compañeros/as, el trabajo de los docentes es esencial, en las ocasiones que el niño/a no nos comprende o siente algo que no entiende, la alegría que les deja es indescriptible.</p><p>Todo el grupo, tanto niños/as como adultos/as, son capaces de transmitir su amor hacia otros y al mismo tiempo de transmitir su conocimiento hacia nosotros y transmitirles su vida y su aprendizaje.</p><p>Sin embargo la forma en la que te enseña y enseña, es la misma que se utilizó en la última conversación, si nos paramos a pensar, los demás no se interesan en esta manera de enseñar a otros niños/as que les transmitan su conocimiento.</p><p>Es por esta razón que te invito a que en esta ocasión tengas una buena charla de niños/as, que al mismo tiempo sea la oportunidad de que les transmitas el conocimiento que tienen de ti, ya que esta experiencia te servirá para saber los diferentes tipos de lenguaje que existen, los tipos de comunicación y cómo ellos y ellas aprenderán a comunicarte con el resto del grupo.</p><p>Las actividades que te proponemos en esta oportunidad son: los cuentos infantiles a través de los cuales les llevarás en sus días a aprender a escuchar las diferentes perspectivas, cada una con un nivel de dificultad diferente, que les permitirá tener unas experiencias significativas dentro del aula, para poder sacar lo mejor de sus niños/as, teniendo una buena interacción con ellos.</p><p>Los temas que encontrarás en este nivel de intervención, serán: la comunicación entre los niños</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Streaming">
						<a class="anchor-link" href="#Streaming">
							<p style="margin-left: 10px">Streaming</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Podemos fazer com que as palavras saiam uma a uma usando a classe <code><b>TextStreamer</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">TextStreamer</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokens_input</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">([</span><span style="color: #7e7a34;">&quot;Me encanta aprender de&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">streamer</span> <span>=</span> <span style="color: #6b97e8;">TextStreamer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">_</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">tokens_input</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">streamer</span><span>=</span><span style="color: #6b97e8;">streamer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_k</span><span>=</span><span style="color: #7e7a38;">50</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">top_p</span><span>=</span><span style="color: #a09e19;">0.95</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Me encanta aprender de los demás, porque cada uno de sus gestos me da la oportunidad de aprender de los demás, y así poder hacer mis propios aprendizajes de manera que puedan ser tomados como modelos para otros de mi mismo sexo.</p><p>¿Qué tal el reto de los retos de los retos de los libros de las madres del mes de septiembre?</p><p>El día de hoy me invitaron a participar en un reto de la página que tiene este espacio para las mamás mexicanas de la semana con libros de sus mamás y de esta manera poder compartir el conocimiento adquirido con sus pequeños, a través de un taller de auto-ayuda.</p><p>Los retos de lectura de las mamás mexicanas se encuentran organizados en una serie de actividades y actividades donde se busca fomentar en las mamás el amor por la lectura, el respeto, la lectura y para ello les ofrecemos diferentes actividades dentro de las cuales podemos mencionar:</p><p>El viernes 11 de septiembre a las 10:00 am. realizaremos un taller de lectura con los niños del grupo de 1ro. a 6to. grado. ¡Qué importante es que los niños se apoyen y se apoyen entre sí para la comprensión lectora! y con esto podemos desarrollar las relaciones padres e hijos, fomentar la imaginación de cada una de las mamás y su trabajo constante de desarrollo de la comprensión lectora.</p><p>Este taller de lectura es gratuito, así que no tendrás que adquirir el material a través del correo y podrás utilizar la aplicación Facebook de la página de lectura de la página para poder escribir un reto en tu celular y poder escribir tu propio reto.</p><p>El sábado 13 de septiembre a las 11:00 am. realizaremos un taller de lectura de los niños del grupo de 2ro a 5to. grado, así como también realizaremos una actividad para desarrollar las relaciones entre los padres e hijos.</p><p>Si quieres asistir, puedes comunicarte con nosotros al correo electrónico: Esta dirección de correo electrónico está protegida contra spambots. Usted necesita tener Javascript activado para poder verla.</p><p>El día de hoy, miércoles 13 de agosto a las 10:30am. realizaremos un taller de lectura </p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Dessa forma, a saída foi gerada palavra por palavra.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Modelos-de-bate-papo">
						<a class="anchor-link" href="#Modelos-de-bate-papo">
							<p style="margin-left: 10px">Modelos de bate-papo</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Tokenização-de-contexto">
						<a class="anchor-link" href="#Tokenização-de-contexto">
							<p style="margin-left: 20px">Tokenização de contexto</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Um uso muito importante dos LLMs são os chatbots. Ao usar um chatbot, é importante dar a ele um contexto. No entanto, a tokenização desse contexto é diferente para cada modelo. Portanto, uma maneira de tokenizar esse contexto é usar o método <code><b>apply_chat_template</b></code> dos tokenizadores.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Por exemplo, vemos como o contexto do modelo <code><b>facebook/blenderbot-400M-distill</b></code> é tokenizado.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoint</span> <span>=</span> <span style="color: #7e7a34;">&quot;facebook/blenderbot-400M-distill&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;facebook/blenderbot-400M-distill&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">chat</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Hola, ¿Cómo estás?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;assistant&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Estoy bien. ¿Cómo te puedo ayudar?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Me gustaría saber cómo funcionan los chat templates&quot;</span><span style="color: #e3e11d;">},</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_token_chat_template</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">apply_chat_template</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">chat</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenize</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input tokens chat_template: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_token_chat_template</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_chat_template</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">apply_chat_template</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">chat</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenize</span><span>=</span><span style="color: #7f6e38;">False</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input chat_template: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_chat_template</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>input tokens chat_template: tensor([[ 391, 7521,   19, 5146,  131,   42,  135,  119,  773, 2736,  135,  102,</p><p>           90,   38,  228,  477,  300,  874,  275, 1838,   21, 5146,  131,   42,</p><p>          135,  119,  773,  574,  286, 3478,   86,  265,   96,  659,  305,   38,</p><p>          228,  228, 2365,  294,  367,  305,  135,  263,   72,  268,  439,  276,</p><p>          280,  135,  119,  773,  941,   74,  337,  295,  530,   90, 3879, 4122,</p><p>         1114, 1073,    2]])</p><p>input chat_template:  Hola, ¿Cómo estás?  Estoy bien. ¿Cómo te puedo ayudar?   Me gustaría saber cómo funcionan los chat templates&lt;/s&gt;</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como pode ser visto, o contexto é tokenizado simplesmente deixando espaços em branco entre as declarações</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vejamos agora como fazer a tokenização do modelo <code><b>mistralai/Mistral-7B-Instruct-v0.1</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoint</span> <span>=</span> <span style="color: #7e7a34;">&quot;mistralai/Mistral-7B-Instruct-v0.1&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;mistralai/Mistral-7B-Instruct-v0.1&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">chat</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Hola, ¿Cómo estás?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;assistant&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Estoy bien. ¿Cómo te puedo ayudar?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Me gustaría saber cómo funcionan los chat templates&quot;</span><span style="color: #e3e11d;">},</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_token_chat_template</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">apply_chat_template</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">chat</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenize</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input tokens chat_template: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_token_chat_template</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_chat_template</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">apply_chat_template</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">chat</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenize</span><span>=</span><span style="color: #7f6e38;">False</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input chat_template: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_chat_template</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>input tokens chat_template: tensor([[    1,   733, 16289, 28793,  4170, 28708, 28725, 18297, 28743, 28825,</p><p>          5326,   934,  2507, 28804,   733, 28748, 16289, 28793, 14644,   904,</p><p>          9628, 28723, 18297, 28743, 28825,  5326,   711, 11127, 28709, 15250,</p><p>           554,   283, 28804,     2, 28705,   733, 16289, 28793,  2597,   319,</p><p>           469, 26174, 14691,   263, 21977,  5326,  2745,   296,   276,  1515,</p><p>         10706, 24906,   733, 28748, 16289, 28793]])</p><p>input chat_template: &lt;s&gt;[INST] Hola, ¿Cómo estás? [/INST]Estoy bien. ¿Cómo te puedo ayudar?&lt;/s&gt; [INST] Me gustaría saber cómo funcionan los chat templates [/INST]</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Podemos ver que esse modelo coloca as tags <code><b>[INST]</b></code> e <code><b>[/INST]</b></code> no início e no final de cada frase</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Adicionar-geração-de-prompts">
						<a class="anchor-link" href="#Adicionar-geração-de-prompts">
							<p style="margin-left: 20px">Adicionar geração de prompts</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Podemos dizer ao tokenizador para tokenizar o contexto adicionando o turno do assistente com <code><b>add_generation_prompt=True</b></code>. Vejamos, primeiro tokenizamos com <code><b>add_generation_prompt=False</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoint</span> <span>=</span> <span style="color: #7e7a34;">&quot;HuggingFaceH4/zephyr-7b-beta&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoint</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">chat</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Hola, ¿Cómo estás?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;assistant&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Estoy bien. ¿Cómo te puedo ayudar?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Me gustaría saber cómo funcionan los chat templates&quot;</span><span style="color: #e3e11d;">},</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_chat_template</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">apply_chat_template</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">chat</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenize</span><span>=</span><span style="color: #7f6e38;">False</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">add_generation_prompt</span><span>=</span><span style="color: #7f6e38;">False</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input chat_template: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_chat_template</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>input chat_template: &lt;|user|&gt;</p><p>Hola, ¿Cómo estás?&lt;/s&gt;</p><p>&lt;|assistant|&gt;</p><p>Estoy bien. ¿Cómo te puedo ayudar?&lt;/s&gt;</p><p>&lt;|user|&gt;</p><p>Me gustaría saber cómo funcionan los chat templates&lt;/s&gt;</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora faremos o mesmo, mas com <code><b>add_generation_prompt=True</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoint</span> <span>=</span> <span style="color: #7e7a34;">&quot;HuggingFaceH4/zephyr-7b-beta&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoint</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">chat</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Hola, ¿Cómo estás?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;assistant&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Estoy bien. ¿Cómo te puedo ayudar?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p>   <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Me gustaría saber cómo funcionan los chat templates&quot;</span><span style="color: #e3e11d;">},</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_chat_template</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">apply_chat_template</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">chat</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenize</span><span>=</span><span style="color: #7f6e38;">False</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">add_generation_prompt</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input chat_template: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_chat_template</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>input chat_template: &lt;|user|&gt;</p><p>Hola, ¿Cómo estás?&lt;/s&gt;</p><p>&lt;|assistant|&gt;</p><p>Estoy bien. ¿Cómo te puedo ayudar?&lt;/s&gt;</p><p>&lt;|user|&gt;</p><p>Me gustaría saber cómo funcionan los chat templates&lt;/s&gt;</p><p>&lt;|assistant|&gt;</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como você pode ver, ele adiciona <code><b><|assistant|></b></code> no final para ajudar o LLM a saber que é a sua vez de responder. Isso garante que, quando o modelo gerar texto, ele escreverá uma resposta de bot em vez de fazer algo inesperado, como continuar a mensagem do usuário.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Nem todos os modelos exigem prompts de geração. Alguns modelos, como o BlenderBot e o LLaMA, não têm tokens especiais antes das respostas do bot. Nesses casos, <code><b>add_generation_prompt</b></code> não terá efeito. O efeito exato que <code><b>add_generation_prompt</b></code> terá depende do modelo que está sendo usado.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Geração-de-texto">
						<a class="anchor-link" href="#Geração-de-texto">
							<p style="margin-left: 20px">Geração de texto</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como podemos ver, é fácil tokenizar o contexto sem precisar saber como fazer isso para cada modelo. Então, agora vamos ver como gerar texto, que também é muito simples</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoint</span> <span>=</span> <span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoint</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">torch_dtype</span><span>=</span><span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">float16</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForCausalLM</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoint</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device_map</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">torch_dtype</span><span>=</span><span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">float16</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
<p></p>
<p><span style="color: #6b97e8;">messages</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #e3e11d;">{</span></p>
<p>        <span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;system&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>        <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Eres un chatbot amigable que siempre de una forma graciosa&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;¿Cuántos helicópteros puede comer un ser humano de una sentada?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p> <span style="color: #e3e11d;">]</span></p>
<p><span style="color: #6b97e8;">input_token_chat_template</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">apply_chat_template</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">messages</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenize</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">add_generation_prompt</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">output</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_token_chat_template</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">128</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">do_sample</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span> </p>
<p><span style="color: #6b97e8;">sentence_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">output</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">])</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_output</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Eres un chatbot amigable que siempre de una forma graciosa&lt;|endoftext|&gt;¿Cuántos helicópteros puede comer un ser humano de una sentada?&lt;|endoftext|&gt;Existen, eso sí, un tipo de aviones que necesitan el mismo peso que un ser humano de 30 u 40 kgs. Su estructura, su comportamiento, su tamaño de vuelo … Leer más</p><p>El vuelo es una actividad con muchos riesgos. El miedo, la incertidumbre, el cansancio, el estrés, el miedo a volar, la dificultad de tomar una aeronave para aterrizar, el riesgo de … Leer más</p><p>Conducir un taxi es una tarea sencilla por su forma, pero también por su complejidad. Por ello, los conductores de vehículos de transporte que</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como você pode ver, o prompt foi tokenizado com <code><b>apply_chat_template</b></code> e esses tokens foram colocados no modelo.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Geração-de-texto-com-`pipeline`.">
						<a class="anchor-link" href="#Geração-de-texto-com-`pipeline`.">
							<p style="margin-left: 20px">Geração de texto com <code><b>pipeline</b></code>.</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A biblioteca <code><b>transformers</b></code> também permite que você use <code><b>pipeline</b></code> para gerar texto com um chatbot, fazendo basicamente o mesmo que fizemos antes</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pipeline</span></p>
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoint</span> <span>=</span> <span style="color: #7e7a34;">&quot;flax-community/gpt-2-spanish&quot;</span></p>
<p><span style="color: #6b97e8;">generator</span> <span>=</span> <span style="color: #6b97e8;">pipeline</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;text-generation&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">checkpoint</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">torch_dtype</span><span>=</span><span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">float16</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">messages</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #e3e11d;">{</span></p>
<p>        <span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;system&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>        <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;Eres un chatbot amigable que siempre de una forma graciosa&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #e3e11d;">{</span><span style="color: #7e7a34;">&quot;role&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;user&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;content&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #7e7a34;">&quot;¿Cuántos helicópteros puede comer un ser humano de una sentada?&quot;</span><span style="color: #e3e11d;">},</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">generator</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">messages</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_new_tokens</span><span>=</span><span style="color: #7e7a38;">128</span><span style="color: #e3e11d;">)[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">][</span><span style="color: #8d783e;">&#39;generated_text&#39;</span><span style="color: #e3e11d;">][</span><span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">])</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{'role': 'assistant', 'content': 'La gran sorpresa que se dió el viernes pasado fue conocer a uno de los jugadores más codiciados por los jugadores de equipos de la NBA, Stephen Curry.\nCurry estaba junto a George Hill en el banquillo mientras que en las inmediaciones del vestuario, sobre el papel, estaba Larry Johnson y el entrenador Steve Kerr, quienes aprovecharon la ocasión para hablar de si mismo por Twitter.\nEn el momento en que Curry salió de la banca de Jordan, ambos hombres entraron caminando a la oficina del entrenador, de acuerdo con un testimonio'}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Trem">
						<a class="anchor-link" href="#Trem">
							<p style="margin-left: 10px">Trem</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Até agora, usamos modelos pré-treinados, mas, caso você queira fazer um ajuste fino, a biblioteca <code><b>transformers</b></code> facilita muito essa tarefa.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como os modelos de linguagem são enormes hoje em dia, retreiná-los é quase impossível em uma GPU que qualquer pessoa pode ter em casa, portanto, vamos retreinar um modelo menor. Nesse caso, vamos treinar novamente o <code><b>bert-base-cased</b></code>, que é um modelo de 109 milhões de parâmetros.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Conjunto-de-dados">
						<a class="anchor-link" href="#Conjunto-de-dados">
							<p style="margin-left: 20px">Conjunto de dados</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Precisamos fazer download de um conjunto de dados e, para isso, usamos a biblioteca <code><b>datasets</b></code> da Hugging Face. Vamos usar o conjunto de dados de avaliações do Yelp.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">datasets</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">load_dataset</span></p>
<p></p>
<p><span style="color: #6b97e8;">dataset</span> <span>=</span> <span style="color: #6b97e8;">load_dataset</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;yelp_review_full&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos ver como é o conjunto de dados.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #dfd84a;">type</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>datasets.dataset_dict.DatasetDict</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Parece ser um tipo de dicionário, vamos ver quais chaves ele tem.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dataset</span><span>.</span><span style="color: #6b97e8;">keys</span><span style="color: #e3e11d;">()</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>dict_keys(['train', 'test'])</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos ver quantas avaliações ele tem em cada subconjunto.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">]),</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;test&quot;</span><span style="color: #e3e11d;">])</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>(650000, 50000)</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos dar uma olhada em um exemplo</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">100</span><span style="color: #e3e11d;">]</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{'label': 0,</p><p> 'text': 'My expectations for McDonalds are t rarely high. But for one to still fail so spectacularly...that takes something special!\\nThe cashier took my friends\'s order, then promptly ignored me. I had to force myself in front of a cashier who opened his register to wait on the person BEHIND me. I waited over five minutes for a gigantic order that included precisely one kid\'s meal. After watching two people who ordered after me be handed their food, I asked where mine was. The manager started yelling at the cashiers for \\"serving off their orders\\" when they didn\'t have their food. But neither cashier was anywhere near those controls, and the manager was the one serving food to customers and clearing the boards.\\nThe manager was rude when giving me my order. She didn\'t make sure that I had everything ON MY RECEIPT, and never even had the decency to apologize that I felt I was getting poor service.\\nI\'ve eaten at various McDonalds restaurants for over 30 years. I\'ve worked at more than one location. I expect bad days, bad moods, and the occasional mistake. But I have yet to have a decent experience at this store. It will remain a place I avoid unless someone in my party needs to avoid illness from low blood sugar. Perhaps I should go back to the racially biased service of Steak n Shake instead!'}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como podemos ver, cada amostra tem o texto e a pontuação, vamos ver quantos tipos existem</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">clases</span> <span>=</span> <span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">features</span></p>
<p><span style="color: #6b97e8;">clases</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{'label': ClassLabel(names=['1 star', '2 star', '3 stars', '4 stars', '5 stars'], id=None),</p><p> 'text': Value(dtype='string', id=None)}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vemos que ele tem 5 classes diferentes</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">num_classes</span> <span>=</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">clases</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;label&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">names</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">num_classes</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>5</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos dar uma olhada em um exemplo de teste</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;test&quot;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">100</span><span style="color: #e3e11d;">]</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{'label': 0,</p><p> 'text': 'This was just bad pizza.  For the money I expect that the toppings will be cooked on the pizza.  The cheese and pepparoni were added after the crust came out.  Also the mushrooms were out of a can.  Do not waste money here.'}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como o objetivo desta postagem não é treinar o melhor modelo, mas explicar a biblioteca <code><b>transformers</b></code> do Hugging Face, vamos criar um pequeno subconjunto para treinar mais rapidamente.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">small_train_dataset</span> <span>=</span> <span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">shuffle</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">seed</span><span>=</span><span style="color: #7e7a38;">42</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">select</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a38;">1000</span><span style="color: #e3e11d;">))</span></p>
<p><span style="color: #6b97e8;">small_eval_dataset</span> <span>=</span> <span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;test&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">shuffle</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">seed</span><span>=</span><span style="color: #7e7a38;">42</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">select</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a38;">500</span><span style="color: #e3e11d;">))</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Tokenização">
						<a class="anchor-link" href="#Tokenização">
							<p style="margin-left: 20px">Tokenização</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Já temos o conjunto de dados, como vimos no pipeline, primeiro é feita a tokenização e depois o modelo é aplicado. Portanto, temos que tokenizar o conjunto de dados.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Definimos o tokenizador</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;bert-base-cased&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A classe <code><b>AutoTokenizer</b></code> tem um método chamado <code><b>map</b></code> que nos permite aplicar uma função ao conjunto de dados, portanto, vamos criar uma função que tokenize o texto.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">tokenize_function</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">examples</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">examples</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;text&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">truncation</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_length</span><span>=</span><span style="color: #7e7a38;">3</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como podemos ver, no momento, fizemos a tokenização truncando apenas 3 tokens, para que possamos ver melhor o que está acontecendo embaixo.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Usamos o método <code><b>map</b></code> para usar a função que acabamos de definir no conjunto de dados.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenized_small_train_dataset</span> <span>=</span> <span style="color: #6b97e8;">small_train_dataset</span><span>.</span><span style="color: #6b97e8;">map</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokenize_function</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">batched</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenized_small_eval_dataset</span> <span>=</span> <span style="color: #6b97e8;">small_eval_dataset</span><span>.</span><span style="color: #6b97e8;">map</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokenize_function</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">batched</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vemos exemplos do conjunto de dados tokenizado</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenized_small_train_dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">100</span><span style="color: #e3e11d;">]</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{'label': 3,</p><p> 'text': "I recently brough my car up to Edinburgh from home, where it had sat on the drive pretty much since I had left home to go to university.\\n\\nAs I'm sure you can imagine, it was pretty filthy, so I pulled up here expecting to shell out \\u00a35 or so for a crappy was that wouldnt really be that great.\\n\\nNeedless to say, when I realised that the cheapest was was \\u00a32, i was suprised and I was even more suprised when the car came out looking like a million dollars.\\n\\nVery impressive for \\u00a32, but thier prices can go up to around \\u00a36 - which I'm sure must involve so many polishes and waxes and cleans that dirt must be simply repelled from the body of your car, never getting dirty again.",</p><p> 'input_ids': [101, 146, 102],</p><p> 'token_type_ids': [0, 0, 0],</p><p> 'attention_mask': [1, 1, 1]}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenized_small_eval_dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">100</span><span style="color: #e3e11d;">]</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{'label': 4,</p><p> 'text': 'Had a great dinner at Elephant Bar last night! \\n\\nGot a coupon in the mail for 2 meals and an appetizer for $20! While they did limit the  selections you could get with the coupon, we were happy with the choices so it worked out fine.\\n\\nFood was delicious and the service was fantastic! Waitress was very attentive and polite.\\n\\nLocation was a plus too! Had a lovely walk around The District shops afterward. \\n\\nAll and all, a hands down 5 stars!',</p><p> 'input_ids': [101, 6467, 102],</p><p> 'token_type_ids': [0, 0, 0],</p><p> 'attention_mask': [1, 1, 1]}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como podemos ver, uma chave foi adicionada com os <code><b>input_ids</b></code> dos tokens, os <code><b>token_type_ids</b></code> e outra com a <code><b>máscara de atenção</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora, fazemos a tokenização truncando para 20 tokens a fim de usar uma GPU pequena.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">tokenize_function</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">examples</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">examples</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;text&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">truncation</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_length</span><span>=</span><span style="color: #7e7a38;">20</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenized_small_train_dataset</span> <span>=</span> <span style="color: #6b97e8;">small_train_dataset</span><span>.</span><span style="color: #6b97e8;">map</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokenize_function</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">batched</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenized_small_eval_dataset</span> <span>=</span> <span style="color: #6b97e8;">small_eval_dataset</span><span>.</span><span style="color: #6b97e8;">map</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokenize_function</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">batched</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Modelo">
						<a class="anchor-link" href="#Modelo">
							<p style="margin-left: 20px">Modelo</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Temos que criar o modelo que vamos treinar novamente. Como se trata de um problema de classificação, usaremos o <code><b>AutoModelForSequenceClassification</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoModelForSequenceClassification</span></p>
<p></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForSequenceClassification</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;bert-base-cased&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_labels</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-cased and are newly initialized: ['classifier.bias', 'classifier.weight']</p><p>You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Como pode ser visto, foi criado um modelo que classifica entre 5 classes</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Métricas-de-avaliação">
						<a class="anchor-link" href="#Métricas-de-avaliação">
							<p style="margin-left: 20px">Métricas de avaliação</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Criamos uma métrica de avaliação com a biblioteca Hugging Face <code><b>evaluate</b></code>. Para instalá-la, usamos</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 80px;"><code>pip install evaluate<br></code></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">numpy</span> <span style="color: #a04cc1;">as</span> <span style="color: #4fcd7d;">np</span></p>
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">evaluate</span></p>
<p></p>
<p><span style="color: #6b97e8;">metric</span> <span>=</span> <span style="color: #6b97e8;">evaluate</span><span>.</span><span style="color: #6b97e8;">load</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;accuracy&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">compute_metrics</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">eval_pred</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">labels</span> <span>=</span> <span style="color: #6b97e8;">eval_pred</span></p>
<p>    <span style="color: #6b97e8;">predictions</span> <span>=</span> <span style="color: #6b97e8;">np</span><span>.</span><span style="color: #6b97e8;">argmax</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">axis</span><span>=-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">metric</span><span>.</span><span style="color: #6b97e8;">compute</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">predictions</span><span>=</span><span style="color: #6b97e8;">predictions</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">references</span><span>=</span><span style="color: #6b97e8;">labels</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Treinador">
						<a class="anchor-link" href="#Treinador">
							<p style="margin-left: 20px">Treinador</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora, para o treinamento, usamos o objeto <code><b>Trainer</b></code>. Para usar o <code><b>Trainer</b></code>, precisamos de <code><b>accelerate>=0.21.0</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 80px;"><code>pip install accelerate>=0.21.0<br></code></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Antes de criar o treinador, precisamos criar um <code><b>TrainingArguments</b></code>, que é um objeto que contém todos os argumentos que o <code><b>Trainer</b></code> precisa para o treinamento, ou seja, os hiperparâmetros</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Um argumento obrigatório deve ser passado, <code><b>output_dir</b></code>, que é o diretório de saída onde as previsões do modelo e os pontos de verificação, como a Hugging Face chama os pesos do modelo, serão gravados.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Também transmitimos uma série de outros argumentos</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">
						<ul>
							<li><code><b>per_device_train_batch_size</b></code>: tamanho do lote por dispositivo para o treinamento</li>
							<li><code><b>per_device_eval_batch_size</b></code>: tamanho do lote por dispositivo para a avaliação</li>
							<li><code><b>learning_rate</b></code>: taxa de aprendizado</li>
							<li><code><b>num_train_epochs</b></code>: número de épocas</li>
						</ul>
					</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">TrainingArguments</span></p>
<p></p>
<p><span style="color: #6b97e8;">training_args</span> <span>=</span> <span style="color: #6b97e8;">TrainingArguments</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">output_dir</span><span>=</span><span style="color: #7e7a34;">&quot;test_trainer&quot;</span><span style="color: #e3e11d;">,</span> </p>
<p>    <span style="color: #6b97e8;">per_device_train_batch_size</span><span>=</span><span style="color: #7e7a38;">16</span><span style="color: #e3e11d;">,</span> </p>
<p>    <span style="color: #6b97e8;">per_device_eval_batch_size</span><span>=</span><span style="color: #7e7a38;">32</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">learning_rate</span><span>=</span><span style="color: #a09e19;">1e-4</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">num_train_epochs</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos dar uma olhada em todos os hiperparâmetros que ele configura</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">training_args</span><span>.</span><span style="color: #7f6e38;">__dict__</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{'output_dir': 'test_trainer',</p><p> 'overwrite_output_dir': False,</p><p> 'do_train': False,</p><p> 'do_eval': False,</p><p> 'do_predict': False,</p><p> 'evaluation_strategy': &lt;IntervalStrategy.NO: 'no'&gt;,</p><p> 'prediction_loss_only': False,</p><p> 'per_device_train_batch_size': 16,</p><p> 'per_device_eval_batch_size': 32,</p><p> 'per_gpu_train_batch_size': None,</p><p> 'per_gpu_eval_batch_size': None,</p><p> 'gradient_accumulation_steps': 1,</p><p> 'eval_accumulation_steps': None,</p><p> 'eval_delay': 0,</p><p> 'learning_rate': 0.0001,</p><p> 'weight_decay': 0.0,</p><p> 'adam_beta1': 0.9,</p><p> 'adam_beta2': 0.999,</p><p> 'adam_epsilon': 1e-08,</p><p> 'max_grad_norm': 1.0,</p><p> 'num_train_epochs': 5,</p><p> 'max_steps': -1,</p><p> 'lr_scheduler_type': &lt;SchedulerType.LINEAR: 'linear'&gt;,</p><p> 'lr_scheduler_kwargs': {},</p><p> 'warmup_ratio': 0.0,</p><p> 'warmup_steps': 0,</p><p> 'log_level': 'passive',</p><p> 'log_level_replica': 'warning',</p><p> 'log_on_each_node': True,</p><p> 'logging_dir': 'test_trainer/runs/Mar08_16-41-27_SAEL00531',</p><p> 'logging_strategy': &lt;IntervalStrategy.STEPS: 'steps'&gt;,</p><p> 'logging_first_step': False,</p><p> 'logging_steps': 500,</p><p> 'logging_nan_inf_filter': True,</p><p> 'save_strategy': &lt;IntervalStrategy.STEPS: 'steps'&gt;,</p><p> 'save_steps': 500,</p><p> 'save_total_limit': None,</p><p> 'save_safetensors': True,</p><p> 'save_on_each_node': False,</p><p> 'save_only_model': False,</p><p> 'no_cuda': False,</p><p> 'use_cpu': False,</p><p> 'use_mps_device': False,</p><p> 'seed': 42,</p><p> 'data_seed': None,</p><p> 'jit_mode_eval': False,</p><p> 'use_ipex': False,</p><p> 'bf16': False,</p><p> 'fp16': False,</p><p> 'fp16_opt_level': 'O1',</p><p> 'half_precision_backend': 'auto',</p><p> 'bf16_full_eval': False,</p><p> 'fp16_full_eval': False,</p><p> 'tf32': None,</p><p> 'local_rank': 0,</p><p> 'ddp_backend': None,</p><p> 'tpu_num_cores': None,</p><p> 'tpu_metrics_debug': False,</p><p> 'debug': [],</p><p> 'dataloader_drop_last': False,</p><p> 'eval_steps': None,</p><p> 'dataloader_num_workers': 0,</p><p> 'dataloader_prefetch_factor': None,</p><p> 'past_index': -1,</p><p> 'run_name': 'test_trainer',</p><p> 'disable_tqdm': False,</p><p> 'remove_unused_columns': True,</p><p> 'label_names': None,</p><p> 'load_best_model_at_end': False,</p><p> 'metric_for_best_model': None,</p><p> 'greater_is_better': None,</p><p> 'ignore_data_skip': False,</p><p> 'fsdp': [],</p><p> 'fsdp_min_num_params': 0,</p><p> 'fsdp_config': {'min_num_params': 0,</p><p>  'xla': False,</p><p>  'xla_fsdp_v2': False,</p><p>  'xla_fsdp_grad_ckpt': False},</p><p> 'fsdp_transformer_layer_cls_to_wrap': None,</p><p> 'accelerator_config': AcceleratorConfig(split_batches=False, dispatch_batches=None, even_batches=True, use_seedable_sampler=True),</p><p> 'deepspeed': None,</p><p> 'label_smoothing_factor': 0.0,</p><p> 'optim': &lt;OptimizerNames.ADAMW_TORCH: 'adamw_torch'&gt;,</p><p> 'optim_args': None,</p><p> 'adafactor': False,</p><p> 'group_by_length': False,</p><p> 'length_column_name': 'length',</p><p> 'report_to': [],</p><p> 'ddp_find_unused_parameters': None,</p><p> 'ddp_bucket_cap_mb': None,</p><p> 'ddp_broadcast_buffers': None,</p><p> 'dataloader_pin_memory': True,</p><p> 'dataloader_persistent_workers': False,</p><p> 'skip_memory_metrics': True,</p><p> 'use_legacy_prediction_loop': False,</p><p> 'push_to_hub': False,</p><p> 'resume_from_checkpoint': None,</p><p> 'hub_model_id': None,</p><p> 'hub_strategy': &lt;HubStrategy.EVERY_SAVE: 'every_save'&gt;,</p><p> 'hub_token': None,</p><p> 'hub_private_repo': False,</p><p> 'hub_always_push': False,</p><p> 'gradient_checkpointing': False,</p><p> 'gradient_checkpointing_kwargs': None,</p><p> 'include_inputs_for_metrics': False,</p><p> 'fp16_backend': 'auto',</p><p> 'push_to_hub_model_id': None,</p><p> 'push_to_hub_organization': None,</p><p> 'push_to_hub_token': None,</p><p> 'mp_parameters': '',</p><p> 'auto_find_batch_size': False,</p><p> 'full_determinism': False,</p><p> 'torchdynamo': None,</p><p> 'ray_scope': 'last',</p><p> 'ddp_timeout': 1800,</p><p> 'torch_compile': False,</p><p> 'torch_compile_backend': None,</p><p> 'torch_compile_mode': None,</p><p> 'dispatch_batches': None,</p><p> 'split_batches': None,</p><p> 'include_tokens_per_second': False,</p><p> 'include_num_input_tokens_seen': False,</p><p> 'neftune_noise_alpha': None,</p><p> 'distributed_state': Distributed environment: DistributedType.NO</p><p> Num processes: 1</p><p> Process index: 0</p><p> Local process index: 0</p><p> Device: cuda,</p><p> '_n_gpu': 1,</p><p> '__cached__setup_devices': device(type='cuda', index=0),</p><p> 'deepspeed_plugin': None}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora, criamos um objeto <code><b>Trainer</b></code> que será responsável pelo treinamento do modelo.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Trainer</span></p>
<p></p>
<p><span style="color: #6b97e8;">trainer</span> <span>=</span> <span style="color: #6b97e8;">Trainer</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">train_dataset</span><span>=</span><span style="color: #6b97e8;">tokenized_small_train_dataset</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">eval_dataset</span><span>=</span><span style="color: #6b97e8;">tokenized_small_eval_dataset</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">compute_metrics</span><span>=</span><span style="color: #6b97e8;">compute_metrics</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">args</span><span>=</span><span style="color: #6b97e8;">training_args</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando tivermos um <code><b>Trainer</b></code>, no qual indicamos o conjunto de dados de treinamento, o conjunto de dados de teste, o modelo, a métrica de avaliação e os argumentos do hiperparâmetro, poderemos treinar o modelo com o método <code><b>train</b></code> do <code><b>Trainer</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">trainer</span><span>.</span><span style="color: #6b97e8;">train</span><span style="color: #e3e11d;">()</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>TrainOutput(global_step=315, training_loss=0.9347671750992064, metrics={'train_runtime': 52.3517, 'train_samples_per_second': 95.508, 'train_steps_per_second': 6.017, 'train_loss': 0.9347671750992064, 'epoch': 5.0})</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Já temos o modelo treinado, como você pode ver, com muito pouco código, podemos treinar um modelo muito rapidamente.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Recomendo enfaticamente que você aprenda o Pytorch e treine muitos modelos antes de usar uma biblioteca de alto nível como a <code><b>transformers</b></code>, porque você aprende muitos fundamentos de aprendizagem profunda e pode entender melhor o que está acontecendo, especialmente porque aprenderá muito com seus erros. Mas, depois de passar por esse período, o uso de bibliotecas de alto nível, como a <code><b>transformers</b></code>, acelera muito o desenvolvimento.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Testando-o-modelo">
						<a class="anchor-link" href="#Testando-o-modelo">
							<p style="margin-left: 20px">Testando o modelo</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora que temos o modelo treinado, vamos testá-lo com um texto. Como o conjunto de dados que baixamos é de avaliações em inglês, vamos testá-lo com uma avaliação em inglês.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pipeline</span></p>
<p></p>
<p><span style="color: #6b97e8;">clasificator</span> <span>=</span> <span style="color: #6b97e8;">pipeline</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;text-classification&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span>=</span><span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">clasification</span> <span>=</span> <span style="color: #6b97e8;">clasificator</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;I&#39;m liking this post a lot&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">clasification</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>[{'label': 'LABEL_2', 'score': 0.5032550692558289}]</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vamos ver a que corresponde a classe que surgiu</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">clases</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>{'label': ClassLabel(names=['1 star', '2 star', '3 stars', '4 stars', '5 stars'], id=None),</p><p> 'text': Value(dtype='string', id=None)}</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">A relação seria</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"> </p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">
						<ul>
							<li>LABEL_0: 1 estrela</li>
							<li>LABEL_1: 2 estrelas</li>
							<li>LABEL_2: 3 estrelas</li>
							<li>LABEL_3: 4 estrelas</li>
							<li>LABEL_4: 5 estrelas</li>
						</ul>
					</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Portanto, você classificou o comentário com 3 estrelas. Lembre-se de que treinamos em um subconjunto de dados e com apenas 5 épocas, portanto, não esperamos que seja muito bom.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Compartilhe-o-modelo-no-Hub-do-Rosto-de-Abraço">
						<a class="anchor-link" href="#Compartilhe-o-modelo-no-Hub-do-Rosto-de-Abraço">
							<p style="margin-left: 10px">Compartilhe o modelo no Hub do Rosto de Abraço</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Quando tivermos o modelo retreinado, poderemos carregá-lo em nosso espaço no Hugging Face Hub para que outros possam usá-lo. Para fazer isso, você precisa ter uma conta no Hugging Face.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Registro-em-log">
						<a class="anchor-link" href="#Registro-em-log">
							<p style="margin-left: 20px">Registro em log</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para fazer upload do modelo, primeiro precisamos fazer login.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Isso pode ser feito por meio do terminal com</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 80px;"><code>huggingface-cli login<br></code></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Ou por meio do notebook, tendo instalado primeiro a biblioteca <code><b>huggingface_hub</b></code> com</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 80px;"><code>pip install huggingface_hub<br></code></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Agora, podemos fazer login com a função <code><b>notebook_login</b></code>, que criará uma pequena interface gráfica na qual devemos inserir um token Hugging Face.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Para criar um token, acesse a página <a href="https://huggingface.co/settings/tokens" target="_blank">setings/tokens</a> de sua conta, que terá a seguinte aparência</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">User-Access-Token-dark](http://maximofn.com/wp-content/uploads/2024/03/User-Access-Token-dark.png)</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Clique em <code><b>New token</b></code> e será exibida uma janela para criar um novo token.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"><p align="center"><img src="http://maximofn.com/wp-content/uploads/2024/03/new-token-dark.png" alt="new-token-dark"></p></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Nomeamos o token e o criamos com a função <code><b>write</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Uma vez criado, nós o copiamos</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">huggingface_hub</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">notebook_login</span></p>
<p></p>
<p><span style="color: #6b97e8;">notebook_login</span><span style="color: #e3e11d;">()</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>VBox(children=(HTML(value='&lt;center&gt; &lt;img\nsrc=https://huggingface.co/front/assets/huggingface_logo-noborder.sv…</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Para-cima-depois-de-treinado">
						<a class="anchor-link" href="#Para-cima-depois-de-treinado">
							<p style="margin-left: 20px">Para cima depois de treinado</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Depois de treinar o modelo, podemos carregá-lo no Hub usando a função <code><b>push_to_hub</b></code>. Essa função tem um parâmetro obrigatório que é o nome do modelo, que deve ser exclusivo; se já houver um modelo em seu Hub com esse nome, ele não será carregado. Ou seja, o nome completo do modelo será <user>/<model>, portanto, o nome do modelo não pode existir em seu Hub, mesmo que haja outro modelo com o mesmo nome no Hub de outro usuário.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Ele também tem outros parâmetros opcionais, mas interessantes:</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">
						<ul>
							<li><code><b>use_temp_dir</b></code> (bool, opcional): se deve ou não ser usado um diretório temporário para armazenar arquivos salvos antes de serem enviados ao Hub. O padrão é True se não houver um diretório com o mesmo nome de <code><b>repo_id</b></code> e False caso contrário.</li>
							<li><code><b>commit_message</b></code> (str, opcional): mensagem de confirmação. O padrão é <code><b>Upload {object}</b></code>.</li>
							<li><code><b>private</b></code> (bool, opcional): se o repositório criado deve ser privado ou não.</li>
							<li><code><b>token</b></code> (bool ou str, opcional): O token a ser usado como autorização HTTP para arquivos remotos. Se for True, será usado o token gerado pela execução do login <code><b>huggingface-cli</b></code> (armazenado em ~/.huggingface). O padrão é True se <code><b>repo_url</b></code> não for especificado.</li>
							<li><code><b>max_shard_size</b></code> (int ou str, opcional, o padrão é "5GB"): Aplicável somente a modelos. O tamanho máximo de um ponto de verificação antes de ser fragmentado. Os pontos de verificação fragmentados serão cada um menor que esse tamanho. Se for expresso como uma cadeia de caracteres, deverá ter dígitos seguidos de uma unidade (como "5MB"). O padrão é "5 GB" para que os usuários possam carregar facilmente modelos em instâncias de nível gratuito do Google Colab sem problemas de OOM (falta de memória) da CPU.</li>
							<li><code><b>create_pr</b></code> (bool, opcional, o padrão é False): se deve ou não criar um PR com os arquivos carregados ou fazer o commit diretamente.</li>
							<li><code><b>safe_serialization</b></code> (bool, opcional, o padrão é True): Se os pesos do modelo devem ou não ser convertidos para o formato safetensors para uma serialização mais segura.</li>
							<li><code><b>revision</b></code> (str, opcional): filial para a qual enviar os arquivos carregados.</li>
							<li><code><b>commit_description</b></code> (str, opcional): Descrição do commit a ser criado</li>
							<li><code><b>tags</b></code> (List[str], opcional): Lista de tags a serem inseridas no Hub.</li>
						</ul>
					</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">

				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">push_to_hub</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #7e7a34;">&quot;bert-base-cased_notebook_transformers_5-epochs_yelp_review_subset&quot;</span><span style="color: #e3e11d;">,</span> </p>
<p>    <span style="color: #6b97e8;">commit_message</span><span>=</span><span style="color: #7e7a34;">&quot;bert base cased fine tune on yelp review subset&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">commit_description</span><span>=</span><span style="color: #7e7a34;">&quot;Fine-tuned on a subset of the yelp review dataset. Model retrained for post of transformers library. 5 epochs.&quot;</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>CommitInfo(commit_url='https://huggingface.co/Maximofn/bert-base-cased_notebook_transformers_5-epochs_yelp_review_subset/commit/033a3c759d5a4e314ce76db81bd113b4f7da69ad', commit_message='bert base cased fine tune on yelp review subset', commit_description='Fine-tuned on a subset of the yelp review dataset. Model retrained for post of transformers library. 5 epochs.', oid='033a3c759d5a4e314ce76db81bd113b4f7da69ad', pr_url=None, pr_revision=None, pr_num=None)</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Se formos agora ao nosso Hub, veremos que o modelo foi carregado.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"><p align="center"><img src="http://maximofn.com/wp-content/uploads/2024/03/transformers_commit_unico.webp" alt="transformers_commit_unique"></p></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Se agora entrarmos no cartão de modelo para ver</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">transformers_commit_inico_model_card](http://maximofn.com/wp-content/uploads/2024/03/transformers_commit_inico_model_card-scaled.webp)</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Vemos que tudo não está preenchido, faremos isso mais tarde.</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h3 id="Levantar-durante-o-treinamento">
						<a class="anchor-link" href="#Levantar-durante-o-treinamento">
							<p style="margin-left: 20px">Levantar durante o treinamento</p>
						</a>
					</h3>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Outra opção é fazer o upload enquanto estivermos treinando o modelo. Isso é muito útil quando treinamos modelos por muitos períodos e isso leva muito tempo, pois se o treinamento for interrompido (porque o computador está desligado, a sessão de colaboração terminou, os créditos da nuvem acabaram), o trabalho não será perdido. Para fazer isso, você deve adicionar <code><b>push_to_hub=True</b></code> em <code><b>TrainingArguments</b></code>.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">training_args</span> <span>=</span> <span style="color: #6b97e8;">TrainingArguments</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">output_dir</span><span>=</span><span style="color: #7e7a34;">&quot;bert-base-cased_notebook_transformers_30-epochs_yelp_review_subset&quot;</span><span style="color: #e3e11d;">,</span> </p>
<p>    <span style="color: #6b97e8;">per_device_train_batch_size</span><span>=</span><span style="color: #7e7a38;">16</span><span style="color: #e3e11d;">,</span> </p>
<p>    <span style="color: #6b97e8;">per_device_eval_batch_size</span><span>=</span><span style="color: #7e7a38;">32</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">learning_rate</span><span>=</span><span style="color: #a09e19;">1e-4</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">num_train_epochs</span><span>=</span><span style="color: #7e7a38;">30</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">push_to_hub</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">trainer</span> <span>=</span> <span style="color: #6b97e8;">Trainer</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">train_dataset</span><span>=</span><span style="color: #6b97e8;">tokenized_small_train_dataset</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">eval_dataset</span><span>=</span><span style="color: #6b97e8;">tokenized_small_eval_dataset</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">compute_metrics</span><span>=</span><span style="color: #6b97e8;">compute_metrics</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">args</span><span>=</span><span style="color: #6b97e8;">training_args</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Podemos ver que alteramos as épocas para 30, de modo que o treinamento será mais demorado, portanto, adicionar <code><b>push_to_hub=True</b></code> fará o upload do modelo para o nosso Hub durante o treinamento.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Também alteramos o <code><b>output_dir</b></code> porque esse é o nome que o modelo terá no Hub.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">trainer</span><span>.</span><span style="color: #6b97e8;">train</span><span style="color: #e3e11d;">()</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>TrainOutput(global_step=1890, training_loss=0.07100234655318437, metrics={'train_runtime': 331.5804, 'train_samples_per_second': 90.476, 'train_steps_per_second': 5.7, 'train_loss': 0.07100234655318437, 'epoch': 30.0})</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Se olharmos novamente para o nosso hub, o novo modelo aparecerá.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;"></p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">transformers_commit_training](http://maximofn.com/wp-content/uploads/2024/03/transformers_commit_training.webp)</p>
				</div>
			</div>
		</div>
	</div>
	<!-- Open div header -->
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<h2 id="Hub-como-repositório-git">
						<a class="anchor-link" href="#Hub-como-repositório-git">
							<p style="margin-left: 10px">Hub como repositório git</p>
						</a>
					</h2>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">No Hugging Face, os modelos, os espaços e os conjuntos de dados são repositórios git, portanto, você pode trabalhar com eles dessa forma. Ou seja, você pode clonar, bifurcar, fazer solicitações pull, etc.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing text_cell rendered">
		<div class="prompt input_prompt">
			<div class="inner_cell">
				<div class="text_cell_render border-box-sizing rendered_html">
					<p style="margin-left: 0px;">Mas outra grande vantagem disso é que você pode usar um modelo em uma versão específica.</p>
				</div>
			</div>
		</div>
	</div>
	<div class="cell border-box-sizing code_cell rendered">
		<div class="input">
			<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
			<div class="inner_cell">
				<div class="input_area">
					<div class=" highlight hl-python3">
						<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoModelForSequenceClassification</span></p>
<p></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">AutoModelForSequenceClassification</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;bert-base-cased&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_labels</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">revision</span><span>=</span><span style="color: #7e7a34;">&quot;393e083&quot;</span><span style="color: #e3e11d;">)</span></p>
						</pre>
					</div>
				</div>
			</div>
		</div>
		<div class="output_wrapper">
			<div class="output">
				<div class="output_area">
					<div class="prompt" style="margin-left: 20px;">Output:</div>
					<div class="output_subarea output_stream output_stdout output_text">
						<pre style="margin-left: 60px; line-height: 0%;"><p>Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-cased and are newly initialized: ['classifier.bias', 'classifier.weight']</p><p>You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</p></pre>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- Close class contenido -->
</div>
<!-- Close div notebook container -->
</div>
<!-- Close div notebook -->
</div>

