<p>
	<!-- Custom stylesheet, it must be in the same directory as the html file -->
	<!-- Loading mathjax macro --><!-- Load mathjax --><!-- MathJax configuration -->
<p>
<style>
	/* Media query para pantallas grandes */
	@media screen and (min-width: 1000px) {
		.container {
			flex-wrap: nowrap;
			display: flex;
			justify-content: space-between;
			height: 100vh; /* altura del viewport */
		}
		
		.indice {
			width: 25%; /* Ancho del índice en pantallas grandes */
			border-right: 1px solid #ccc;
			max-height: calc(100vh - 40px); /* Ajustar según tus necesidades. Aquí estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
		
		.contenido {
			width: 70%; /* Ancho del contenido en pantallas grandes */
			max-height: calc(100vh - 40px); /* Ajustar según tus necesidades. Aquí estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
	}
</style>
<!-- Open div notebook -->
<div id="notebook" class="border-box-sizing" tabindex="-1">
	<!-- Open div notebook container -->
	<div id="notebook-container" class="container">
		<!-- Open div indice -->
		<div class="indice">
			<!-- Open div index header -->
			<div class="cell border-box-sizing text_cell rendered">
				<h2 class="prompt input_prompt">
					<span style="
					color: var(--darkreader-text--heading-color, var(--darkreader-text--heading-2-color,
					var(--darkreader-text--headings-color)));
					font-family: var(--fontFamily); font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-color: var(--darkreader-text--darkreader-text--heading-color,
					var(--darkreader-text--darkreader-text--heading-2-color, var(--darkreader-text--darkreader-text--headings-color)));
					--darkreader-inline-bgcolor: transparent;"
					data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">
						Índice
					</span>
					<a class="anchor-link" style="
					font-family: var(--fontFamily);
					font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-bgcolor: transparent;"
					href="#Índice" data-darkreader-inline-bgcolor="">
					</a>
				</h2>
			<!-- Close div index header -->
			</div>
			<!-- Index body -->
			<div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Tokenization-index">
									<a class="anchor-link" href="#Tokenization">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Tokenization</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Token-viewer-index">
									<a class="anchor-link" href="#Token-viewer">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Token viewer</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
			</div>
		<!-- Close div indice -->
		</div>
 
		<!-- Content -->
		<div class="contenido">
		<div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;"><a href="https://colab.research.google.com/github/maximofn/portafolio/blob/main/posts/notebooks_translated/2024-06-04-BPE-tokenizer_EN.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h1 id="BPE-tokenizer">
								<a class="anchor-link" href="#BPE-tokenizer">
									<p style="margin-left: 0px">BPE tokenizer</p>
								</a>
							</h1>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">The <code><b>BPE</b></code> (Byte Pair Encoding) tokenizer is a data compression algorithm used to create a vocabulary of subwords from a corpus of text. This algorithm is based on the frequency of byte pairs in the text. It became popular because it was used as a tokenizer by LLMs such as GPT, GPT-2, RoBERTa, BART and DeBERTa.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">This notebook has been automatically translated to make it accessible to more people, please let me know if you see any typos.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">## Training algorithm</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Suppose we have a text corpus containing only the following words <code><b>hug, pug, pun, bun and hugs</b></code>, the first step is to create a vocabulary with all the characters present in the corpus, in our case it will be <code><b>b, g, h, n, p, s, u</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">corpus_words</span> <span>=</span> <span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;hug&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;pug&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;pun&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;bun&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;hugs&quot;</span><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Concatenate all the words in the corpus</span></p>
<p><span style="color: #6b97e8;">initial_corpus_tokens</span> <span>=</span> <span style="color: #7e7a34;">&quot;&quot;</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">word</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">corpus_words</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #6b97e8;">initial_corpus_tokens</span> <span>+=</span> <span style="color: #6b97e8;">word</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Convert the concatenated string to a set of tokens to get unique tokens</span></p>
<p><span style="color: #6b97e8;">initial_corpus_tokens</span> <span>=</span> <span style="color: #dfd84a;">set</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Corpus words: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">corpus_words</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Initial corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of initial corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Corpus words: ['hug', 'pug', 'pun', 'bun', 'hugs']</p><p>Initial corpus tokens: {'p', 'n', 'u', 's', 'h', 'g', 'b'}</p><p>Number of initial corpus tokens: 7</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now let's suppose that this is our corpus of sentences, it is an invented corpus, it does not make sense</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">corpus</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug hug hug pun pun bun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug hug pug pug pun pun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug hug pug pug pun pun pun pun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;pug pun pun pun bun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug hug hug pun bun bun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">]</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Let's count the number of times each word appears in the corpus, to check that what we had put before is correct.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">num_hug</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">num_pug</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">num_pun</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">num_bun</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">num_hugs</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">sentence</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">corpus</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #6b97e8;">words</span> <span>=</span> <span style="color: #6b97e8;">sentence</span><span>.</span><span style="color: #6b97e8;">split</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot; &quot;</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">word</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">words</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;hug&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_hug</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">elif</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;pug&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_pug</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">elif</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;pun&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_pun</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">elif</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;bun&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_bun</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">elif</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;hugs&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_hugs</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of hug: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">num_hug</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of pug: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">num_pug</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of pun: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">num_pun</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of bun: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">num_bun</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of hugs: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">num_hugs</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Number of hug: 10</p><p>Number of pug: 5</p><p>Number of pun: 12</p><p>Number of bun: 4</p><p>Number of hugs: 5</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Everything we have told you is fine, we can go on</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We will create a dictionary with the tokens of each word and the number of times it appears in the corpus.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span> <span>=</span> <span style="color: #e3e11d;">{</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_hug</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;hug&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #7e7a34;">&quot;pug&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_pug</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;pug&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #7e7a34;">&quot;pun&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_pun</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;pun&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #7e7a34;">&quot;bun&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_bun</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;bun&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #7e7a34;">&quot;hugs&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_hugs</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;hugs&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p><span style="color: #e3e11d;">}</span></p>
<p></p>
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'hug': {'count': 10, 'tokens': ['h', 'u', 'g']},</p><p> 'pug': {'count': 5, 'tokens': ['p', 'u', 'g']},</p><p> 'pun': {'count': 12, 'tokens': ['p', 'u', 'n']},</p><p> 'bun': {'count': 4, 'tokens': ['b', 'u', 'n']},</p><p> 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's']}}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now let's look for the pair of consecutive tokens that appears most often in the dictionary</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dict_keys</span> <span>=</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span>.</span><span style="color: #6b97e8;">keys</span><span style="color: #e3e11d;">()</span></p>
<p></p>
<p><span style="color: #6b97e8;">list_consecutive_tokens</span> <span>=</span> <span style="color: #e3e11d;">[]</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">key</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">enumerate</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_keys</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #7f6e38;"># Get the tokens of the word</span></p>
<p>    <span style="color: #6b97e8;">number_of_toneks_of_word</span> <span>=</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">])</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># Get consecituve tokens</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">j</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">number_of_toneks_of_word</span><span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #7f6e38;"># Get consecutive tokens</span></p>
<p>        <span style="color: #6b97e8;">consecutive_tokens</span> <span>=</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">][</span><span style="color: #6b97e8;">j</span><span style="color: #e3e11d;">]</span> <span>+</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">][</span><span style="color: #6b97e8;">j</span><span>+</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span></p>
<p>        <span style="color: #7f6e38;"># Append the consecutive tokens to the list the number of times the word appears</span></p>
<p>        <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">_</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">]):</span></p>
<p>            <span style="color: #6b97e8;">list_consecutive_tokens</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">consecutive_tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #7f6e38;"># Print the list of consecutive tokens</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;List of consecutive tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">list_consecutive_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Get consecutive tokens with maximum frequency</span></p>
<p><span style="color: #6b97e8;">dict_consecutive_tokens</span> <span>=</span> <span style="color: #e3e11d;">{}</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">list_consecutive_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #7f6e38;"># Check if the token is already in the dictionary</span></p>
<p>    <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #7f6e38;"># Increment the count of the token</span></p>
<p>        <span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">]</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>    </p>
<p>    <span style="color: #7f6e38;"># If the token is not in the dictionary</span></p>
<p>    <span style="color: #a04cc1;">else</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #7f6e38;"># Add the token to the dictionary</span></p>
<p>        <span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">]</span> <span>=</span> <span style="color: #7e7a38;">1</span></p>
<p><span style="color: #7f6e38;"># Print the dictionary of consecutive tokens</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Dictionary of consecutive tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Get the consecutive token with maximum frequency</span></p>
<p><span style="color: #6b97e8;">max_consecutive_token</span> <span>=</span> <span style="color: #7f6e38;">None</span></p>
<p><span style="color: #a04cc1;">while</span> <span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #7f6e38;"># Get the token with maximum frequency</span></p>
<p>    <span style="color: #6b97e8;">consecutive_token</span> <span>=</span> <span style="color: #dfd84a;">max</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">key</span><span>=</span><span style="color: #6b97e8;">dict_consecutive_tokens</span><span>.</span><span style="color: #6b97e8;">get</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># Check if the token is already in the list of tokens</span></p>
<p>    <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">consecutive_token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #7f6e38;"># Remove token from the dictionary</span></p>
<p>        <span style="color: #6b97e8;">dict_consecutive_tokens</span><span>.</span><span style="color: #6b97e8;">pop</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># If the token is not in the list of tokens</span></p>
<p>    <span style="color: #a04cc1;">else</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #7f6e38;"># Assign the token to the max_consecutive_token</span></p>
<p>        <span style="color: #6b97e8;">max_consecutive_token</span> <span>=</span> <span style="color: #6b97e8;">consecutive_token</span></p>
<p>        <span style="color: #a04cc1;">break</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Print the consecutive token with maximum frequency</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Consecutive token with maximum frequency: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>List of consecutive tokens: ['hu', 'hu', 'hu', 'hu', 'hu', 'hu', 'hu', 'hu', 'hu', 'hu', 'ug', 'ug', 'ug', 'ug', 'ug', 'ug', 'ug', 'ug', 'ug', 'ug', 'pu', 'pu', 'pu', 'pu', 'pu', 'ug', 'ug', 'ug', 'ug', 'ug', 'pu', 'pu', 'pu', 'pu', 'pu', 'pu', 'pu', 'pu', 'pu', 'pu', 'pu', 'pu', 'un', 'un', 'un', 'un', 'un', 'un', 'un', 'un', 'un', 'un', 'un', 'un', 'bu', 'bu', 'bu', 'bu', 'un', 'un', 'un', 'un', 'hu', 'hu', 'hu', 'hu', 'hu', 'ug', 'ug', 'ug', 'ug', 'ug', 'gs', 'gs', 'gs', 'gs', 'gs']</p><p>Dictionary of consecutive tokens: {'hu': 15, 'ug': 20, 'pu': 17, 'un': 16, 'bu': 4, 'gs': 5}</p><p>Consecutive token with maximum frequency: ug</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We have obtained the pair of tokens that appears the most times. We are going to encapsulate this in a function because we are going to use it more times.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">get_consecutive_tokens_with_max_frequency</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">list_corpus_tokens</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">dict_keys</span> <span>=</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span>.</span><span style="color: #6b97e8;">keys</span><span style="color: #e3e11d;">()</span></p>
<p></p>
<p>    <span style="color: #6b97e8;">list_consecutive_tokens</span> <span>=</span> <span style="color: #e3e11d;">[]</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">key</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">enumerate</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_keys</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #7f6e38;"># Get the tokens of the word</span></p>
<p>        <span style="color: #6b97e8;">number_of_toneks_of_word</span> <span>=</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">])</span></p>
<p></p>
<p>        <span style="color: #7f6e38;"># Get consecituve tokens</span></p>
<p>        <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">j</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">number_of_toneks_of_word</span><span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">):</span></p>
<p>            <span style="color: #7f6e38;"># Get consecutive tokens</span></p>
<p>            <span style="color: #6b97e8;">consecutive_tokens</span> <span>=</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">][</span><span style="color: #6b97e8;">j</span><span style="color: #e3e11d;">]</span> <span>+</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">][</span><span style="color: #6b97e8;">j</span><span>+</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span></p>
<p>            <span style="color: #7f6e38;"># Append the consecutive tokens to the list</span></p>
<p>            <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">_</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">]):</span></p>
<p>                <span style="color: #6b97e8;">list_consecutive_tokens</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">consecutive_tokens</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># Get consecutive tokens with maximum frequency</span></p>
<p>    <span style="color: #6b97e8;">dict_consecutive_tokens</span> <span>=</span> <span style="color: #e3e11d;">{}</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">list_consecutive_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #7f6e38;"># Check if the token is already in the dictionary</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #7f6e38;"># Increment the count of the token</span></p>
<p>            <span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">]</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        </p>
<p>        <span style="color: #7f6e38;"># If the token is not in the dictionary</span></p>
<p>        <span style="color: #a04cc1;">else</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #7f6e38;"># Add the token to the dictionary</span></p>
<p>            <span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">]</span> <span>=</span> <span style="color: #7e7a38;">1</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># Get the consecutive token with maximum frequency</span></p>
<p>    <span style="color: #6b97e8;">max_consecutive_token</span> <span>=</span> <span style="color: #7f6e38;">None</span></p>
<p>    <span style="color: #a04cc1;">while</span> <span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #7f6e38;"># Get the token with maximum frequency</span></p>
<p>        <span style="color: #6b97e8;">consecutive_token</span> <span>=</span> <span style="color: #dfd84a;">max</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_consecutive_tokens</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">key</span><span>=</span><span style="color: #6b97e8;">dict_consecutive_tokens</span><span>.</span><span style="color: #6b97e8;">get</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>        <span style="color: #7f6e38;"># Check if the token is already in the list of tokens</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">consecutive_token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">list_corpus_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #7f6e38;"># Remove token from the dictionary</span></p>
<p>            <span style="color: #6b97e8;">dict_consecutive_tokens</span><span>.</span><span style="color: #6b97e8;">pop</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>        <span style="color: #7f6e38;"># If the token is not in the list of tokens</span></p>
<p>        <span style="color: #a04cc1;">else</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #7f6e38;"># Assign the token to the max_consecutive_token</span></p>
<p>            <span style="color: #6b97e8;">max_consecutive_token</span> <span>=</span> <span style="color: #6b97e8;">consecutive_token</span></p>
<p>            <span style="color: #a04cc1;">break</span></p>
<p></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">max_consecutive_token</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We check that we get the same as before</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">max_consecutive_token</span> <span>=</span> <span style="color: #6b97e8;">get_consecutive_tokens_with_max_frequency</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Consecutive token with maximum frequency: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Consecutive token with maximum frequency: ug</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We see that yes</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now our token corpus can be modified by adding the token <code><b>ug</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #7f6e38;"># new_corpus_tokens = initial_corpus_tokens + max_consecutive_token</span></p>
<p><span style="color: #6b97e8;">new_corpus_tokens</span> <span>=</span> <span style="color: #6b97e8;">initial_corpus_tokens</span><span>.</span><span style="color: #6b97e8;">copy</span><span style="color: #e3e11d;">()</span></p>
<p><span style="color: #6b97e8;">new_corpus_tokens</span><span>.</span><span style="color: #6b97e8;">add</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Initial corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">new_corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Initial corpus tokens: {'p', 'n', 'u', 's', 'h', 'g', 'b'}</p><p>New corpus tokens: {'p', 'n', 'ug', 'g', 'b', 'u', 's', 'h'}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We also put this in a function</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">get_new_corpus_tokens</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">new_corpus_tokens</span> <span>=</span> <span style="color: #6b97e8;">initial_corpus_tokens</span><span>.</span><span style="color: #6b97e8;">copy</span><span style="color: #e3e11d;">()</span></p>
<p>    <span style="color: #6b97e8;">new_corpus_tokens</span><span>.</span><span style="color: #6b97e8;">add</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">new_corpus_tokens</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We will check again that we obtain the same as before</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">new_corpus_tokens</span> <span>=</span> <span style="color: #6b97e8;">get_new_corpus_tokens</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Initial corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">new_corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Initial corpus tokens: {'p', 'n', 'u', 's', 'h', 'g', 'b'}</p><p>New corpus tokens: {'p', 'n', 'ug', 'g', 'b', 'u', 's', 'h'}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We see that yes</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now we are going to modify the dictionary where the words appear, the tokens and the number of times they appear with the new token</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">copy</span></p>
<p></p>
<p><span style="color: #6b97e8;">dict_keys</span> <span>=</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span>.</span><span style="color: #6b97e8;">keys</span><span style="color: #e3e11d;">()</span></p>
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance_tmp</span> <span>=</span> <span style="color: #6b97e8;">copy</span><span>.</span><span style="color: #6b97e8;">deepcopy</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">key</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">dict_keys</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #7f6e38;"># Check if the new token is in the word</span></p>
<p>    <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">max_consecutive_token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Token </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;"> is in the word </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">key</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>        <span style="color: #7f6e38;"># Add the new token to the word tokens</span></p>
<p>        <span style="color: #6b97e8;">dict_tokens_by_word_appearance_tmp</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>        <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New tokens of the word </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">key</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance_tmp</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #8d783e;">&#39;tokens&#39;</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Initial tokens by word appearance: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New tokens by word appearance: &quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance_tmp</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug']},</p><p> 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug']},</p><p> 'pun': {'count': 12, 'tokens': ['p', 'u', 'n']},</p><p> 'bun': {'count': 4, 'tokens': ['b', 'u', 'n']},</p><p> 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug']}}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We put this in a function</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">update_tokens_by_word_appearance</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">dict_tokens_by_word_appearance_tmp</span> <span>=</span> <span style="color: #6b97e8;">copy</span><span>.</span><span style="color: #6b97e8;">deepcopy</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #6b97e8;">dict_keys</span> <span>=</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance_tmp</span><span>.</span><span style="color: #6b97e8;">keys</span><span style="color: #e3e11d;">()</span></p>
<p></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">key</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">dict_keys</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #7f6e38;"># Check if the new token is in the word</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">max_consecutive_token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #7f6e38;"># Add the new token to the word tokens</span></p>
<p>            <span style="color: #6b97e8;">dict_tokens_by_word_appearance_tmp</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">key</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">dict_tokens_by_word_appearance_tmp</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We check that it is OK</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span> <span>=</span> <span style="color: #6b97e8;">update_tokens_by_word_appearance</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New tokens by word appearance: &quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug']},</p><p> 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug']},</p><p> 'pun': {'count': 12, 'tokens': ['p', 'u', 'n']},</p><p> 'bun': {'count': 4, 'tokens': ['b', 'u', 'n']},</p><p> 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug']}}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">In summary, in a first iteration, we have gone from a corpus of tokens <code><b>s, g, h, u, n, p, b</b></code> to the new corpus of tokens <code><b>h, u, n, p, s, g, b, ug</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We now perform a second iteration, obtaining the pair of consecutive tokens that appears most often in the dictionary.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">max_consecutive_token</span> <span>=</span> <span style="color: #6b97e8;">get_consecutive_tokens_with_max_frequency</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">new_corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Consecutive token with maximum frequency: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Consecutive token with maximum frequency: pu</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We obtain the new corpus of tokens</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">corpus_tokens</span> <span>=</span> <span style="color: #6b97e8;">get_new_corpus_tokens</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">new_corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Initial corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">new_corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Initial corpus tokens: {'p', 'n', 'ug', 'g', 'b', 'u', 's', 'h'}</p><p>New corpus tokens: {'p', 'n', 'pu', 'u', 's', 'h', 'ug', 'g', 'b'}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">And we obtain the new dictionary in which the words, tokens and the number of times they appear are displayed.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span> <span>=</span> <span style="color: #6b97e8;">update_tokens_by_word_appearance</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New tokens by word appearance: &quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug']},</p><p> 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug', 'pu']},</p><p> 'pun': {'count': 12, 'tokens': ['p', 'u', 'n', 'pu']},</p><p> 'bun': {'count': 4, 'tokens': ['b', 'u', 'n']},</p><p> 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug']}}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now we can continue until we have a corpus of tokens with the size we want, let's create a corpus of 15 tokens.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">len_corpus_tokens</span> <span>=</span> <span style="color: #7e7a38;">15</span></p>
<p></p>
<p><span style="color: #a04cc1;">while</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span> <span>&lt;</span> <span style="color: #6b97e8;">len_corpus_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #6b97e8;">max_consecutive_token</span> <span>=</span> <span style="color: #6b97e8;">get_consecutive_tokens_with_max_frequency</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Consecutive token with maximum frequency: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># If there are no more consecutive tokens break the loop</span></p>
<p>    <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">max_consecutive_token</span> <span style="color: #7f6e38;">is</span> <span style="color: #7f6e38;">None</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #a04cc1;">break</span></p>
<p></p>
<p>    <span style="color: #6b97e8;">corpus_tokens</span> <span>=</span> <span style="color: #6b97e8;">get_new_corpus_tokens</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span> <span>=</span> <span style="color: #6b97e8;">update_tokens_by_word_appearance</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New tokens by word appearance: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #3b75c2;">}</span><span style="color: #a6a831;">\n</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Consecutive token with maximum frequency: un</p><p>New corpus tokens: {'p', 'n', 'pu', 'un', 'u', 's', 'h', 'ug', 'g', 'b'}</p><p>New tokens by word appearance: {'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug']}, 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug', 'pu']}, 'pun': {'count': 12, 'tokens': ['p', 'u', 'n', 'pu', 'un']}, 'bun': {'count': 4, 'tokens': ['b', 'u', 'n', 'un']}, 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug']}}</p><p>Consecutive token with maximum frequency: hu</p><p>New corpus tokens: {'p', 'hu', 'n', 'pu', 'un', 'u', 's', 'h', 'ug', 'g', 'b'}</p><p>New tokens by word appearance: {'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug', 'hu']}, 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug', 'pu']}, 'pun': {'count': 12, 'tokens': ['p', 'u', 'n', 'pu', 'un']}, 'bun': {'count': 4, 'tokens': ['b', 'u', 'n', 'un']}, 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug', 'hu']}}</p><p>Consecutive token with maximum frequency: gug</p><p>New corpus tokens: {'p', 'hu', 'n', 'pu', 'un', 'gug', 'u', 's', 'h', 'ug', 'g', 'b'}</p><p>New tokens by word appearance: {'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug', 'hu']}, 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug', 'pu']}, 'pun': {'count': 12, 'tokens': ['p', 'u', 'n', 'pu', 'un']}, 'bun': {'count': 4, 'tokens': ['b', 'u', 'n', 'un']}, 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug', 'hu']}}</p><p>Consecutive token with maximum frequency: ughu</p><p>New corpus tokens: {'p', 'hu', 'n', 'pu', 'un', 'gug', 'u', 's', 'h', 'ughu', 'ug', 'g', 'b'}</p><p>New tokens by word appearance: {'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug', 'hu']}, 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug', 'pu']}, 'pun': {'count': 12, 'tokens': ['p', 'u', 'n', 'pu', 'un']}, 'bun': {'count': 4, 'tokens': ['b', 'u', 'n', 'un']}, 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug', 'hu']}}</p><p>Consecutive token with maximum frequency: npu</p><p>New corpus tokens: {'p', 'hu', 'n', 'npu', 'pu', 'un', 'gug', 'u', 's', 'h', 'ughu', 'ug', 'g', 'b'}</p><p>New tokens by word appearance: {'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug', 'hu']}, 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug', 'pu']}, 'pun': {'count': 12, 'tokens': ['p', 'u', 'n', 'pu', 'un']}, 'bun': {'count': 4, 'tokens': ['b', 'u', 'n', 'un']}, 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug', 'hu']}}</p><p>Consecutive token with maximum frequency: puun</p><p>New corpus tokens: {'p', 'hu', 'n', 'npu', 'pu', 'un', 'gug', 'puun', 'u', 's', 'h', 'ughu', 'ug', 'g', 'b'}</p><p>New tokens by word appearance: {'hug': {'count': 10, 'tokens': ['h', 'u', 'g', 'ug', 'hu']}, 'pug': {'count': 5, 'tokens': ['p', 'u', 'g', 'ug', 'pu']}, 'pun': {'count': 12, 'tokens': ['p', 'u', 'n', 'pu', 'un']}, 'bun': {'count': 4, 'tokens': ['b', 'u', 'n', 'un']}, 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's', 'ug', 'hu']}}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now that we have seen how to train the BPE tokenizer, let's train it from scratch to consolidate our knowledge.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">corpus_words</span> <span>=</span> <span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;hug&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;pug&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;pun&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;bun&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a34;">&quot;hugs&quot;</span><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Concatenate all the words in the corpus</span></p>
<p><span style="color: #6b97e8;">initial_corpus_tokens</span> <span>=</span> <span style="color: #7e7a34;">&quot;&quot;</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">word</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">corpus_words</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #6b97e8;">initial_corpus_tokens</span> <span>+=</span> <span style="color: #6b97e8;">word</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Convert the concatenated string to a set of tokens to get unique tokens</span></p>
<p><span style="color: #6b97e8;">corpus_tokens</span> <span>=</span> <span style="color: #dfd84a;">set</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">initial_corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Corpus words: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">corpus_words</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Initial corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of initial corpus tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Corpus words: ['hug', 'pug', 'pun', 'bun', 'hugs']</p><p>Initial corpus tokens: {'p', 'n', 'u', 's', 'h', 'g', 'b'}</p><p>Number of initial corpus tokens: 7</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">corpus</span> <span>=</span> <span style="color: #e3e11d;">[</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug hug hug pun pun bun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug hug pug pug pun pun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug hug pug pug pun pun pun pun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;pug pun pun pun bun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug hug hug pun bun bun hugs&quot;</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">num_hug</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">num_pug</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">num_pun</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">num_bun</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">num_hugs</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">sentence</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">corpus</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #6b97e8;">words</span> <span>=</span> <span style="color: #6b97e8;">sentence</span><span>.</span><span style="color: #6b97e8;">split</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot; &quot;</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">word</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">words</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;hug&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_hug</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">elif</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;pug&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_pug</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">elif</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;pun&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_pun</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">elif</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;bun&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_bun</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">elif</span> <span style="color: #6b97e8;">word</span> <span>==</span> <span style="color: #7e7a34;">&quot;hugs&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">num_hugs</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p></p>
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span> <span>=</span> <span style="color: #e3e11d;">{</span></p>
<p>    <span style="color: #7e7a34;">&quot;hug&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_hug</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;hug&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #7e7a34;">&quot;pug&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_pug</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;pug&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #7e7a34;">&quot;pun&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_pun</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;pun&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #7e7a34;">&quot;bun&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_bun</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;bun&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p>    <span style="color: #7e7a34;">&quot;hugs&quot;</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #e3e11d;">{</span></p>
<p>            <span style="color: #7e7a34;">&quot;count&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">num_hugs</span><span style="color: #e3e11d;">,</span></p>
<p>            <span style="color: #7e7a34;">&quot;tokens&quot;</span><span style="color: #e3e11d;">:</span> <span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">character</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">character</span> <span style="color: #7f6e38;">in</span> <span style="color: #7e7a34;">&quot;hugs&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>        <span style="color: #e3e11d;">},</span></p>
<p><span style="color: #e3e11d;">}</span></p>
<p></p>
<p><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'hug': {'count': 10, 'tokens': ['h', 'u', 'g']},</p><p> 'pug': {'count': 5, 'tokens': ['p', 'u', 'g']},</p><p> 'pun': {'count': 12, 'tokens': ['p', 'u', 'n']},</p><p> 'bun': {'count': 4, 'tokens': ['b', 'u', 'n']},</p><p> 'hugs': {'count': 5, 'tokens': ['h', 'u', 'g', 's']}}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We train it from scratch to obtain a corpus of 15 tokens.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">len_corpus_tokens</span> <span>=</span> <span style="color: #7e7a38;">15</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Initial corpus tokens: (</span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">) </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #a04cc1;">while</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span> <span>&lt;</span> <span style="color: #6b97e8;">len_corpus_tokens</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #6b97e8;">max_consecutive_token</span> <span>=</span> <span style="color: #6b97e8;">get_consecutive_tokens_with_max_frequency</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># If there are no more consecutive tokens break the loop</span></p>
<p>    <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">max_consecutive_token</span> <span style="color: #7f6e38;">is</span> <span style="color: #7f6e38;">None</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #a04cc1;">break</span></p>
<p></p>
<p>    <span style="color: #6b97e8;">corpus_tokens</span> <span>=</span> <span style="color: #6b97e8;">get_new_corpus_tokens</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #6b97e8;">dict_tokens_by_word_appearance</span> <span>=</span> <span style="color: #6b97e8;">update_tokens_by_word_appearance</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dict_tokens_by_word_appearance</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_consecutive_token</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;New corpus tokens: (</span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">) </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Initial corpus tokens: (7) {'p', 'n', 'u', 's', 'h', 'g', 'b'}</p><p>New corpus tokens: (15) {'p', 'hu', 'n', 'npu', 'pu', 'un', 'gug', 'puun', 'u', 's', 'h', 'ughu', 'ug', 'g', 'b'}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Tokenization">
								<a class="anchor-link" href="#Tokenization">
									<p style="margin-left: 10px">Tokenization</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">If we now wanted to tokenize, we would first have to create a vocabulary, that is, assign an ID to each token.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">vocab</span> <span>=</span> <span style="color: #e3e11d;">{}</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">enumerate</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">]</span> <span>=</span> <span style="color: #6b97e8;">i</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Vocabulary: &quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">vocab</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'p': 0,</p><p> 'hu': 1,</p><p> 'sug': 2,</p><p> 'npu': 3,</p><p> 'ugpu': 4,</p><p> 'gug': 5,</p><p> 'u': 6,</p><p> 'ug': 7,</p><p> 'ughu': 8,</p><p> 'n': 9,</p><p> 'pu': 10,</p><p> 'un': 11,</p><p> 'puun': 12,</p><p> 's': 13,</p><p> 'h': 14,</p><p> 'gs': 15,</p><p> 'g': 16,</p><p> 'b': 17}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We put it in a function</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">get_vocabulary</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">vocab</span> <span>=</span> <span style="color: #e3e11d;">{}</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">enumerate</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">]</span> <span>=</span> <span style="color: #6b97e8;">i</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">vocab</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Commitments that are well</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">vocab</span> <span>=</span> <span style="color: #6b97e8;">get_vocabulary</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">corpus_tokens</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Vocabulary: &quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">vocab</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'p': 0,</p><p> 'hu': 1,</p><p> 'sug': 2,</p><p> 'npu': 3,</p><p> 'ugpu': 4,</p><p> 'gug': 5,</p><p> 'u': 6,</p><p> 'ug': 7,</p><p> 'ughu': 8,</p><p> 'n': 9,</p><p> 'pu': 10,</p><p> 'un': 11,</p><p> 'puun': 12,</p><p> 's': 13,</p><p> 'h': 14,</p><p> 'gs': 15,</p><p> 'g': 16,</p><p> 'b': 17}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">If we now want to tokenize the word <code><b>bug</b></code> we can do the following</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">word</span> <span>=</span> <span style="color: #8d783e;">&#39;bug&#39;</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Get the maximum length of tokens</span></p>
<p><span style="color: #6b97e8;">max_len</span> <span>=</span> <span style="color: #dfd84a;">max</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">)</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Maximum length of tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">max_len</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Create a empty list of tokens</span></p>
<p><span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #e3e11d;">[]</span></p>
<p><span style="color: #a04cc1;">while</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">)</span> <span>&gt;</span> <span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #7f6e38;"># Flag to check if the token is found</span></p>
<p>    <span style="color: #6b97e8;">found</span> <span>=</span> <span style="color: #7f6e38;">False</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># Iterate over the maximum length of tokens from max_len to 0</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_len</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #7f6e38;"># Get the prefix of the word</span></p>
<p>        <span style="color: #6b97e8;">prefix</span> <span>=</span> <span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">[:</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">]</span></p>
<p>        <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Prefix: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">prefix</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>        <span style="color: #7f6e38;"># Check if the prefix is in the vocabulary</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">prefix</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;prefix </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">prefix</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;"> is in the vocabulary&quot;</span><span style="color: #e3e11d;">)</span></p>
<p>            <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">prefix</span><span style="color: #e3e11d;">)</span></p>
<p>            <span style="color: #6b97e8;">word</span> <span>=</span> <span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">:]</span></p>
<p>            <span style="color: #6b97e8;">found</span> <span>=</span> <span style="color: #7f6e38;">True</span></p>
<p>            <span style="color: #a04cc1;">break</span></p>
<p>    </p>
<p>    <span style="color: #7f6e38;"># if not found:</span></p>
<p>    <span style="color: #7f6e38;">#     tokens.append(&#39;&lt;UNK&gt;&#39;)</span></p>
<p>    <span style="color: #7f6e38;">#     word = word[1:]</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Maximum length of tokens: 4</p><p>Prefix: bug</p><p>Prefix: bug</p><p>Prefix: bu</p><p>Prefix: b</p><p>prefix b is in the vocabulary</p><p>Prefix: ug</p><p>prefix ug is in the vocabulary</p><p>Tokens: ['b', 'ug']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">But if now we want to tokenize the word <code><b>mug</b></code> we could not because the <code><b>m</b></code> character is not in the vocabulary, so we tokenize it with the token <code><b><UNK></b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">word</span> <span>=</span> <span style="color: #8d783e;">&#39;mug&#39;</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Get the maximum length of tokens</span></p>
<p><span style="color: #6b97e8;">max_len</span> <span>=</span> <span style="color: #dfd84a;">max</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">)</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Maximum length of tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">max_len</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #7f6e38;"># Create a empty list of tokens</span></p>
<p><span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #e3e11d;">[]</span></p>
<p><span style="color: #a04cc1;">while</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">)</span> <span>&gt;</span> <span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">:</span></p>
<p>    <span style="color: #7f6e38;"># Flag to check if the token is found</span></p>
<p>    <span style="color: #6b97e8;">found</span> <span>=</span> <span style="color: #7f6e38;">False</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># Iterate over the maximum length of tokens from max_len to 0</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_len</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #7f6e38;"># Get the prefix of the word</span></p>
<p>        <span style="color: #6b97e8;">prefix</span> <span>=</span> <span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">[:</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">]</span></p>
<p>        <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Prefix: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">prefix</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>        <span style="color: #7f6e38;"># Check if the prefix is in the vocabulary</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">prefix</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;prefix </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">prefix</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;"> is in the vocabulary&quot;</span><span style="color: #e3e11d;">)</span></p>
<p>            <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">prefix</span><span style="color: #e3e11d;">)</span></p>
<p>            <span style="color: #6b97e8;">word</span> <span>=</span> <span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">:]</span></p>
<p>            <span style="color: #6b97e8;">found</span> <span>=</span> <span style="color: #7f6e38;">True</span></p>
<p>            <span style="color: #a04cc1;">break</span></p>
<p></p>
<p>    <span style="color: #a04cc1;">if</span> <span style="color: #7f6e38;">not</span> <span style="color: #6b97e8;">found</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #8d783e;">&#39;&lt;UNK&gt;&#39;</span><span style="color: #e3e11d;">)</span></p>
<p>        <span style="color: #6b97e8;">word</span> <span>=</span> <span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">:]</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Tokens: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Maximum length of tokens: 4</p><p>Prefix: mug</p><p>Prefix: mug</p><p>Prefix: mu</p><p>Prefix: m</p><p>Prefix: ug</p><p>prefix ug is in the vocabulary</p><p>Tokens: ['&lt;UNK&gt;', 'ug']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We put it in a function</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">tokenize_word</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #7f6e38;"># Get the maximum length of tokens</span></p>
<p>    <span style="color: #6b97e8;">max_len</span> <span>=</span> <span style="color: #dfd84a;">max</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">token</span><span style="color: #e3e11d;">)</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">token</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>    <span style="color: #7f6e38;"># Create a empty list of tokens</span></p>
<p>    <span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #e3e11d;">[]</span></p>
<p>    <span style="color: #a04cc1;">while</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">)</span> <span>&gt;</span> <span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">:</span></p>
<p>        <span style="color: #7f6e38;"># Flag to check if the token is found</span></p>
<p>        <span style="color: #6b97e8;">found</span> <span>=</span> <span style="color: #7f6e38;">False</span></p>
<p></p>
<p>        <span style="color: #7f6e38;"># Iterate over the maximum length of tokens from max_len to 0</span></p>
<p>        <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_len</span><span style="color: #e3e11d;">,</span> <span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span> <span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">):</span></p>
<p>            <span style="color: #7f6e38;"># Get the prefix of the word</span></p>
<p>            <span style="color: #6b97e8;">prefix</span> <span>=</span> <span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">[:</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">]</span></p>
<p></p>
<p>            <span style="color: #7f6e38;"># Check if the prefix is in the vocabulary</span></p>
<p>            <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">prefix</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">:</span></p>
<p>                <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">prefix</span><span style="color: #e3e11d;">)</span></p>
<p>                <span style="color: #6b97e8;">word</span> <span>=</span> <span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">[</span><span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">:]</span></p>
<p>                <span style="color: #6b97e8;">found</span> <span>=</span> <span style="color: #7f6e38;">True</span></p>
<p>                <span style="color: #a04cc1;">break</span></p>
<p></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #7f6e38;">not</span> <span style="color: #6b97e8;">found</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #8d783e;">&#39;&lt;UNK&gt;&#39;</span><span style="color: #e3e11d;">)</span></p>
<p>            <span style="color: #6b97e8;">word</span> <span>=</span> <span style="color: #6b97e8;">word</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">:]</span></p>
<p></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">tokens</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">We check that it is OK</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Tokenization of the word &#39;bug&#39;: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokenize_word</span><span style="color: #e3e11d;">(</span><span style="color: #8d783e;">&#39;bug&#39;</span><span style="color: #e3e11d;">,</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Tokenization of the word &#39;mug&#39;: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">tokenize_word</span><span style="color: #e3e11d;">(</span><span style="color: #8d783e;">&#39;mug&#39;</span><span style="color: #e3e11d;">,</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">vocab</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Tokenization of the word 'bug': ['b', 'ug']</p><p>Tokenization of the word 'mug': ['&lt;UNK&gt;', 'ug']</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Token-viewer">
								<a class="anchor-link" href="#Token-viewer">
									<p style="margin-left: 10px">Token viewer</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Now that we know how a BPE tokenizer works, let's see through the <a href="https://huggingface.co/spaces/Xenova/the-tokenizer-playground" target="_blank">the-tokenizer-playground</a> visualizer how the tokens of any given statement would look like</p>
						</div>
					</div>
				</div>
			</div>
			<div>
				<iframe
					src="https://xenova-the-tokenizer-playground.static.hf.space"
					frameborder="0"
					width="1050"
					height="1050"
				></iframe>
			</div>
		</div>
	<!-- Close class contenido -->
	</div>
<!-- Close div notebook container -->
</div>
<!-- Close div notebook -->
</div>
