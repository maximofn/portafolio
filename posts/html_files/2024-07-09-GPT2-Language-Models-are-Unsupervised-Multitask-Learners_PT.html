<p>
	<!-- Custom stylesheet, it must be in the same directory as the html file -->
	<!-- Loading mathjax macro --><!-- Load mathjax --><!-- MathJax configuration -->
<p>
<style>
	/* Media query para pantallas grandes */
	@media screen and (min-width: 1000px) {
		.container {
			flex-wrap: nowrap;
			display: flex;
			justify-content: space-between;
			height: 100vh; /* altura del viewport */
		}
		
		.indice {
			width: 25%; /* Ancho del índice en pantallas grandes */
			border-right: 1px solid #ccc;
			max-height: calc(100vh - 40px); /* Ajustar según tus necesidades. Aquí estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
		
		.contenido {
			width: 70%; /* Ancho del contenido en pantallas grandes */
			max-height: calc(100vh - 40px); /* Ajustar según tus necesidades. Aquí estamos restando el doble del padding para mantener todo visible */
			padding: 20px;
			box-sizing: border-box;
			overflow-y: auto; /* desplazamiento vertical cuando sea necesario */
		}
	}
</style>
<!-- Open div notebook -->
<div id="notebook" class="border-box-sizing" tabindex="-1">
	<!-- Open div notebook container -->
	<div id="notebook-container" class="container">
		<!-- Open div indice -->
		<div class="indice">
			<!-- Open div index header -->
			<div class="cell border-box-sizing text_cell rendered">
				<h2 class="prompt input_prompt">
					<span style="
					color: var(--darkreader-text--heading-color, var(--darkreader-text--heading-2-color,
					var(--darkreader-text--headings-color)));
					font-family: var(--fontFamily); font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-color: var(--darkreader-text--darkreader-text--heading-color,
					var(--darkreader-text--darkreader-text--heading-2-color, var(--darkreader-text--darkreader-text--headings-color)));
					--darkreader-inline-bgcolor: transparent;"
					data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">
						Índice
					</span>
					<a class="anchor-link" style="
					font-family: var(--fontFamily);
					font-size: var(--fontSize);
					font-style: var(--fontStyle, inherit);
					font-weight: var(--fontWeight);
					letter-spacing: var(--letterSpacing);
					text-transform: var(--textTransform);
					background-color: transparent;
					--darkreader-inline-bgcolor: transparent;"
					href="#Índice" data-darkreader-inline-bgcolor="">
					</a>
				</h2>
			<!-- Close div index header -->
			</div>
			<!-- Index body -->
			<div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Papel-index">
									<a class="anchor-link" href="#Papel">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Papel</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Arquitetura-index">
									<a class="anchor-link" href="#Arquitetura">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Arquitetura</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Resumo-do-artigo-index">
									<a class="anchor-link" href="#Resumo-do-artigo">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Resumo do artigo</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Geração-de-texto-index">
									<a class="anchor-link" href="#Geração-de-texto">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Geração de texto</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Geração-de-texto-com-pipeline-index">
									<a class="anchor-link" href="#Geração-de-texto-com-pipeline">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Geração de texto com pipeline</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Geração-de-texto-com-modelo-automático-index">
									<a class="anchor-link" href="#Geração-de-texto-com-modelo-automático">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Geração de texto com modelo automático</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Gerar-token-para-o-texto-do-token-index">
									<a class="anchor-link" href="#Gerar-token-para-o-texto-do-token">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Gerar token para o texto do token</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Greedy-search-index">
									<a class="anchor-link" href="#Greedy-search">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Greedy search</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Arquitetura-dos-modelos-disponíveis-no-Hugging-Face-index">
									<a class="anchor-link" href="#Arquitetura-dos-modelos-disponíveis-no-Hugging-Face">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Arquitetura dos modelos disponíveis no Hugging Face</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="GPT2Model-index">
									<a class="anchor-link" href="#GPT2Model">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">GPT2Model</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="GPT2LMHeadModel-index">
									<a class="anchor-link" href="#GPT2LMHeadModel">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">GPT2LMHeadModel</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="GPT2ForSequenceClassification-index">
									<a class="anchor-link" href="#GPT2ForSequenceClassification">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">GPT2ForSequenceClassification</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="GPT2ForQuestionAnswering-index">
									<a class="anchor-link" href="#GPT2ForQuestionAnswering">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">GPT2ForQuestionAnswering</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="GPT2ForTokenClassification-index">
									<a class="anchor-link" href="#GPT2ForTokenClassification">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">GPT2ForTokenClassification</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h2 id="Ajuste-fino-do-GPT-2-index">
									<a class="anchor-link" href="#Ajuste-fino-do-GPT-2">
										<p style="margin-left: 0px; font-size: 12px; line-height: 1.5;">Ajuste fino do GPT-2</p>
									</a>
								</h2>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Ajuste-fino-para-geração-de-texto-index">
									<a class="anchor-link" href="#Ajuste-fino-para-geração-de-texto">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Ajuste fino para geração de texto</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Cálculo-de-perdas-index">
									<a class="anchor-link" href="#Cálculo-de-perdas">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Cálculo de perdas</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Conjunto-de-dados-index">
									<a class="anchor-link" href="#Conjunto-de-dados">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Conjunto de dados</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Instância-do-modelo-index">
									<a class="anchor-link" href="#Instância-do-modelo">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Instância do modelo</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Conjunto-de-dados-Pytorch-index">
									<a class="anchor-link" href="#Conjunto-de-dados-Pytorch">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Conjunto de dados Pytorch</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Dataloader-index">
									<a class="anchor-link" href="#Dataloader">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Dataloader</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Treinamento-index">
									<a class="anchor-link" href="#Treinamento">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Treinamento</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Inferência-index">
									<a class="anchor-link" href="#Inferência">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Inferência</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h3 id="Ajuste-fino-do-GPT-2-para-classificação-de-sentenças-index">
									<a class="anchor-link" href="#Ajuste-fino-do-GPT-2-para-classificação-de-sentenças">
										<p style="margin-left: 40px; font-size: 12px; line-height: 1.5;">Ajuste fino do GPT-2 para classificação de sentenças</p>
									</a>
								</h3>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Conjunto-de-dados-index">
									<a class="anchor-link" href="#Conjunto-de-dados">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Conjunto de dados</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Tokeniser-index">
									<a class="anchor-link" href="#Tokeniser">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Tokeniser</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Modelo-index">
									<a class="anchor-link" href="#Modelo">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Modelo</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Avaliação-index">
									<a class="anchor-link" href="#Avaliação">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Avaliação</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Trainer-index">
									<a class="anchor-link" href="#Trainer">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Trainer</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Treinamento-index">
									<a class="anchor-link" href="#Treinamento">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Treinamento</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
				<!-- Open div header -->
				<div class="cell border-box-sizing text_cell rendered">
					<div class="prompt input_prompt">
						<div class="inner_cell">
							<div class="text_cell_render border-box-sizing rendered_html">
								<h4 id="Inferência-index">
									<a class="anchor-link" href="#Inferência">
										<p style="margin-left: 80px; font-size: 12px; line-height: 1.5;">Inferência</p>
									</a>
								</h4>
							</div>
						</div>
					</div>
				</div>
			</div>
		<!-- Close div indice -->
		</div>
 
		<!-- Content -->
		<div class="contenido">
		<div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;"><a href="https://colab.research.google.com/github/maximofn/portafolio/blob/main/posts/notebooks_translated/2024-07-09-GPT2-Language-Models-are-Unsupervised-Multitask-Learners_PT.ipynb" target="_blank"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h1 id="GPT-2---Modelos-de-linguagem-são-aprendizes-multitarefa-não-supervisionados">
								<a class="anchor-link" href="#GPT-2---Modelos-de-linguagem-são-aprendizes-multitarefa-não-supervisionados">
									<p style="margin-left: 0px">GPT-2 - Modelos de linguagem são aprendizes multitarefa não supervisionados</p>
								</a>
							</h1>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Papel">
								<a class="anchor-link" href="#Papel">
									<p style="margin-left: 10px">Papel</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Este caderno foi traduzido automaticamente para torná-lo acessível a mais pessoas, por favor me avise se você vir algum erro de digitação..</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">[Language Models are Unsupervised Multitask Learners] (https://d4mucfpksywv.cloudfront.net/better-language-models/language-models.pdf) é o documento GPT-2. Essa é a segunda versão do modelo [GPT-1] (https://maximofn.com/gpt1/) que já vimos.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Arquitetura">
								<a class="anchor-link" href="#Arquitetura">
									<p style="margin-left: 10px">Arquitetura</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Antes de falarmos sobre a arquitetura da GPT-2, vamos nos lembrar de como era a arquitetura da GPT-1.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;"><p align="center"><img src="https://maximofn.com/wp-content/uploads/2024/06/GPT1_architecture.webp" alt="arquitetura gpt1"></p></p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Uma arquitetura baseada em transformador é usada no GPT-2, como no [GPT-1] (https://maximofn.com/gpt1/), com os seguintes tamanhos</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<table>
								<tr>
									<th>Parameters</th>
									<th>Layers</th>
									<th>d_model</th>
								</tr>
								<tr>
									<td>117M</td>
									<td> 12</td>
									<td> 768</td>
								</tr>
								<tr>
									<td> 345M</td>
									<td> 24</td>
									<td> 1024</td>
								</tr>
								<tr>
									<td> 762M</td>
									<td> 36</td>
									<td> 1280</td>
								</tr>
								<tr>
									<td> 1542M</td>
									<td> 48</td>
									<td> 1600</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">O modelo menor é equivalente ao GPT original, e o segundo modelo menor é equivalente ao modelo BERT maior. O modelo maior tem mais de uma ordem de magnitude de parâmetros a mais do que o GPT.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Além disso, foram feitas as seguintes modificações arquitetônicas</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Uma camada de normalização é adicionada antes do bloco de atenção. Isso pode ajudar a estabilizar o treinamento do modelo e melhorar a capacidade do modelo de aprender representações mais profundas. Ao normalizar as entradas para cada bloco, a variabilidade nas saídas é reduzida e o treinamento do modelo é facilitado.</li>
									<li>Uma normalização adicional foi adicionada após o bloco de autoatenção final. Isso pode ajudar a reduzir a variabilidade nos resultados do modelo e melhorar a estabilidade do modelo.</li>
									<li>Na maioria dos modelos, os pesos das camadas são inicializados aleatoriamente, seguindo uma distribuição normal ou uniforme. No entanto, no caso do GPT-2, os autores decidiram usar uma inicialização modificada que leva em conta a profundidade do modelo. A ideia por trás dessa inicialização modificada é que, à medida que o modelo se torna mais profundo, o sinal que flui pelas camadas residuais fica mais fraco. Isso ocorre porque cada camada residual é adicionada à entrada original, o que pode fazer com que o sinal seja atenuado com a profundidade do modelo. Para neutralizar esse efeito, eles decidiram dimensionar os pesos da camada residual na inicialização por um fator de 1/√N, em que N é o número de camadas residuais. Isso significa que, à medida que o modelo se torna mais profundo, os pesos das camadas residuais ficam menores. Esse truque de inicialização pode ajudar a estabilizar o treinamento do modelo e melhorar sua capacidade de aprender representações mais profundas. Ao dimensionar os pesos da camada residual, a variabilidade nas saídas de cada camada é reduzida e o fluxo de sinal pelo modelo é facilitado. Em resumo, a inicialização modificada na GPT-2 é usada para neutralizar o efeito de atenuação do sinal nas camadas residuais, o que ajuda a estabilizar o treinamento do modelo e a melhorar sua capacidade de aprender representações mais profundas.</li>
									<li>O tamanho do vocabulário foi ampliado para 50.257. Isso significa que o modelo pode aprender a representar um conjunto maior de palavras e tokens.</li>
									<li>O tamanho do contexto foi aumentado de 512 para 1024 tokens. Isso permite que o modelo leve em conta um contexto maior ao gerar o texto.</li>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Arquitetura GPT1 vs. GPT-2](https://maximofn.com/wp-content/uploads/2024/06/GPT1_vs_GPT2_architecture.webp)</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Resumo-do-artigo">
								<a class="anchor-link" href="#Resumo-do-artigo">
									<p style="margin-left: 10px">Resumo do artigo</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">As ideias mais interessantes do artigo são:</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Para o pré-treinamento do modelo, eles pensaram em usar uma fonte de texto diversificada e quase ilimitada, a raspagem da Web como Common Crawl. No entanto, eles descobriram que o texto era de qualidade quase muito ruim. Por isso, usaram o conjunto de dados WebText, que também era proveniente de raspagem da Web, mas com um filtro de qualidade, como a quantidade de links de saída do reddit etc. Eles também removeram o texto proveniente da Wikipédia, pois ele poderia ser repetido em outras páginas.</li>
									<li>Eles usaram um tokenizador BPE, que explicamos em uma [postagem] anterior (https://maximofn.com/bpe/).</li>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Geração-de-texto">
								<a class="anchor-link" href="#Geração-de-texto">
									<p style="margin-left: 10px">Geração de texto</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos ver como gerar texto com um GPT-2 pré-treinado.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para gerar o texto, usaremos o modelo do repositório [GPT-2] (https://huggingface.co/openai-community/gpt2) do Hugging Face.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Geração-de-texto-com-pipeline">
								<a class="anchor-link" href="#Geração-de-texto-com-pipeline">
									<p style="margin-left: 20px">Geração de texto com pipeline</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Com esse modelo, agora podemos usar o pipeline de transformadores.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">pipeline</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoints</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2-xl&quot;</span></p>
<p><span style="color: #6b97e8;">generator</span> <span>=</span> <span style="color: #6b97e8;">pipeline</span><span style="color: #e3e11d;">(</span><span style="color: #8d783e;">&#39;text-generation&#39;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">output</span> <span>=</span> <span style="color: #6b97e8;">generator</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;Hello, I&#39;m a language model,&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_length</span><span>=</span><span style="color: #7e7a38;">30</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_return_sequences</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">i</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">o</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">enumerate</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">output</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Output </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">i</span><span>+</span><span style="color: #7e7a38;">1</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">: </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">o</span><span style="color: #e3e11d;">[</span><span style="color: #8d783e;">&#39;generated_text&#39;</span><span style="color: #e3e11d;">]</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Output 1: Hello, I'm a language model, and I want to change the way you read</p><p>A little in today's post I want to talk about</p><p>Output 2: Hello, I'm a language model, with two roles: the language model and the lexicographer-semantics expert. The language models are going</p><p>Output 3: Hello, I'm a language model, and this is your brain. Here is your brain, and all this data that's stored in there, that</p><p>Output 4: Hello, I'm a language model, and I like to talk... I want to help you talk to your customers</p><p>Are you using language model</p><p>Output 5: Hello, I'm a language model, I'm gonna tell you about what type of language you're using. We all know a language like this,</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Geração-de-texto-com-modelo-automático">
								<a class="anchor-link" href="#Geração-de-texto-com-modelo-automático">
									<p style="margin-left: 20px">Geração de texto com modelo automático</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Mas se quisermos usar o <code><b>Automodel</b></code>, podemos fazer o seguinte</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">GPT2Tokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">AutoTokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoints</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2-xl&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">GPT2Tokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">auto_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Assim como no <a href="https://maximofn.com/gpt1/#Generaci%C3%B3n-de-texto" target="_blank">GPT-1</a>, podemos importar o <code><b>GPT2Tokenizer</b></code> e o <code><b>AutoTokenizer</b></code>. Isso ocorre porque no <a href="https://huggingface.co/openai-community/gpt2" target="_blank">model card</a> do GPT-2 diz para usar o <code><b>GPT2Tokenizer</b></code>, mas na postagem da biblioteca <a href="https://maximofn.com/hugging-face-transformers/" target="_blank">transformers</a> explicamos que você deve usar o <code><b>AutoTokenizer</b></code> para carregar o tokenizer. Portanto, vamos tentar os dois</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">checkpoints</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2-xl&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">GPT2Tokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">auto_tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_tokens</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;Hello, I&#39;m a language model,&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">input_auto_tokens</span> <span>=</span> <span style="color: #6b97e8;">auto_tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;Hello, I&#39;m a language model,&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input tokens: </span><span style="color: #a6a831;">\n</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;input auto tokens: </span><span style="color: #a6a831;">\n</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">input_auto_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>input tokens: </p><p>{'input_ids': tensor([[15496,    11,   314,  1101,   257,  3303,  2746,    11]]), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1]])}</p><p>input auto tokens: </p><p>{'input_ids': tensor([[15496,    11,   314,  1101,   257,  3303,  2746,    11]]), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1]])}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Como você pode ver, com os dois tokenizadores você obtém os mesmos tokens. Portanto, para tornar o código mais geral, de modo que, se você alterar os pontos de verificação, não precisará alterar o código, vamos usar o <code><b>AutoTokenizer</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Em seguida, criamos o dispositivo, o tokenizador e o modelo.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span></p>
<p></p>
<p><span style="color: #6b97e8;">device</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span> <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">cuda</span><span>.</span><span style="color: #6b97e8;">is_available</span><span style="color: #e3e11d;">()</span> <span style="color: #a04cc1;">else</span> <span style="color: #7e7a34;">&quot;cpu&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoints</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2-xl&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Como instanciamos o modelo, vamos ver quantos parâmetros ele tem</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">params</span> <span>=</span> <span style="color: #dfd84a;">sum</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">p</span><span>.</span><span style="color: #6b97e8;">numel</span><span style="color: #e3e11d;">()</span> <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">p</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">parameters</span><span style="color: #e3e11d;">())</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of parameters: </span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">round</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">params</span><span>/</span><span style="color: #a09e19;">1e6</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">M&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Number of parameters: 1558M</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Como podemos ver, carregamos o modelo de parâmetro 1.5B, mas se quiséssemos carregar os outros modelos, teríamos que fazer o seguinte</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">checkpoints_small</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2&quot;</span></p>
<p><span style="color: #6b97e8;">model_small</span> <span>=</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints_small</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of parameters of small model: </span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">round</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">sum</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">p</span><span>.</span><span style="color: #6b97e8;">numel</span><span style="color: #e3e11d;">()</span><span style="color: #7f6e38;"> </span><span style="color: #a04cc1;">for</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">p</span><span style="color: #7f6e38;"> </span><span style="color: #7f6e38;">in</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">model_small</span><span>.</span><span style="color: #6b97e8;">parameters</span><span style="color: #e3e11d;">())</span><span>/</span><span style="color: #a09e19;">1e6</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">M&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoints_medium</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2-medium&quot;</span></p>
<p><span style="color: #6b97e8;">model_medium</span> <span>=</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints_medium</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of parameters of medium model: </span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">round</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">sum</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">p</span><span>.</span><span style="color: #6b97e8;">numel</span><span style="color: #e3e11d;">()</span><span style="color: #7f6e38;"> </span><span style="color: #a04cc1;">for</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">p</span><span style="color: #7f6e38;"> </span><span style="color: #7f6e38;">in</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">model_medium</span><span>.</span><span style="color: #6b97e8;">parameters</span><span style="color: #e3e11d;">())</span><span>/</span><span style="color: #a09e19;">1e6</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">M&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoints_large</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2-large&quot;</span></p>
<p><span style="color: #6b97e8;">model_large</span> <span>=</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints_large</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of parameters of large model: </span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">round</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">sum</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">p</span><span>.</span><span style="color: #6b97e8;">numel</span><span style="color: #e3e11d;">()</span><span style="color: #7f6e38;"> </span><span style="color: #a04cc1;">for</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">p</span><span style="color: #7f6e38;"> </span><span style="color: #7f6e38;">in</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">model_large</span><span>.</span><span style="color: #6b97e8;">parameters</span><span style="color: #e3e11d;">())</span><span>/</span><span style="color: #a09e19;">1e6</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">M&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoints_xl</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2-xl&quot;</span></p>
<p><span style="color: #6b97e8;">model_xl</span> <span>=</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints_xl</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;Number of parameters of xl model: </span><span style="color: #3b75c2;">{</span><span style="color: #dfd84a;">round</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">sum</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">p</span><span>.</span><span style="color: #6b97e8;">numel</span><span style="color: #e3e11d;">()</span><span style="color: #7f6e38;"> </span><span style="color: #a04cc1;">for</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">p</span><span style="color: #7f6e38;"> </span><span style="color: #7f6e38;">in</span><span style="color: #7f6e38;"> </span><span style="color: #6b97e8;">model_xl</span><span>.</span><span style="color: #6b97e8;">parameters</span><span style="color: #e3e11d;">())</span><span>/</span><span style="color: #a09e19;">1e6</span><span style="color: #e3e11d;">)</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">M&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Number of parameters of small model: 124M</p><p>Number of parameters of medium model: 355M</p><p>Number of parameters of large model: 774M</p><p>Number of parameters of xl model: 1558M</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Criamos os tokens de entrada para o modelo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_sentence</span> <span>=</span> <span style="color: #7e7a34;">&quot;Hello, I&#39;m a language model,&quot;</span></p>
<p><span style="color: #6b97e8;">input_tokens</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">input_tokens</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'input_ids': tensor([[15496,    11,   314,  1101,   257,  3303,  2746,    11]],</p><p>       device='cuda:0'), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1, 1, 1]], device='cuda:0')}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Nós os passamos para o modelo para gerar os tokens de saída.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">output_tokens</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">input_tokens</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;output tokens: </span><span style="color: #a6a831;">\n</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">output_tokens</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>output tokens: </p><p>tensor([[15496,    11,   314,  1101,   257,  3303,  2746,    11,   290,   314,</p><p>          1101,  1016,   284,  1037,   345,   351,   534,  1917,    13,   198]],</p><p>       device='cuda:0')</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Decodificamos os tokens para obter a declaração de saída</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">decoded_output</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">output_tokens</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;decoded output: </span><span style="color: #a6a831;">\n</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">decoded_output</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>decoded output: </p><p>Hello, I'm a language model, and I'm going to help you with your problem.</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Já conseguimos gerar texto com o GPT-2</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Gerar-token-para-o-texto-do-token">
								<a class="anchor-link" href="#Gerar-token-para-o-texto-do-token">
									<p style="margin-left: 20px">Gerar token para o texto do token</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Greedy-search">
								<a class="anchor-link" href="#Greedy-search">
									<p style="margin-left: 30px">Greedy search</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Usamos o <code><b>model.generate</b></code> para gerar os tokens de saída de uma só vez, mas vamos ver como gerá-los um a um. Para fazer isso, em vez de usar <code><b>model.generate</b></code>, usaremos <code><b>model</b></code>, que, na verdade, chama o método <code><b>model.forward</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">outputs</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">input_tokens</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">outputs</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>CausalLMOutputWithCrossAttentions(loss=None, logits=tensor([[[ 6.6288,  5.1421, -0.8002,  ..., -6.3998, -4.4113,  1.8240],</p><p>         [ 2.7250,  1.9371, -1.2293,  ..., -5.0979, -5.1617,  2.2694],</p><p>         [ 2.6891,  4.3089, -1.6074,  ..., -7.6321, -2.0448,  0.4042],</p><p>         ...,</p><p>         [ 6.0513,  3.8020, -2.8080,  ..., -6.7754, -8.3176,  1.1541],</p><p>         [ 6.8402,  5.6952,  0.2002,  ..., -9.1281, -6.7818,  2.7576],</p><p>         [ 1.0255, -0.2201, -2.5484,  ..., -6.2137, -7.2322,  0.1665]]],</p><p>       device='cuda:0', grad_fn=&lt;UnsafeViewBackward0&gt;), past_key_values=((tensor([[[[ 0.4779,  0.7671, -0.7532,  ..., -0.3551,  0.4590,  0.3073],</p><p>          [ 0.2034, -0.6033,  0.2484,  ...,  0.7760, -0.3546,  0.0198],</p><p>          [-0.1968, -0.9029,  0.5570,  ...,  0.9985, -0.5028, -0.3508],</p><p>          ...,</p><p>          [-0.5007, -0.4009,  0.1604,  ..., -0.3693, -0.1158,  0.1320],</p><p>          [-0.4854, -0.1369,  0.7377,  ..., -0.8043, -0.1054,  0.0871],</p><p>          [ 0.1610, -0.8358, -0.5534,  ...,  0.9951, -0.3085,  0.4574]],</p><p>         [[ 0.6288, -0.1374, -0.3467,  ..., -1.0003, -1.1518,  0.3114],</p><p>          [-1.7269,  1.2920, -0.0734,  ...,  1.0572,  1.4698, -2.0412],</p><p>          [ 0.2714, -0.0670, -0.4769,  ...,  0.6305,  0.6890, -0.8158],</p><p>          ...,</p><p>          [-0.0499, -0.0721,  0.4580,  ...,  0.6797,  0.2331,  0.0210],</p><p>          [-0.1894,  0.2077,  0.6722,  ...,  0.6938,  0.2104, -0.0574],</p><p>          [ 0.3661, -0.0218,  0.2618,  ...,  0.8750,  1.2205, -0.6103]],</p><p>         [[ 0.5964,  1.1178,  0.3604,  ...,  0.8426,  0.4881, -0.4094],</p><p>          [ 0.3186, -0.3953,  0.2687,  ..., -0.1110, -0.5640,  0.5900],</p><p>          ...,</p><p>          [ 0.2092,  0.3898, -0.6061,  ..., -0.2859, -0.3136, -0.1002],</p><p>          [ 0.0539,  0.8941,  0.3423,  ..., -0.6326, -0.1053, -0.6679],</p><p>          [ 0.5628,  0.6687, -0.2720,  ..., -0.1073, -0.9792, -0.0302]]]],</p><p>       device='cuda:0', grad_fn=&lt;PermuteBackward0&gt;))), hidden_states=None, attentions=None, cross_attentions=None)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vemos que isso gera muitos dados, mas primeiro vamos dar uma olhada nas chaves de saída.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">keys</span><span style="color: #e3e11d;">()</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>odict_keys(['logits', 'past_key_values'])</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Nesse caso, temos apenas os logits do modelo, vamos ver seu tamanho.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">logits</span> <span>=</span> <span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">logits</span></p>
<p></p>
<p><span style="color: #6b97e8;">logits</span><span>.</span><span style="color: #6b97e8;">shape</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>torch.Size([1, 8, 50257])</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos ver quantos tokens tínhamos na entrada.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">input_tokens</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span>.</span><span style="color: #6b97e8;">shape</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>torch.Size([1, 8])</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Bem, temos o mesmo número de logits na saída e na entrada. Isso é normal</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Obtemos os logits da última posição da saída</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">nex_token_logits</span> <span>=</span> <span style="color: #6b97e8;">logits</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span><span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span></p>
<p></p>
<p><span style="color: #6b97e8;">nex_token_logits</span><span>.</span><span style="color: #6b97e8;">shape</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>torch.Size([50257])</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Há um total de 50257 logits, ou seja, há um vocabulário de 50257 tokens e temos que ver qual token tem a maior probabilidade.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">softmax_logits</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">softmax</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">nex_token_logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">dim</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">softmax_logits</span><span>.</span><span style="color: #6b97e8;">shape</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>torch.Size([50257])</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Depois de calcularmos o softmax, obtemos o token mais provável procurando aquele com a maior probabilidade, ou seja, aquele com o maior valor após o softmax.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">next_token_prob</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">next_token_id</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">max</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">softmax_logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">dim</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">next_token_prob</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">next_token_id</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>(tensor(0.1732, device='cuda:0', grad_fn=&lt;MaxBackward0&gt;),</p><p> tensor(290, device='cuda:0'))</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Obtivemos o seguinte token, agora vamos decodificá-lo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">next_token_id</span><span>.</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">())</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>' and'</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Obtivemos o seguinte token usando o método guloso, ou seja, o token com a maior probabilidade. Mas já vimos na postagem sobre a biblioteca de transformadores, a [ways to generate texts] (https://maximofn.com/hugging-face-transformers/#Formas-de-generaci%C3%B3n-de-texto) que você pode fazer <code><b>sampling</b></code>, <code><b>top-k</b></code>, <code><b>top-p</b></code>, etc.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos colocar tudo em uma função e ver o que acontece se gerarmos alguns tokens.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">generate_next_greedy_token</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">input_tokens</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #6b97e8;">outputs</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">input_tokens</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #6b97e8;">logits</span> <span>=</span> <span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">logits</span></p>
<p>    <span style="color: #6b97e8;">nex_token_logits</span> <span>=</span> <span style="color: #6b97e8;">logits</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">,</span><span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span></p>
<p>    <span style="color: #6b97e8;">softmax_logits</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">softmax</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">nex_token_logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">dim</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #6b97e8;">next_token_prob</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">next_token_id</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">max</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">softmax_logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">dim</span><span>=</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">next_token_prob</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">next_token_id</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">generate_greedy_text</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">input_sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">max_length</span><span>=</span><span style="color: #7e7a38;">20</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">generated_text</span> <span>=</span> <span style="color: #6b97e8;">input_sentence</span></p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">_</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">max_length</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #6b97e8;">next_token_prob</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">next_token_id</span> <span>=</span> <span style="color: #6b97e8;">generate_next_greedy_token</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">generated_text</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
<p>        <span style="color: #6b97e8;">generated_text</span> <span>+=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">next_token_id</span><span>.</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">())</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">generated_text</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Agora vamos gerar o texto</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">generate_greedy_text</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;Hello, I&#39;m a language model,&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>"Hello, I'm a language model, and I'm going to help you with your problem.\n\n\nI'm going to help you"</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">O resultado é bastante repetitivo, como já visto em [ways to generate text] (https://maximofn.com/hugging-face-transformers/#Formas-de-generaci%C3%B3n-de-texto). Mas, ainda assim, é um resultado melhor do que o que obtivemos com o [GPT-1] (https://maximofn.com/gpt1/#Generaci%C3%B3n-de-texto).</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Arquitetura-dos-modelos-disponíveis-no-Hugging-Face">
								<a class="anchor-link" href="#Arquitetura-dos-modelos-disponíveis-no-Hugging-Face">
									<p style="margin-left: 10px">Arquitetura dos modelos disponíveis no Hugging Face</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Se acessarmos a documentação do Hugging Face do <a href="https://huggingface.co/docs/transformers/en/model_doc/gpt2" target="_blank">GPT2</a>, veremos que temos as opções <code><b>GPT2Model</b></code>, <code><b>GPT2LMHeadModel</b></code>, <code><b>GPT2ForSequenceClassification</b></code>, <code><b>GPT2ForQuestionAnswering</b></code>, <code><b>GPT2ForTokenClassification</b></code>. Vamos dar uma olhada neles</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p></p>
<p><span style="color: #6b97e8;">ckeckpoints</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2&quot;</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="GPT2Model">
								<a class="anchor-link" href="#GPT2Model">
									<p style="margin-left: 20px">GPT2Model</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Esse é o modelo básico, ou seja, o decodificador de transformador.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">GPT2Model</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">GPT2Model</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">ckeckpoints</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>GPT2Model(</p><p>  (wte): Embedding(50257, 768)</p><p>  (wpe): Embedding(1024, 768)</p><p>  (drop): Dropout(p=0.1, inplace=False)</p><p>  (h): ModuleList(</p><p>    (0-11): 12 x GPT2Block(</p><p>      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>      (attn): GPT2Attention(</p><p>        (c_attn): Conv1D()</p><p>        (c_proj): Conv1D()</p><p>        (attn_dropout): Dropout(p=0.1, inplace=False)</p><p>        (resid_dropout): Dropout(p=0.1, inplace=False)</p><p>      )</p><p>      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>      (mlp): GPT2MLP(</p><p>        (c_fc): Conv1D()</p><p>        (c_proj): Conv1D()</p><p>        (act): NewGELUActivation()</p><p>        (dropout): Dropout(p=0.1, inplace=False)</p><p>      )</p><p>    )</p><p>  )</p><p>  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Como você pode ver na saída, um tensor de dimensão 768, que é a dimensão dos embeddings do modelo pequeno. Se tivéssemos usado o modelo <code><b>openai-community/gpt2-xl</b></code>, teríamos obtido um resultado de 1600.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Dependendo da tarefa em questão, seria necessário adicionar mais camadas.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Podemos adicioná-las manualmente, mas os pesos dessas camadas seriam inicializados de forma aleatória. Por outro lado, se usarmos os modelos Hugging Face com essas camadas, os pesos serão pré-treinados.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="GPT2LMHeadModel">
								<a class="anchor-link" href="#GPT2LMHeadModel">
									<p style="margin-left: 20px">GPT2LMHeadModel</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">É o mesmo que usamos anteriormente para gerar texto</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">ckeckpoints</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>GPT2LMHeadModel(</p><p>  (transformer): GPT2Model(</p><p>    (wte): Embedding(50257, 768)</p><p>    (wpe): Embedding(1024, 768)</p><p>    (drop): Dropout(p=0.1, inplace=False)</p><p>    (h): ModuleList(</p><p>      (0-11): 12 x GPT2Block(</p><p>        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>        (attn): GPT2Attention(</p><p>          (c_attn): Conv1D()</p><p>          (c_proj): Conv1D()</p><p>          (attn_dropout): Dropout(p=0.1, inplace=False)</p><p>          (resid_dropout): Dropout(p=0.1, inplace=False)</p><p>        )</p><p>        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>        (mlp): GPT2MLP(</p><p>          (c_fc): Conv1D()</p><p>          (c_proj): Conv1D()</p><p>          (act): NewGELUActivation()</p><p>          (dropout): Dropout(p=0.1, inplace=False)</p><p>        )</p><p>      )</p><p>    )</p><p>    (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>  )</p><p>  (lm_head): Linear(in_features=768, out_features=50257, bias=False)</p><p>)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Como você pode ver, é o mesmo modelo anterior, só que no final foi adicionada uma camada linear com uma entrada de 768 (os embeddings) e uma saída de 50257, que corresponde ao tamanho do vocabulário.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="GPT2ForSequenceClassification">
								<a class="anchor-link" href="#GPT2ForSequenceClassification">
									<p style="margin-left: 20px">GPT2ForSequenceClassification</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Essa opção serve para classificar sequências de texto; nesse caso, devemos especificar com <code><b>num_labels</b></code> o número de classes que queremos classificar.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">GPT2ForSequenceClassification</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">GPT2ForSequenceClassification</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">ckeckpoints</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_labels</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>GPT2ForSequenceClassification(</p><p>  (transformer): GPT2Model(</p><p>    (wte): Embedding(50257, 768)</p><p>    (wpe): Embedding(1024, 768)</p><p>    (drop): Dropout(p=0.1, inplace=False)</p><p>    (h): ModuleList(</p><p>      (0-11): 12 x GPT2Block(</p><p>        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>        (attn): GPT2Attention(</p><p>          (c_attn): Conv1D()</p><p>          (c_proj): Conv1D()</p><p>          (attn_dropout): Dropout(p=0.1, inplace=False)</p><p>          (resid_dropout): Dropout(p=0.1, inplace=False)</p><p>        )</p><p>        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>        (mlp): GPT2MLP(</p><p>          (c_fc): Conv1D()</p><p>          (c_proj): Conv1D()</p><p>          (act): NewGELUActivation()</p><p>          (dropout): Dropout(p=0.1, inplace=False)</p><p>        )</p><p>      )</p><p>    )</p><p>    (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>  )</p><p>  (score): Linear(in_features=768, out_features=5, bias=False)</p><p>)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Agora, em vez de termos uma saída de 50257, temos uma saída de 5, que é o número que inserimos em <code><b>num_labels</b></code> e é o número de classes que queremos classificar.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="GPT2ForQuestionAnswering">
								<a class="anchor-link" href="#GPT2ForQuestionAnswering">
									<p style="margin-left: 20px">GPT2ForQuestionAnswering</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Na postagem <a href="https://maximofn.com/hugging-face-transformers/" target="_blank">transformers</a>, explicamos que, nesse modo, você passa um contexto para o modelo e uma pergunta sobre o contexto e ele retorna a resposta.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">GPT2ForQuestionAnswering</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">GPT2ForQuestionAnswering</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">ckeckpoints</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>GPT2ForQuestionAnswering(</p><p>  (transformer): GPT2Model(</p><p>    (wte): Embedding(50257, 768)</p><p>    (wpe): Embedding(1024, 768)</p><p>    (drop): Dropout(p=0.1, inplace=False)</p><p>    (h): ModuleList(</p><p>      (0-11): 12 x GPT2Block(</p><p>        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>        (attn): GPT2Attention(</p><p>          (c_attn): Conv1D()</p><p>          (c_proj): Conv1D()</p><p>          (attn_dropout): Dropout(p=0.1, inplace=False)</p><p>          (resid_dropout): Dropout(p=0.1, inplace=False)</p><p>        )</p><p>        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>        (mlp): GPT2MLP(</p><p>          (c_fc): Conv1D()</p><p>          (c_proj): Conv1D()</p><p>          (act): NewGELUActivation()</p><p>          (dropout): Dropout(p=0.1, inplace=False)</p><p>        )</p><p>      )</p><p>    )</p><p>    (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>  )</p><p>  (qa_outputs): Linear(in_features=768, out_features=2, bias=True)</p><p>)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vemos que o resultado nos dá um tensor bidimensional.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="GPT2ForTokenClassification">
								<a class="anchor-link" href="#GPT2ForTokenClassification">
									<p style="margin-left: 20px">GPT2ForTokenClassification</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Também na postagem <a href="https://maximofn.com/hugging-face-transformers/" target="_blank">transformers</a> dissemos o que era a calsificação de tokens, explicamos que ela classificava a qual categoria cada token pertencia. Temos que passar o número de classes que queremos classificar com <code><b>num_labels</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">GPT2ForTokenClassification</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">GPT2ForTokenClassification</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">ckeckpoints</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_labels</span><span>=</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>GPT2ForTokenClassification(</p><p>  (transformer): GPT2Model(</p><p>    (wte): Embedding(50257, 768)</p><p>    (wpe): Embedding(1024, 768)</p><p>    (drop): Dropout(p=0.1, inplace=False)</p><p>    (h): ModuleList(</p><p>      (0-11): 12 x GPT2Block(</p><p>        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>        (attn): GPT2Attention(</p><p>          (c_attn): Conv1D()</p><p>          (c_proj): Conv1D()</p><p>          (attn_dropout): Dropout(p=0.1, inplace=False)</p><p>          (resid_dropout): Dropout(p=0.1, inplace=False)</p><p>        )</p><p>        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>        (mlp): GPT2MLP(</p><p>          (c_fc): Conv1D()</p><p>          (c_proj): Conv1D()</p><p>          (act): NewGELUActivation()</p><p>          (dropout): Dropout(p=0.1, inplace=False)</p><p>        )</p><p>      )</p><p>    )</p><p>    (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p><p>  )</p><p>  (dropout): Dropout(p=0.1, inplace=False)</p><p>  (classifier): Linear(in_features=768, out_features=5, bias=True)</p><p>)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Na saída, obtemos as 5 classes que especificamos com <code><b>num_labels</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h2 id="Ajuste-fino-do-GPT-2">
								<a class="anchor-link" href="#Ajuste-fino-do-GPT-2">
									<p style="margin-left: 10px">Ajuste fino do GPT-2</p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Ajuste-fino-para-geração-de-texto">
								<a class="anchor-link" href="#Ajuste-fino-para-geração-de-texto">
									<p style="margin-left: 20px">Ajuste fino para geração de texto</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Primeiro, vamos dar uma olhada em como o treinamento puro do Pytorch seria feito.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Cálculo-de-perdas">
								<a class="anchor-link" href="#Cálculo-de-perdas">
									<p style="margin-left: 30px">Cálculo de perdas</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Antes de começarmos a fazer o ajuste fino do GPT-2, vamos dar uma olhada em um aspecto. Antes, quando obtivemos a saída do modelo, fizemos o seguinte</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">outputs</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">input_tokens</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">outputs</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>CausalLMOutputWithCrossAttentions(loss=None, logits=tensor([[[ 6.6288,  5.1421, -0.8002,  ..., -6.3998, -4.4113,  1.8240],</p><p>         [ 2.7250,  1.9371, -1.2293,  ..., -5.0979, -5.1617,  2.2694],</p><p>         [ 2.6891,  4.3089, -1.6074,  ..., -7.6321, -2.0448,  0.4042],</p><p>         ...,</p><p>         [ 6.0513,  3.8020, -2.8080,  ..., -6.7754, -8.3176,  1.1541],</p><p>         [ 6.8402,  5.6952,  0.2002,  ..., -9.1281, -6.7818,  2.7576],</p><p>         [ 1.0255, -0.2201, -2.5484,  ..., -6.2137, -7.2322,  0.1665]]],</p><p>       device='cuda:0', grad_fn=&lt;UnsafeViewBackward0&gt;), past_key_values=((tensor([[[[ 0.4779,  0.7671, -0.7532,  ..., -0.3551,  0.4590,  0.3073],</p><p>          [ 0.2034, -0.6033,  0.2484,  ...,  0.7760, -0.3546,  0.0198],</p><p>          [-0.1968, -0.9029,  0.5570,  ...,  0.9985, -0.5028, -0.3508],</p><p>          ...,</p><p>          [-0.5007, -0.4009,  0.1604,  ..., -0.3693, -0.1158,  0.1320],</p><p>          [-0.4854, -0.1369,  0.7377,  ..., -0.8043, -0.1054,  0.0871],</p><p>          [ 0.1610, -0.8358, -0.5534,  ...,  0.9951, -0.3085,  0.4574]],</p><p>         [[ 0.6288, -0.1374, -0.3467,  ..., -1.0003, -1.1518,  0.3114],</p><p>          [-1.7269,  1.2920, -0.0734,  ...,  1.0572,  1.4698, -2.0412],</p><p>          [ 0.2714, -0.0670, -0.4769,  ...,  0.6305,  0.6890, -0.8158],</p><p>          ...,</p><p>          [-0.0499, -0.0721,  0.4580,  ...,  0.6797,  0.2331,  0.0210],</p><p>          [-0.1894,  0.2077,  0.6722,  ...,  0.6938,  0.2104, -0.0574],</p><p>          [ 0.3661, -0.0218,  0.2618,  ...,  0.8750,  1.2205, -0.6103]],</p><p>         [[ 0.5964,  1.1178,  0.3604,  ...,  0.8426,  0.4881, -0.4094],</p><p>          [ 0.3186, -0.3953,  0.2687,  ..., -0.1110, -0.5640,  0.5900],</p><p>          ...,</p><p>          [ 0.2092,  0.3898, -0.6061,  ..., -0.2859, -0.3136, -0.1002],</p><p>          [ 0.0539,  0.8941,  0.3423,  ..., -0.6326, -0.1053, -0.6679],</p><p>          [ 0.5628,  0.6687, -0.2720,  ..., -0.1073, -0.9792, -0.0302]]]],</p><p>       device='cuda:0', grad_fn=&lt;PermuteBackward0&gt;))), hidden_states=None, attentions=None, cross_attentions=None)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Você pode ver que obtemos <code><b>loss=None</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">loss</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>None</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Como precisaremos da perda para fazer o ajuste fino, vamos ver como obtê-la.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Se consultarmos a documentação do método <a href="https://huggingface.co/docs/transformers/model_doc/gpt2#transformers.GPT2LMHeadModel.forward" target="_blank">forward</a> de <code><b>GPT2LMHeadModel</b></code>, veremos que ele diz que a saída retorna um objeto do tipo <code><b>transformers.modeling_outputs.CausalLMOutputWithCrossAttentions</b></code>, portanto, se consultarmos a documentação de <a href="https://huggingface.co/docs/transformers/v4.41.3/en/main_classes/output#transformers.modeling_outputs.CausalLMOutputWithCrossAttentions" target="_blank">transformers.modeling_outputs.CausalLMOutputWithCrossAttentions</a>, podemos ver que ele diz que retorna <code><b>loss</b></code> se <code><b>labels</b></code> for passado para o método <code><b>forward</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Se acessarmos o código-fonte do método <a href="https://github.com/huggingface/transformers/blob/main/src/transformers/models/gpt2/modeling_gpt2.py#L1277" target="_blank">forward</a>, veremos este bloco de código</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 80px;"><code>        perda = Nenhuma<br>        se labels não for None:<br>            # mova os rótulos para o dispositivo correto para ativar o paralelismo do modelo<br>            rótulos = rótulos.to(lm_logits.device)<br>            # Deslocamento de modo que os tokens < n prevejam n<br>            shift_logits = lm_logits[..., :-1, :].contiguous()<br>            shift_labels = labels[..., 1:].contiguous()<br>            # Achatar os tokens<br>            loss_fct = CrossEntropyLoss()<br>            loss = loss_fct(shift_logits.view(-1, shift_logits.size(-1)), shift_labels.view(-1))<br></code></p>
						</div>
					</div>
				</div>
			</div>
	
	
	
	
	
	
	
	
	
	
	
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Em outras palavras, a "perda" é calculada da seguinte forma</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">
								<ul>
									<li>Deslocamento de logits e rótulos: a primeira parte é deslocar logits (<code><b>lm_logits</b></code>) e rótulos (<code><b>labels</b></code>) para que <code><b>tokens < n</b></code> prevejam <code><b>n</b></code>, ou seja, a partir de uma posição <code><b>n</b></code>, o próximo token é previsto a partir dos anteriores.</li>
									<li>CrossEntropyLoss: é criada uma instância da função de perda <code><b>CrossEntropyLoss()</b></code>.</li>
									<li>Achatar tokens: os logits e os rótulos são achatados usando <code><b>view(-1, shift_logits.size(-1))</b></code> e <code><b>view(-1)</b></code>, respectivamente. Isso é feito para que os logits e os rótulos tenham a mesma forma para a função de perda.</li>
									<li>Cálculo da perda: finalmente, a perda é calculada usando a função de perda <code><b>CrossEntropyLoss()</b></code> com os logits achatados e os rótulos achatados como entradas.</li>
								</ul>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">

						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Em resumo, a "perda" é calculada como a perda de entropia cruzada entre os logits deslocados e achatados e os rótulos deslocados e achatados.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Portanto, se passarmos os rótulos para o método <code><b>forward</b></code>, ele retornará a <code><b>perda</b></code>.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">outputs</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">input_tokens</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">labels</span><span>=</span><span style="color: #6b97e8;">input_tokens</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">loss</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>tensor(3.8028, device='cuda:0', grad_fn=&lt;NllLossBackward0&gt;)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Conjunto-de-dados">
								<a class="anchor-link" href="#Conjunto-de-dados">
									<p style="margin-left: 30px">Conjunto de dados</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para o treinamento, usaremos um conjunto de dados de piadas em inglês [short-jokes-dataset] (https://huggingface.co/datasets/Maximofn/short-jokes-dataset), que é um conjunto de dados com 231 mil piadas em inglês.</p>
						</div>
					</div>
				</div>
			</div>
	
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">> Reinicie o notebook para que não haja problemas de memória da GPU</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Baixamos o conjunto de dados</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">datasets</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">load_dataset</span></p>
<p></p>
<p><span style="color: #6b97e8;">jokes</span> <span>=</span> <span style="color: #6b97e8;">load_dataset</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;Maximofn/short-jokes-dataset&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">jokes</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>DatasetDict({</p><p>    train: Dataset({</p><p>        features: ['ID', 'Joke'],</p><p>        num_rows: 231657</p><p>    })</p><p>})</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos dar uma olhada nisso</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">jokes</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'ID': 1,</p><p> 'Joke': '[me narrating a documentary about narrators] "I can\'t hear what they\'re saying cuz I\'m talking"'}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Instância-do-modelo">
								<a class="anchor-link" href="#Instância-do-modelo">
									<p style="margin-left: 30px">Instância do modelo</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Para usar o modelo <code><b>xl</b></code>, ou seja, aquele com parâmetros de 1,5B, eu o mudo para FP16 para não ficar sem memória.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AutoTokenizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span></p>
<p></p>
<p><span style="color: #6b97e8;">device</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span> <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">cuda</span><span>.</span><span style="color: #6b97e8;">is_available</span><span style="color: #e3e11d;">()</span> <span style="color: #a04cc1;">else</span> <span style="color: #7e7a34;">&quot;cpu&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">ckeckpoints</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2-xl&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">AutoTokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">ckeckpoints</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">GPT2LMHeadModel</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">ckeckpoints</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">half</span><span style="color: #e3e11d;">()</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Conjunto-de-dados-Pytorch">
								<a class="anchor-link" href="#Conjunto-de-dados-Pytorch">
									<p style="margin-left: 30px">Conjunto de dados Pytorch</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Criar uma classe de conjunto de dados do Pytorch</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">torch.utils.data</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Dataset</span></p>
<p></p>
<p><span style="color: #a04cc1;">class</span> <span style="color: #7f6e38;">JokesDataset</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">Dataset</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">__init__</span><span style="color: #e3e11d;">(</span><span style="color: #7f6e38;">self</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">dataset</span> <span>=</span> <span style="color: #6b97e8;">dataset</span></p>
<p>        <span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">joke</span> <span>=</span> <span style="color: #7e7a34;">&quot;JOKE: &quot;</span></p>
<p>        <span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">end_of_text_token</span> <span>=</span> <span style="color: #7e7a34;">&quot;&lt;|endoftext|&gt;&quot;</span></p>
<p>        <span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span></p>
<p>        </p>
<p>    <span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">__len__</span><span style="color: #e3e11d;">(</span><span style="color: #7f6e38;">self</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #a04cc1;">return</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">])</span></p>
<p></p>
<p>    <span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">__getitem__</span><span style="color: #e3e11d;">(</span><span style="color: #7f6e38;">self</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">):</span></p>
<p>        <span style="color: #6b97e8;">sentence</span> <span>=</span> <span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">joke</span> <span>+</span> <span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">][</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">][</span><span style="color: #7e7a34;">&quot;Joke&quot;</span><span style="color: #e3e11d;">]</span> <span>+</span> <span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">end_of_text_token</span></p>
<p>        <span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #7f6e38;">self</span><span>.</span><span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span></p>
<p>        <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokens</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Nós o instanciamos</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dataset</span> <span>=</span> <span style="color: #6b97e8;">JokesDataset</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">jokes</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokenizer</span><span>=</span><span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Aqui está um exemplo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">5</span><span style="color: #e3e11d;">]</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span>.</span><span style="color: #6b97e8;">shape</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">attention_mask</span><span>.</span><span style="color: #6b97e8;">shape</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>(torch.Size([1, 22]), torch.Size([1, 22]))</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Dataloader">
								<a class="anchor-link" href="#Dataloader">
									<p style="margin-left: 30px">Dataloader</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Agora, criamos um carregador de dados do Pytorch</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">torch.utils.data</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">DataLoader</span></p>
<p></p>
<p><span style="color: #6b97e8;">BS</span> <span>=</span> <span style="color: #7e7a38;">1</span></p>
<p><span style="color: #6b97e8;">joke_dataloader</span> <span>=</span> <span style="color: #6b97e8;">DataLoader</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">batch_size</span><span>=</span><span style="color: #6b97e8;">BS</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">shuffle</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vemos um lote</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">sentences</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #dfd84a;">next</span><span style="color: #e3e11d;">(</span><span style="color: #dfd84a;">iter</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">joke_dataloader</span><span style="color: #e3e11d;">))</span></p>
<p><span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentences</span><span style="color: #e3e11d;">),</span> <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span>.</span><span style="color: #6b97e8;">shape</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">attention_mask</span><span>.</span><span style="color: #6b97e8;">shape</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>(1, torch.Size([1, 1, 36]), torch.Size([1, 1, 36]))</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Treinamento">
								<a class="anchor-link" href="#Treinamento">
									<p style="margin-left: 30px">Treinamento</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">AdamW</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">get_linear_schedule_with_warmup</span></p>
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">tqdm</span></p>
<p></p>
<p><span style="color: #6b97e8;">BATCH_SIZE</span> <span>=</span> <span style="color: #7e7a38;">32</span></p>
<p><span style="color: #6b97e8;">EPOCHS</span> <span>=</span> <span style="color: #7e7a38;">5</span></p>
<p><span style="color: #6b97e8;">LEARNING_RATE</span> <span>=</span> <span style="color: #a09e19;">3e-6</span></p>
<p><span style="color: #6b97e8;">WARMUP_STEPS</span> <span>=</span> <span style="color: #7e7a38;">5000</span></p>
<p><span style="color: #6b97e8;">MAX_SEQ_LEN</span> <span>=</span> <span style="color: #7e7a38;">500</span></p>
<p></p>
<p><span style="color: #6b97e8;">optimizer</span> <span>=</span> <span style="color: #6b97e8;">AdamW</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">parameters</span><span style="color: #e3e11d;">(),</span> <span style="color: #6b97e8;">lr</span><span>=</span><span style="color: #6b97e8;">LEARNING_RATE</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">scheduler</span> <span>=</span> <span style="color: #6b97e8;">get_linear_schedule_with_warmup</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">optimizer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_warmup_steps</span><span>=</span><span style="color: #6b97e8;">WARMUP_STEPS</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_training_steps</span><span>=-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">proc_seq_count</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p><span style="color: #6b97e8;">batch_count</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
<p></p>
<p><span style="color: #6b97e8;">tmp_jokes_tens</span> <span>=</span> <span style="color: #7f6e38;">None</span></p>
<p></p>
<p><span style="color: #6b97e8;">losses</span> <span>=</span> <span style="color: #e3e11d;">[]</span></p>
<p><span style="color: #6b97e8;">lrs</span> <span>=</span> <span style="color: #e3e11d;">[]</span></p>
<p></p>
<p><span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">epoch</span> <span style="color: #7f6e38;">in</span> <span style="color: #dfd84a;">range</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">EPOCHS</span><span style="color: #e3e11d;">):</span></p>
<p>    </p>
<p>    <span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;EPOCH </span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">epoch</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;"> started&quot;</span> <span>+</span> <span style="color: #8d783e;">&#39;=&#39;</span> <span>*</span> <span style="color: #7e7a38;">30</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #6b97e8;">progress_bar</span> <span>=</span> <span style="color: #6b97e8;">tqdm</span><span>.</span><span style="color: #6b97e8;">tqdm</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">joke_dataloader</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">desc</span><span>=</span><span style="color: #7e7a34;">&quot;Training&quot;</span><span style="color: #e3e11d;">)</span></p>
<p>    </p>
<p>    <span style="color: #a04cc1;">for</span> <span style="color: #6b97e8;">sample</span> <span style="color: #7f6e38;">in</span> <span style="color: #6b97e8;">progress_bar</span><span style="color: #e3e11d;">:</span></p>
<p></p>
<p>        <span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">tokens</span> <span>=</span> <span style="color: #6b97e8;">sample</span></p>
<p>        </p>
<p>        <span style="color: #7f6e38;">#################### &quot;Fit as many joke sequences into MAX_SEQ_LEN sequence as possible&quot; logic start ####</span></p>
<p>        <span style="color: #6b97e8;">joke_tens</span> <span>=</span> <span style="color: #6b97e8;">tokens</span><span>.</span><span style="color: #6b97e8;">input_ids</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p>        <span style="color: #7f6e38;"># Skip sample from dataset if it is longer than MAX_SEQ_LEN</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">joke_tens</span><span>.</span><span style="color: #6b97e8;">size</span><span style="color: #e3e11d;">()[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span> <span>&gt;</span> <span style="color: #6b97e8;">MAX_SEQ_LEN</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #a04cc1;">continue</span></p>
<p>        </p>
<p>        <span style="color: #7f6e38;"># The first joke sequence in the sequence</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #7f6e38;">not</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">is_tensor</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tmp_jokes_tens</span><span style="color: #e3e11d;">):</span></p>
<p>            <span style="color: #6b97e8;">tmp_jokes_tens</span> <span>=</span> <span style="color: #6b97e8;">joke_tens</span></p>
<p>            <span style="color: #a04cc1;">continue</span></p>
<p>        <span style="color: #a04cc1;">else</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #7f6e38;"># The next joke does not fit in so we process the sequence and leave the last joke </span></p>
<p>            <span style="color: #7f6e38;"># as the start for next sequence </span></p>
<p>            <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">tmp_jokes_tens</span><span>.</span><span style="color: #6b97e8;">size</span><span style="color: #e3e11d;">()[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span> <span>+</span> <span style="color: #6b97e8;">joke_tens</span><span>.</span><span style="color: #6b97e8;">size</span><span style="color: #e3e11d;">()[</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">]</span> <span>&gt;</span> <span style="color: #6b97e8;">MAX_SEQ_LEN</span><span style="color: #e3e11d;">:</span></p>
<p>                <span style="color: #6b97e8;">work_jokes_tens</span> <span>=</span> <span style="color: #6b97e8;">tmp_jokes_tens</span></p>
<p>                <span style="color: #6b97e8;">tmp_jokes_tens</span> <span>=</span> <span style="color: #6b97e8;">joke_tens</span></p>
<p>            <span style="color: #a04cc1;">else</span><span style="color: #e3e11d;">:</span></p>
<p>                <span style="color: #7f6e38;">#Add the joke to sequence, continue and try to add more</span></p>
<p>                <span style="color: #6b97e8;">tmp_jokes_tens</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">cat</span><span style="color: #e3e11d;">([</span><span style="color: #6b97e8;">tmp_jokes_tens</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">joke_tens</span><span style="color: #e3e11d;">[:,</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">:]],</span> <span style="color: #6b97e8;">dim</span><span>=</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">)</span></p>
<p>                <span style="color: #a04cc1;">continue</span></p>
<p>        <span style="color: #7f6e38;">################## Sequence ready, process it trough the model ##################</span></p>
<p>            </p>
<p>        <span style="color: #6b97e8;">outputs</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">work_jokes_tens</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">labels</span><span>=</span><span style="color: #6b97e8;">work_jokes_tens</span><span style="color: #e3e11d;">)</span></p>
<p>        <span style="color: #6b97e8;">loss</span> <span>=</span> <span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">loss</span></p>
<p>        <span style="color: #6b97e8;">loss</span><span>.</span><span style="color: #6b97e8;">backward</span><span style="color: #e3e11d;">()</span></p>
<p>                    </p>
<p>        <span style="color: #6b97e8;">proc_seq_count</span> <span>=</span> <span style="color: #6b97e8;">proc_seq_count</span> <span>+</span> <span style="color: #7e7a38;">1</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">proc_seq_count</span> <span>==</span> <span style="color: #6b97e8;">BATCH_SIZE</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">proc_seq_count</span> <span>=</span> <span style="color: #7e7a38;">0</span>    </p>
<p>            <span style="color: #6b97e8;">batch_count</span> <span>+=</span> <span style="color: #7e7a38;">1</span></p>
<p>            <span style="color: #6b97e8;">optimizer</span><span>.</span><span style="color: #6b97e8;">step</span><span style="color: #e3e11d;">()</span></p>
<p>            <span style="color: #6b97e8;">scheduler</span><span>.</span><span style="color: #6b97e8;">step</span><span style="color: #e3e11d;">()</span> </p>
<p>            <span style="color: #6b97e8;">optimizer</span><span>.</span><span style="color: #6b97e8;">zero_grad</span><span style="color: #e3e11d;">()</span></p>
<p>            <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">zero_grad</span><span style="color: #e3e11d;">()</span></p>
<p></p>
<p>        <span style="color: #6b97e8;">progress_bar</span><span>.</span><span style="color: #6b97e8;">set_postfix</span><span style="color: #e3e11d;">({</span><span style="color: #8d783e;">&#39;loss&#39;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">loss</span><span>.</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">(),</span> <span style="color: #8d783e;">&#39;lr&#39;</span><span style="color: #e3e11d;">:</span> <span style="color: #6b97e8;">scheduler</span><span>.</span><span style="color: #6b97e8;">get_last_lr</span><span style="color: #e3e11d;">()[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">]})</span></p>
<p>        <span style="color: #6b97e8;">losses</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">loss</span><span>.</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">())</span></p>
<p>        <span style="color: #6b97e8;">lrs</span><span>.</span><span style="color: #6b97e8;">append</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">scheduler</span><span>.</span><span style="color: #6b97e8;">get_last_lr</span><span style="color: #e3e11d;">()[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">])</span></p>
<p>        <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">batch_count</span> <span>==</span> <span style="color: #7e7a38;">10</span><span style="color: #e3e11d;">:</span></p>
<p>            <span style="color: #6b97e8;">batch_count</span> <span>=</span> <span style="color: #7e7a38;">0</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Training: 100%|██████████| 231657/231657 [32:22&lt;00:00, 119.25it/s, loss=2.1, lr=1.16e-6] </p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">numpy</span> <span style="color: #a04cc1;">as</span> <span style="color: #4fcd7d;">np</span></p>
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">matplotlib.pyplot</span> <span style="color: #a04cc1;">as</span> <span style="color: #4fcd7d;">plt</span></p>
<p></p>
<p><span style="color: #6b97e8;">losses_np</span> <span>=</span> <span style="color: #6b97e8;">np</span><span>.</span><span style="color: #6b97e8;">array</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">losses</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">lrs_np</span> <span>=</span> <span style="color: #6b97e8;">np</span><span>.</span><span style="color: #6b97e8;">array</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">lrs</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">plt</span><span>.</span><span style="color: #6b97e8;">figure</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">figsize</span><span>=</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a38;">12</span><span style="color: #e3e11d;">,</span><span style="color: #7e7a38;">6</span><span style="color: #e3e11d;">))</span></p>
<p><span style="color: #6b97e8;">plt</span><span>.</span><span style="color: #6b97e8;">plot</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">losses_np</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">label</span><span>=</span><span style="color: #8d783e;">&#39;loss&#39;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">plt</span><span>.</span><span style="color: #6b97e8;">plot</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">lrs_np</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">label</span><span>=</span><span style="color: #8d783e;">&#39;learning rate&#39;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">plt</span><span>.</span><span style="color: #6b97e8;">yscale</span><span style="color: #e3e11d;">(</span><span style="color: #8d783e;">&#39;log&#39;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">plt</span><span>.</span><span style="color: #6b97e8;">legend</span><span style="color: #e3e11d;">()</span></p>
<p><span style="color: #6b97e8;">plt</span><span>.</span><span style="color: #6b97e8;">show</span><span style="color: #e3e11d;">()</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_area">
								<div class="prompt"></div>
								<div class="output_png output_subarea" style="margin-left: 60px;"><img src="data:image/png;base64,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rzmqXI89xvm2DgAAAABAqyOE+5o7hPuf/BT3AAAAAIDTAyHc19yzo/tbfVsHAAAAABmGofKqGp98GYZxUjUXFhbqpptuUseOHRUSEqKJEydq165dnu379u3TFVdcoY4dOyo0NFQDBgzQkiVLPPvecMMNiomJUXBwsHr16qXXX3+9Rb6XaFyArwto1xzV0oG1rmVCOAAAAOBzFdUO9X/sM5+8dtpTExRibX5Emz59unbt2qUPPvhAERERevDBB3XZZZcpLS1NgYGBuuuuu1RVVaWVK1cqNDRUaWlpCgtzzU31m9/8Rmlpafrkk08UHR2t9PR0VVRUtPRbQz2EcF8qPli33GWI7+oAAAAAcFpyh+9vvvlGo0ePliT961//UmJiot5//3395Cc/UWZmpqZMmaJBgwZJknr06OHZPzMzU8OGDVNqaqokqXv37qa/h/aGEO5LzhrXY2CoFNHFt7UAAAAAUHCgv9KemuCz126u7du3KyAgQCNHjvSs69Spk/r06aPt27dLku69917deeedWrp0qS6++GJNmTJFgwcPliTdeeedmjJlijZs2KDx48dr8uTJnjCP1sE14b7kdLgeAxiKDgAAALQFFotFIdYAn3xZLJZm13us68gNw/Ac77bbbtOePXs0bdo0bdmyRampqfrLX/4iSZo4caL27dunmTNn6uDBg7rooos0e/bsk/8G4oQI4b7k7gn3Y0ACAAAAgObr37+/ampq9N1333nW5efn68cff1S/fv086xITEzVjxgwtWrRI999/v1599VXPtpiYGE2fPl1vv/22XnrpJc2fP9/U99DekP58iRAOAAAA4BT06tVLV111lW6//Xa98sorCg8P10MPPaSEhARdddVVkqSZM2dq4sSJ6t27twoLC/Xll196Avpjjz2mlJQUDRgwQHa7XR999JFXeEfLoyfclwjhAAAAAE7R66+/rpSUFF1++eUaNWqUDMPQkiVLFBgYKElyOBy666671K9fP1166aXq06eP5s6dK0myWq16+OGHNXjwYI0dO1b+/v569913ffl2zngW42RvRtdGFRcXKzIyUkVFRYqIiPB1Oce3/SNpwQ1Sx+7SfZt9XQ0AAADQ7lRWViojI0PJyckKCgrydTlow453rjQnh9IT7ku7v3A9Vhb5tg4AAAAAgCkI4b7kb3M9JqT6tg4AAAAAgCkI4b5k1N6iLH6oT8sAAAAAAJiDEO5LhtP1aPH3bR0AAAAAAFMQwn3JWdsTbuHHAAAAAADtAenPlzw94fwYAAAAAKA9IP35kvuacD9+DAAAAADQHpD+fMl9i3Z6wgEAAACgXSD9+ZLnmnAmZgMAAACA9oAQ7ktcEw4AAADgJFxwwQWaOXOmr8uQJD3xxBMaOnSor8s4bZD+fMlzTTg94QAAAABOT7Nnz9YXX3zh6zKOacWKFbJYLDpy5IivS5FECPctesIBAAAAtFFVVVVNahcWFqZOnTq1cjUNNbW+tob050vbFrseCeEAAABA22AYUlWZb77cEzefhKqqKj3wwANKSEhQaGioRo4cqRUrVni25+fn6/rrr1fXrl0VEhKiQYMG6Z133vE6xgUXXKC7775bs2bNUnR0tC655BJPL/IXX3yh1NRUhYSEaPTo0dq5c6dnv6OHo0+fPl2TJ0/WCy+8oC5duqhTp0666667VF1d7WmTnZ2tSZMmKTg4WMnJyfr3v/+t7t2766WXXjrme3Qfd86cOYqPj1fv3r0lSW+//bZSU1MVHh6uzp0762c/+5lyc3MlSXv37tW4ceMkSR07dpTFYtH06dMlSYZh6Pe//7169Oih4OBgDRkyRP/9739P5tvfLAGt/go4MWuYrysAAAAAIEnV5dKz8b557UcOStbQk9r1lltu0d69e/Xuu+8qPj5eixcv1qWXXqotW7aoV69eqqysVEpKih588EFFRETo448/1rRp09SjRw+NHDnSc5w333xTd955p7755hsZhqGcnBxJ0qOPPqo//OEPiomJ0YwZM3Trrbfqm2++OWY9y5cvV5cuXbR8+XKlp6dr6tSpGjp0qG6//XZJ0k033aS8vDytWLFCgYGBmjVrlic4H88XX3yhiIgILVu2TEbthxZVVVX67W9/qz59+ig3N1e//OUvNX36dC1ZskSJiYl67733NGXKFO3cuVMREREKDg6WJP3617/WokWLNG/ePPXq1UsrV67UjTfeqJiYGJ1//vkn9XNoCkJ4W3DWhb6uAAAAAMBpavfu3XrnnXd04MABxce7PkCYPXu2Pv30U73++ut69tlnlZCQoNmzZ3v2ueeee/Tpp59q4cKFXiG8Z8+e+v3vf+957g7hzzzzjCeYPvTQQ5o0aZIqKysVFBTUaE0dO3bUyy+/LH9/f/Xt21eTJk3SF198odtvv107duzQ559/ru+//16pqamSpNdee029evU64XsNDQ3Va6+9JqvV6ll36623epZ79OihP//5zxoxYoRKS0sVFhamqKgoSVJsbKw6dOggSSorK9OLL76oL7/8UqNGjfLs+/XXX+uVV14hhJ/xLBZfVwAAAABAkgJDXD3Svnrtk7BhwwYZhuEZnu1mt9s912o7HA4999xzWrBggbKysmS322W32xUa6t3z7g7FRxs8eLBnuUuXLpKk3NxcJSUlNdp+wIAB8vf399pny5YtkqSdO3cqICBAw4cP92zv2bOnOnbseML3OmjQIK8ALkkbN27UE088oU2bNqmgoEBOp2vurczMTPXv37/R46SlpamyslKXXHKJ1/qqqioNGzbshHWcCkJ4m0AIBwAAANoEi+Wkh4T7itPplL+/v9avX+8VfCXXpGmS9Ic//EF//OMf9dJLL2nQoEEKDQ3VzJkzG0xudnQodwsMDPQsW2o7Ed1h90Tt3fu42xvHuPb9WOuPV19ZWZnGjx+v8ePH6+2331ZMTIwyMzM1YcKE407c5q7l448/VkJCgtc2m812wjpOBSHcV05h0gUAAAAAcBs2bJgcDodyc3M1ZsyYRtusWrVKV111lW688UZJrhC6a9cu9evXz8xSJUl9+/ZVTU2NNm7cqJSUFElSenr6Sd1CbMeOHcrLy9Nzzz2nxMRESdK6deu82rh7zh0Oh2dd//79ZbPZlJmZ2apDzxvDtNxtAcPRAQAAAJyk3r1764YbbtBNN92kRYsWKSMjQ99//71+97vfacmSJZJcw72XLVum1atXa/v27brjjjs813ubrW/fvrr44ov1i1/8QmvXrtXGjRv1i1/8QsHBwZ5e9qZKSkqS1WrVX/7yF+3Zs0cffPCBfvvb33q16datmywWiz766CMdPnxYpaWlCg8P1+zZs/XLX/5Sb775pnbv3q2NGzfqr3/9q958882WfLsNEMJ9xasnnBAOAAAA4OS9/vrruummm3T//ferT58+uvLKK/Xdd995eod/85vfaPjw4ZowYYIuuOACde7cWZMnT/ZZvW+99Zbi4uI0duxYXX311br99tsVHh5+zInejiUmJkZvvPGGFi5cqP79++u5557TCy+84NUmISFBTz75pB566CHFxcXp7rvvliT99re/1WOPPaY5c+aoX79+mjBhgj788EMlJye3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" /></div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Inferência">
								<a class="anchor-link" href="#Inferência">
									<p style="margin-left: 30px">Inferência</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos ver como o modelo faz piadas.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">sentence_joke</span> <span>=</span> <span style="color: #7e7a34;">&quot;JOKE:&quot;</span></p>
<p><span style="color: #6b97e8;">input_tokens_joke</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_joke</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">output_tokens_joke</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">input_tokens_joke</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">decoded_output_joke</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">output_tokens_joke</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;decoded joke: </span><span style="color: #a6a831;">\n</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">decoded_output_joke</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>decoded joke: </p><p>JOKE:!!!!!!!!!!!!!!!!!</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Você pode ver que você passa uma sequência com a palavra <code><b>joke</b></code> e ele retorna uma piada. Mas se você retornar outra string, ele não retornará</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">sentence_joke</span> <span>=</span> <span style="color: #7e7a34;">&quot;My dog is cute and&quot;</span></p>
<p><span style="color: #6b97e8;">input_tokens_joke</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence_joke</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">output_tokens_joke</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">generate</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">input_tokens_joke</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">decoded_output_joke</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">decode</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">output_tokens_joke</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a38;">0</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">skip_special_tokens</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #1b1477;">f</span><span style="color: #7e7a34;">&quot;decoded joke: </span><span style="color: #a6a831;">\n</span><span style="color: #3b75c2;">{</span><span style="color: #6b97e8;">decoded_output_joke</span><span style="color: #3b75c2;">}</span><span style="color: #7e7a34;">&quot;</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>decoded joke: </p><p>My dog is cute and!!!!!!!!!!!!!!!</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h3 id="Ajuste-fino-do-GPT-2-para-classificação-de-sentenças">
								<a class="anchor-link" href="#Ajuste-fino-do-GPT-2-para-classificação-de-sentenças">
									<p style="margin-left: 20px">Ajuste fino do GPT-2 para classificação de sentenças</p>
								</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Agora vamos fazer um treinamento com as bibliotecas Hugging Face.</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Conjunto-de-dados">
								<a class="anchor-link" href="#Conjunto-de-dados">
									<p style="margin-left: 30px">Conjunto de dados</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Usaremos o conjunto de dados <code><b>imdb</b></code> para classificar as frases em positivas e negativas.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">datasets</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">load_dataset</span></p>
<p></p>
<p><span style="color: #6b97e8;">dataset</span> <span>=</span> <span style="color: #6b97e8;">load_dataset</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;imdb&quot;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">dataset</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>DatasetDict({</p><p>    train: Dataset({</p><p>        features: ['text', 'label'],</p><p>        num_rows: 25000</p><p>    })</p><p>    test: Dataset({</p><p>        features: ['text', 'label'],</p><p>        num_rows: 25000</p><p>    })</p><p>    unsupervised: Dataset({</p><p>        features: ['text', 'label'],</p><p>        num_rows: 50000</p><p>    })</p><p>})</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos dar uma olhada nisso</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">info</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>DatasetInfo(description='', citation='', homepage='', license='', features={'text': Value(dtype='string', id=None), 'label': ClassLabel(names=['neg', 'pos'], id=None)}, post_processed=None, supervised_keys=None, task_templates=None, builder_name='parquet', dataset_name='imdb', config_name='plain_text', version=0.0.0, splits={'train': SplitInfo(name='train', num_bytes=33435948, num_examples=25000, shard_lengths=None, dataset_name='imdb'), 'test': SplitInfo(name='test', num_bytes=32653810, num_examples=25000, shard_lengths=None, dataset_name='imdb'), 'unsupervised': SplitInfo(name='unsupervised', num_bytes=67113044, num_examples=50000, shard_lengths=None, dataset_name='imdb')}, download_checksums={'hf://datasets/imdb@e6281661ce1c48d982bc483cf8a173c1bbeb5d31/plain_text/train-00000-of-00001.parquet': {'num_bytes': 20979968, 'checksum': None}, 'hf://datasets/imdb@e6281661ce1c48d982bc483cf8a173c1bbeb5d31/plain_text/test-00000-of-00001.parquet': {'num_bytes': 20470363, 'checksum': None}, 'hf://datasets/imdb@e6281661ce1c48d982bc483cf8a173c1bbeb5d31/plain_text/unsupervised-00000-of-00001.parquet': {'num_bytes': 41996509, 'checksum': None}}, download_size=83446840, post_processing_size=None, dataset_size=133202802, size_in_bytes=216649642)</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Vamos dar uma olhada nos recursos desse conjunto de dados.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">info</span><span>.</span><span style="color: #6b97e8;">features</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>{'text': Value(dtype='string', id=None),</p><p> 'label': ClassLabel(names=['neg', 'pos'], id=None)}</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">O conjunto de dados contém strings e classes. Além disso, há dois tipos de classes, <code><b>pos</b></code> e <code><b>neg</b></code>. Vamos criar uma variável com o número de classes</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">num_clases</span> <span>=</span> <span style="color: #dfd84a;">len</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">dataset</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">]</span><span>.</span><span style="color: #6b97e8;">unique</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;label&quot;</span><span style="color: #e3e11d;">))</span></p>
<p><span style="color: #6b97e8;">num_clases</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>2</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Tokeniser">
								<a class="anchor-link" href="#Tokeniser">
									<p style="margin-left: 30px">Tokeniser</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Criamos o tokenizador</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">GPT2Tokenizer</span></p>
<p></p>
<p><span style="color: #6b97e8;">checkpoints</span> <span>=</span> <span style="color: #7e7a34;">&quot;openai-community/gpt2&quot;</span></p>
<p><span style="color: #6b97e8;">tokenizer</span> <span>=</span> <span style="color: #6b97e8;">GPT2Tokenizer</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">bos_token</span><span>=</span><span style="color: #8d783e;">&#39;&lt;|startoftext|&gt;&#39;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">eos_token</span><span>=</span><span style="color: #8d783e;">&#39;&lt;|endoftext|&gt;&#39;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">pad_token</span><span>=</span><span style="color: #8d783e;">&#39;&lt;|pad|&gt;&#39;</span><span style="color: #e3e11d;">)</span></p>
<p><span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">pad_token</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span>.</span><span style="color: #6b97e8;">eos_token</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Agora que temos um tokenizador, podemos tokenizar o conjunto de dados, pois o modelo só entende tokens.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">tokenize_function</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">examples</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">examples</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;text&quot;</span><span style="color: #e3e11d;">],</span> <span style="color: #6b97e8;">padding</span><span>=</span><span style="color: #7e7a34;">&quot;max_length&quot;</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">truncation</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">tokenized_datasets</span> <span>=</span> <span style="color: #6b97e8;">dataset</span><span>.</span><span style="color: #6b97e8;">map</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">tokenize_function</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">batched</span><span>=</span><span style="color: #7f6e38;">True</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Modelo">
								<a class="anchor-link" href="#Modelo">
									<p style="margin-left: 30px">Modelo</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Instanciamos o modelo</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">GPT2ForSequenceClassification</span></p>
<p></p>
<p><span style="color: #6b97e8;">model</span> <span>=</span> <span style="color: #6b97e8;">GPT2ForSequenceClassification</span><span>.</span><span style="color: #6b97e8;">from_pretrained</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">checkpoints</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">num_labels</span><span>=</span><span style="color: #6b97e8;">num_clases</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">half</span><span style="color: #e3e11d;">()</span></p>
<p><span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">config</span><span>.</span><span style="color: #6b97e8;">pad_token_id</span> <span>=</span> <span style="color: #6b97e8;">model</span><span>.</span><span style="color: #6b97e8;">config</span><span>.</span><span style="color: #6b97e8;">eos_token_id</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at openai-community/gpt2 and are newly initialized: ['score.weight']</p><p>You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Avaliação">
								<a class="anchor-link" href="#Avaliação">
									<p style="margin-left: 30px">Avaliação</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Criamos uma métrica de avaliação</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">numpy</span> <span style="color: #a04cc1;">as</span> <span style="color: #4fcd7d;">np</span></p>
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">evaluate</span></p>
<p></p>
<p><span style="color: #6b97e8;">metric</span> <span>=</span> <span style="color: #6b97e8;">evaluate</span><span>.</span><span style="color: #6b97e8;">load</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;accuracy&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">compute_metrics</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">eval_pred</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">labels</span> <span>=</span> <span style="color: #6b97e8;">eval_pred</span></p>
<p>    <span style="color: #6b97e8;">predictions</span> <span>=</span> <span style="color: #6b97e8;">np</span><span>.</span><span style="color: #6b97e8;">argmax</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">logits</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">axis</span><span>=-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #6b97e8;">metric</span><span>.</span><span style="color: #6b97e8;">compute</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">predictions</span><span>=</span><span style="color: #6b97e8;">predictions</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">references</span><span>=</span><span style="color: #6b97e8;">labels</span><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Trainer">
								<a class="anchor-link" href="#Trainer">
									<p style="margin-left: 30px">Trainer</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Criamos o instrutor</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">from</span> <span style="color: #4fcd7d;">transformers</span> <span style="color: #833aa0;">import</span> <span style="color: #6b97e8;">Trainer</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">TrainingArguments</span></p>
<p></p>
<p><span style="color: #6b97e8;">training_args</span> <span>=</span> <span style="color: #6b97e8;">TrainingArguments</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">output_dir</span><span>=</span><span style="color: #7e7a34;">&quot;./results&quot;</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">learning_rate</span><span>=</span><span style="color: #a09e19;">2e-5</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">per_device_train_batch_size</span><span>=</span><span style="color: #7e7a38;">16</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">per_device_eval_batch_size</span><span>=</span><span style="color: #7e7a38;">64</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">num_train_epochs</span><span>=</span><span style="color: #7e7a38;">3</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">weight_decay</span><span>=</span><span style="color: #a09e19;">0.01</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #6b97e8;">trainer</span> <span>=</span> <span style="color: #6b97e8;">Trainer</span><span style="color: #e3e11d;">(</span></p>
<p>    <span style="color: #6b97e8;">model</span><span>=</span><span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">args</span><span>=</span><span style="color: #6b97e8;">training_args</span><span style="color: #e3e11d;">,</span></p>
<p>    <span style="color: #6b97e8;">train_dataset</span><span>=</span><span style="color: #6b97e8;">tokenized_datasets</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;train&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>    <span style="color: #6b97e8;">eval_dataset</span><span>=</span><span style="color: #6b97e8;">tokenized_datasets</span><span style="color: #e3e11d;">[</span><span style="color: #7e7a34;">&quot;test&quot;</span><span style="color: #e3e11d;">],</span></p>
<p>    <span style="color: #6b97e8;">compute_metrics</span><span>=</span><span style="color: #6b97e8;">compute_metrics</span><span style="color: #e3e11d;">,</span></p>
<p><span style="color: #e3e11d;">)</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Treinamento">
								<a class="anchor-link" href="#Treinamento">
									<p style="margin-left: 30px">Treinamento</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Treinamos</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">trainer</span><span>.</span><span style="color: #6b97e8;">train</span><span style="color: #e3e11d;">()</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>TrainOutput(global_step=4689, training_loss=0.04045845954294626, metrics={'train_runtime': 5271.3532, 'train_samples_per_second': 14.228, 'train_steps_per_second': 0.89, 'total_flos': 3.91945125888e+16, 'train_loss': 0.04045845954294626, 'epoch': 3.0})</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Open div header -->
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<h4 id="Inferência">
								<a class="anchor-link" href="#Inferência">
									<p style="margin-left: 30px">Inferência</p>
								</a>
							</h4>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing text_cell rendered">
				<div class="prompt input_prompt">
					<div class="inner_cell">
						<div class="text_cell_render border-box-sizing rendered_html">
							<p style="margin-left: 0px;">Testamos o modelo após o treinamento</p>
						</div>
					</div>
				</div>
			</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #833aa0;">import</span> <span style="color: #4fcd7d;">torch</span></p>
<p></p>
<p><span style="color: #6b97e8;">device</span> <span>=</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">(</span><span style="color: #7e7a34;">&quot;cuda&quot;</span> <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">torch</span><span>.</span><span style="color: #6b97e8;">cuda</span><span>.</span><span style="color: #6b97e8;">is_available</span><span style="color: #e3e11d;">()</span> <span style="color: #a04cc1;">else</span> <span style="color: #7e7a34;">&quot;cpu&quot;</span><span style="color: #e3e11d;">)</span></p>
<p></p>
<p><span style="color: #a04cc1;">def</span> <span style="color: #7f6e38;">get_sentiment</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">):</span></p>
<p>    <span style="color: #6b97e8;">inputs</span> <span>=</span> <span style="color: #6b97e8;">tokenizer</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">,</span> <span style="color: #6b97e8;">return_tensors</span><span>=</span><span style="color: #7e7a34;">&quot;pt&quot;</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">to</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">device</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #6b97e8;">outputs</span> <span>=</span> <span style="color: #6b97e8;">model</span><span style="color: #e3e11d;">(</span><span>**</span><span style="color: #6b97e8;">inputs</span><span style="color: #e3e11d;">)</span></p>
<p>    <span style="color: #6b97e8;">prediction</span> <span>=</span> <span style="color: #6b97e8;">outputs</span><span>.</span><span style="color: #6b97e8;">logits</span><span>.</span><span style="color: #6b97e8;">argmax</span><span style="color: #e3e11d;">(</span><span>-</span><span style="color: #7e7a38;">1</span><span style="color: #e3e11d;">)</span><span>.</span><span style="color: #6b97e8;">item</span><span style="color: #e3e11d;">()</span></p>
<p>    <span style="color: #a04cc1;">return</span> <span style="color: #7e7a34;">&quot;positive&quot;</span> <span style="color: #a04cc1;">if</span> <span style="color: #6b97e8;">prediction</span> <span>==</span> <span style="color: #7e7a38;">1</span> <span style="color: #a04cc1;">else</span> <span style="color: #7e7a34;">&quot;negative&quot;</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
			<div class="cell border-box-sizing code_cell rendered">
				<div class="input">
					<div class="prompt input_prompt" style="margin-left: 20px;">Code:</div>
					<div class="inner_cell">
						<div class="input_area">
							<div class=" highlight hl-python3">
								<pre class="python" style="margin-left: 40px; line-height: 0%;font-family:monospace;">
<p><span style="color: #6b97e8;">sentence</span> <span>=</span> <span style="color: #7e7a34;">&quot;I hate this movie!&quot;</span></p>
<p><span style="color: #dfd84a;">print</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">get_sentiment</span><span style="color: #e3e11d;">(</span><span style="color: #6b97e8;">sentence</span><span style="color: #e3e11d;">))</span></p>
								</pre>
							</div>
						</div>
					</div>
				</div>
				<div class="output_wrapper">
					<div class="output">
						<div class="output_area">
							<div class="prompt" style="margin-left: 20px;">Output:</div>
							<div class="output_subarea output_stream output_stdout output_text">
								<pre style="margin-left: 60px; line-height: 0%;"><p>negative</p></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	<!-- Close class contenido -->
	</div>
<!-- Close div notebook container -->
</div>
<!-- Close div notebook -->
</div>


